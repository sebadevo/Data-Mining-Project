(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[66],{395:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(393),i=n(314),r=n(61),o=n(636),s=function(){function e(){}return e._handleInteractionRequiredFailures=function(t,n,s){e._doesAadErrorCodeExist(n,i.e.UNRESOLVABLE_AAD_ERROR_CODES)||i.e.RESOLVABLE_ERROR_CODES.forEach(function(e){if(n.indexOf(e)>-1){var i=t._getNavigateUrl(t.RESPONSE_TYPE.TOKEN,s)+"&prompt=select_account";r._.instance.raiseEvent(a.a._tokenAcquisitionEventId,new a.n(o.e,i))}})},e._isInteractionRequired=function(t,n){return!e._doesAadErrorCodeExist(t,i.e.UNRESOLVABLE_AAD_ERROR_CODES)&&i.e.RESOLVABLE_ERROR_CODES.has(n)},e._isTokenRenewalTimeout=function(e){return e===i.e.TOKEN_RENEWAL_TIMEOUT},e._isEndpointsResolutionError=function(e){return e===i.e.ENDPOINTS_RESOLUTION_ERROR},e._isSessionDoesNotExistError=function(e,t){return e.indexOf(i.e.SESSION_DOES_NOT_EXIST_ERROR)>-1||t.indexOf(i.e.SESSION_DOES_NOT_EXIST_ERROR)>-1},e._doesAadErrorCodeExist=function(e,t){for(var n=0,a=e.match(/(AADSTS)[0-9]+/g)||[];n<a.length;n++){var i=a[n];if(t.has(i))return!0}return!1},e}()},934:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.msalLoggerCallback=function(e,t,n){console.log("[sp-http][msal.js]: "+t)},e.shouldPrintMsalLogsToConsole=function(){var e,t="spfx.msal.shouldPrintLogs",n=(null===(e=new URLSearchParams(window.location.search).get("msalLogging"))||void 0===e?void 0:e.toLowerCase())||"";"true"===n?window.sessionStorage.setItem(t,"true"):"false"===n&&window.sessionStorage.removeItem(t);var a=window.sessionStorage.getItem(t)||"";return"true"===n||"true"===a},e}()},1042:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.acquireControl=function(){return new Promise(function(t,n){e._isRequestInProgress?(e._requestQueue.push(t),setTimeout(function(){t===e._requestQueue[0]&&(e._isRequestInProgress=!1),t()},e._DEFAULT_AUTO_RESOLVE_TIME)):(e._isRequestInProgress=!0,t())})},e.releaseControl=function(){e._isRequestInProgress=!1;var t=e._requestQueue.shift();t&&t()},e._isRequestInProgress=!1,e._requestQueue=[],e._DEFAULT_AUTO_RESOLVE_TIME=1e4,e}()},1043:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(526),i=function(){function e(e,t,n){this._STORAGE_KEYS={AUTHORITY:"spfx.msal.authority",CLIENT_ID:"spfx.msal.clientId",CURRENT_REDIRECT_ATTEMPT:"spfx.msal.redirectAttemptNumber",FIRST_REDIRECT_TIME:"spfx.msal.firstRedirectTime",IS_REDIRECT_IN_PROGRESS:"spfx.msal.isRedirectInProgress",IS_SSO_SILENT:"spfx.msal.isSsoSillent",REDIRECTED_FROM:"spfx.msal.redirectedFrom",SHOULD_USE_MSAL_BROWSER:"spfx.msal.shouldUseMsalBrowser"},this._authority=e,this._clientId=t,this._shouldUseMsalBrowser=n}return e.prototype.isAllowedToRedirect=function(){return this.hasRedirectAttemptsLeft()&&!this.isRedirectInProgress()},e.prototype.hasRedirectAttemptsLeft=function(){return this.getCurrentNumberOfRedirectAttempts()<e._ALLOWED_REDIRECT_ATTEMPTS},e.prototype.isRedirectInProgress=function(){var e="true"===window.sessionStorage.getItem(this._STORAGE_KEYS.IS_REDIRECT_IN_PROGRESS);return this.getCurrentNumberOfRedirectAttempts()>0&&e},e.prototype.prepareForRedirect=function(){window.sessionStorage.setItem(this._STORAGE_KEYS.IS_REDIRECT_IN_PROGRESS,"true"),this._incrementRedirectAttempts(),window.sessionStorage.setItem(this._STORAGE_KEYS.AUTHORITY,this._authority),window.sessionStorage.setItem(this._STORAGE_KEYS.CLIENT_ID,this._clientId),window.sessionStorage.setItem(this._STORAGE_KEYS.REDIRECTED_FROM,window.location.href),this._setIsSsoSilent(!1),window.sessionStorage.setItem(this._STORAGE_KEYS.SHOULD_USE_MSAL_BROWSER,this._shouldUseMsalBrowser.toString())},e.prototype.cancelRedirect=function(){window.sessionStorage.removeItem(this._STORAGE_KEYS.AUTHORITY),window.sessionStorage.removeItem(this._STORAGE_KEYS.CLIENT_ID),window.sessionStorage.removeItem(this._STORAGE_KEYS.REDIRECTED_FROM),window.sessionStorage.removeItem(this._STORAGE_KEYS.SHOULD_USE_MSAL_BROWSER),window.sessionStorage.removeItem(this._STORAGE_KEYS.IS_REDIRECT_IN_PROGRESS)},e.prototype.prepareForSsoSilent=function(){this._setIsSsoSilent(!0),this._setShouldUseMsalBrowser(!0),window.sessionStorage.setItem(this._STORAGE_KEYS.AUTHORITY,this._authority),window.sessionStorage.setItem(this._STORAGE_KEYS.CLIENT_ID,this._clientId)},e.prototype.completeSsoSilent=function(){this._setIsSsoSilent(!1)},e.prototype.getCurrentNumberOfRedirectAttempts=function(){var t,n=0;t=Object(a.a)()?6e4:6e4*e._MAX_REDIRECT_TIME_IN_MIN;var i=this._getFirstRedirectTimeFromSessionStorage();if(i){var r=new Date,o=new Date(i);r.getTime()-o.getTime()<t&&(n=this._getRedirectAttemptNumberFromSessionStorage())}return n},e.prototype._incrementRedirectAttempts=function(){var e=this.getCurrentNumberOfRedirectAttempts()+1;1===e&&this._setFirstRedirectTimeInSessionStorage(),this._setRedirectAttemptNumberInSessionStorage(e)},e.prototype._getRedirectAttemptNumberFromSessionStorage=function(){var e=window.sessionStorage.getItem(this._STORAGE_KEYS.CURRENT_REDIRECT_ATTEMPT)||"0";return parseInt(e,10)},e.prototype._setRedirectAttemptNumberInSessionStorage=function(e){window.sessionStorage.setItem(this._STORAGE_KEYS.CURRENT_REDIRECT_ATTEMPT,e.toString())},e.prototype._getFirstRedirectTimeFromSessionStorage=function(){return window.sessionStorage.getItem(this._STORAGE_KEYS.FIRST_REDIRECT_TIME)},e.prototype._setFirstRedirectTimeInSessionStorage=function(){var e=new Date;window.sessionStorage.setItem(this._STORAGE_KEYS.FIRST_REDIRECT_TIME,e.toString())},e.prototype._setIsSsoSilent=function(e){window.sessionStorage.setItem(this._STORAGE_KEYS.IS_SSO_SILENT,e.toString())},e.prototype._setShouldUseMsalBrowser=function(e){window.sessionStorage.setItem(this._STORAGE_KEYS.SHOULD_USE_MSAL_BROWSER,e.toString())},e._ALLOWED_REDIRECT_ATTEMPTS=13,e._MAX_REDIRECT_TIME_IN_MIN=2,e}()},1327:function(e,t,n){"use strict";n.r(t),n.d(t,"MsalTokenProvider",function(){return it});var a,i=n(20),r=n(61),o=n(183),s=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.validateAndParseJsonCacheKey=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},e}(),c="1.4.12";!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(a||(a={}));var d,l=function(){function e(e,t){void 0===t&&(t={}),this.level=a.Info;var n=t.correlationId,i=void 0===n?"":n,r=t.level,o=void 0===r?a.Info:r,s=t.piiLoggingEnabled,c=void 0!==s&&s;this.localCallback=e,this.correlationId=i,this.level=o,this.piiLoggingEnabled=c}return e.prototype.logMessage=function(e,t,n){if(!(e>this.level||!this.piiLoggingEnabled&&n)){var i,r=(new Date).toUTCString();i=s.isEmpty(this.correlationId)?r+":1.4.12-"+a[e]+(n?"-pii":"")+" "+t:r+":"+this.correlationId+"-1.4.12-"+a[e]+(n?"-pii":"")+" "+t,this.executeCallback(e,i,n)}},e.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},e.prototype.error=function(e){this.logMessage(a.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(a.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(a.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(a.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(a.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(a.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(a.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(a.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),u=n(23),f=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var n=new Uint8Array(16);return t.getRandomValues(n),n[6]|=64,n[6]&=79,n[8]|=128,n[8]&=191,e.decimalToHex(n[0])+e.decimalToHex(n[1])+e.decimalToHex(n[2])+e.decimalToHex(n[3])+"-"+e.decimalToHex(n[4])+e.decimalToHex(n[5])+"-"+e.decimalToHex(n[6])+e.decimalToHex(n[7])+"-"+e.decimalToHex(n[8])+e.decimalToHex(n[9])+"-"+e.decimalToHex(n[10])+e.decimalToHex(n[11])+e.decimalToHex(n[12])+e.decimalToHex(n[13])+e.decimalToHex(n[14])+e.decimalToHex(n[15])}for(var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",r=0,o="",s=0;s<36;s++)"-"!==a[s]&&"4"!==a[s]&&(r=16*Math.random()|0),"x"===a[s]?o+=i[r]:"y"===a[s]?(r&=3,o+=i[r|=8]):o+=a[s];return o},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,n=/\+/g,a=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},r={};for(t=a.exec(e);t;)r[i(t[1])]=i(t[2]),t=a.exec(e);return r},e}(),p=function(){function e(){}return Object.defineProperty(e,"libraryName",{get:function(){return"Msal.js"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cachePrefix",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scopes",{get:function(){return"scopes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"domain_hint",{get:function(){return"domain_hint"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheDelimiter",{get:function(){return"."},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ADFS",{get:function(){return"adfs"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"oidcScopes",{get:function(){return[this.openidScope,this.profileScope]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeSilent",{get:function(){return"silentInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"inProgress",{get:function(){return"inProgress"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}();!function(e){e.SCOPE="scope",e.STATE="state",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.EXPIRES_IN="expires_in",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info"}(d||(d={}));var m,_,h,b="id_token",g="token",v="id_token token";!function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireTokenAccount",e.SESSION_STATE="session.state",e.STATE_LOGIN="state.login",e.STATE_ACQ_TOKEN="state.acquireToken",e.STATE_RENEW="state.renew",e.NONCE_IDTOKEN="nonce.idtoken",e.LOGIN_REQUEST="login.request",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.INTERACTION_STATUS="interaction_status",e.REDIRECT_REQUEST="redirect_request"}(m||(m={})),function(e){e.IDTOKEN="idtoken",e.CLIENT_INFO="client.info"}(_||(_={})),function(e){e.LOGIN_ERROR="login.error",e.ERROR="error",e.ERROR_DESC="error.description"}(h||(h={}));var y,S=".well-known/openid-configuration";!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ID_TOKEN="id_token",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(y||(y={}));var D,I=[y.SID,y.LOGIN_HINT],x={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"},C=function(e){function t(n,a){var i=e.call(this,a)||this;return Object.setPrototypeOf(i,t.prototype),i.errorCode=n,i.errorMessage=a,i.name="AuthError",i}return u.a(t,e),t.createUnexpectedError=function(e){return new t("unexpected_error","Unexpected error in authentication.: "+e)},t.createNoWindowObjectError=function(e){return new t("no_window_object","No window object available. Details: "+e)},t}(Error),O="popup_window_error",w="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",E=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,t.prototype),i}return u.a(t,e),t.createEndpointResolutionError=function(e){var n="Error: could not resolve endpoints. Please check network and try again.";return e&&!s.isEmpty(e)&&(n+=" Details: "+e),new t("endpoints_resolution_error",n)},t.createPopupWindowError=function(e){var n=w;return e&&!s.isEmpty(e)&&(n+=" Details: "+e),new t(O,n)},t.createTokenRenewalTimeoutError=function(){return new t("token_renewal_error","Token renewal operation failed due to timeout.")},t.createInvalidIdTokenError=function(e){return new t("invalid_id_token","Invalid ID token format. Given token: "+e)},t.createInvalidStateError=function(e,n){return new t("invalid_state_error","Invalid state. "+e+", state expected : "+n+".")},t.createNonceMismatchError=function(e,n){return new t("nonce_mismatch_error","Nonce is not matching, Nonce received:  "+e+", nonce expected : "+n+".")},t.createLoginInProgressError=function(){return new t("login_progress_error","Login_In_Progress: Error during login call - login is already in progress.")},t.createAcquireTokenInProgressError=function(){return new t("acquiretoken_progress_error","AcquireToken_In_Progress: Error during login call - login is already in progress.")},t.createUserCancelledError=function(){return new t("user_cancelled","User cancelled the flow.")},t.createErrorInCallbackFunction=function(e){return new t("callback_error","Error occurred in token received callback function. "+e+".")},t.createUserLoginRequiredError=function(){return new t("user_login_error","User login is required. For silent calls, request must contain either sid or login_hint")},t.createUserDoesNotExistError=function(){return new t("user_non_existent","User object does not exist. Please call a login API.")},t.createClientInfoDecodingError=function(e){return new t("client_info_decoding_error","The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause. Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t("client_info_not_populated_error","The service did not populate client_info in the response, Please verify with the service team Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t("null_or_empty_id_token","The idToken is null or empty. Please review the trace to determine the root cause. Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t("id_token_parsing_error","ID token cannot be parsed. Please review stack trace to determine root cause. Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t("token_encoding_error","The token to be decoded is not encoded correctly. Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t("invalid_interaction_type","The interaction type passed to the handler was incorrect or unknown")},t.createCacheParseError=function(e){return new t("cannot_parse_cache","invalid key: "+e+", The cached token key is not a valid JSON and cannot be parsed")},t.createBlockTokenRequestsInHiddenIframeError=function(){return new t("block_token_requests","Token calls are blocked in hidden iframes")},t}(C),A={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},L={code:"authority_uri_insecure",desc:"Authority URIs must use https."},k={code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},M="empty_request_error",P="Request object is required.",T="telemetry_config_error",U="Telemetry config is not configured with required values",F=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,t.prototype),i}return u.a(t,e),t.createNoSetConfigurationError=function(){return new t("no_config_set","Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object.")},t.createStorageNotSupportedError=function(e){return new t("storage_not_supported","The value for the cacheLocation is not supported. Given location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t("no_redirect_callbacks","No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.")},t.createInvalidCallbackObjectError=function(e){return new t("invalid_callback_object","The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics. Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t("empty_input_scopes_error","Scopes cannot be passed as empty array. Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t("nonarray_input_scopes_error","Scopes cannot be passed as non-array. Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t("scopes_required","Scopes are required to obtain an access token. Given value: "+e)},t.createInvalidPromptError=function(e){return new t("invalid_prompt_value","Supported prompt values are 'login', 'select_account', 'consent' and 'none' Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t("claims_request_parsing_error","Could not parse the given claims request object. Given value: "+e)},t.createEmptyRequestError=function(){return new t(M,P)},t.createInvalidCorrelationIdError=function(){return new t("invalid_guid_sent_as_correlationId","Please set the correlationId as a valid guid")},t.createKnownAuthoritiesNotSetError=function(){return new t("b2c_known_authorities_not_set","Must set known authorities when validateAuthority is set to True and using B2C")},t.createInvalidAuthorityTypeError=function(){return new t(A.code,A.desc)},t.createUntrustedAuthorityError=function(e){return new t("untrusted_authority","The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false. Provided Authority: "+e)},t.createTelemetryConfigError=function(e){var n={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(T,U+" mising values: "+Object.keys(n).reduce(function(t,a){return e[a]?t:t.concat([a+" ("+n[a]+")"])},[]).join(","))},t.createSsoSilentError=function(){return new t("sso_silent_error","request must contain either sid or login_hint")},t.createInvalidAuthorityMetadataError=function(){return new t("authority_metadata_error","Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields.")},t}(E),H=function(){function e(){}return e.isIntersectingScopes=function(e,t){for(var n=this.trimAndConvertArrayToLowerCase(e.slice()),a=this.trimAndConvertArrayToLowerCase(t.slice()),i=0;i<a.length;i++)if(n.indexOf(a[i].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){var n=this.trimAndConvertArrayToLowerCase(e.slice());return this.trimAndConvertArrayToLowerCase(t.slice()).every(function(e){return n.indexOf(e.toString().toLowerCase())>=0})},e.trimAndConvertToLowerCase=function(e){return e.trim().toLowerCase()},e.trimAndConvertArrayToLowerCase=function(e){var t=this;return e.map(function(e){return t.trimAndConvertToLowerCase(e)})},e.trimScopes=function(e){return e.map(function(e){return e.trim()})},e.removeElement=function(e,t){var n=this.trimAndConvertToLowerCase(t);return e.filter(function(e){return e!==n})},e.parseScope=function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=n!==e.length-1?e[n]+" ":e[n];return t},e.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw F.createScopesNonArrayError(e);if(e.length<1&&t)throw F.createEmptyScopesArrayError(e.toString())}else if(t)throw F.createScopesRequiredError(e)},e.getScopeFromState=function(e){if(e){var t=e.indexOf(p.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.appendScopes=function(e,t){if(e){var n=t?this.trimAndConvertArrayToLowerCase(t.slice()):null,a=this.trimAndConvertArrayToLowerCase(e.slice());return n?a.concat(n):a}return null},e.onlyContainsOidcScopes=function(e){var t=e.length,n=0;return e.indexOf(p.openidScope)>-1&&(n+=1),e.indexOf(p.profileScope)>-1&&(n+=1),t>0&&t===n},e.containsAnyOidcScopes=function(e){var t=e.indexOf(p.openidScope)>-1,n=e.indexOf(p.profileScope)>-1;return t||n},e.onlyContainsClientId=function(e,t){return!!e&&e.indexOf(t)>-1&&1===e.length},e.appendDefaultScopes=function(e){var t=e;return-1===t.indexOf(p.openidScope)&&t.push(p.openidScope),-1===t.indexOf(p.profileScope)&&t.push(p.profileScope),t},e.removeDefaultScopes=function(e){return e.filter(function(e){return e!==p.openidScope&&e!==p.profileScope})},e.translateClientIdIfSingleScope=function(e,t){return this.onlyContainsClientId(e,t)?p.oidcScopes:e},e}(),R=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),n=e.authorityInstance.AuthorizationEndpoint;return n.indexOf("?")<0?n+="?":n+="&",""+n+t.join("&")},e.createNavigationUrlString=function(e){var t=H.appendDefaultScopes(e.scopes),n=[];return n.push("response_type="+e.responseType),n.push("scope="+encodeURIComponent(H.parseScope(t))),n.push("client_id="+encodeURIComponent(e.clientId)),n.push("redirect_uri="+encodeURIComponent(e.redirectUri)),n.push("state="+encodeURIComponent(e.state)),n.push("nonce="+encodeURIComponent(e.nonce)),n.push("client_info=1"),n.push("x-client-SKU="+e.xClientSku),n.push("x-client-Ver="+e.xClientVer),e.promptValue&&n.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&n.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&n.push(e.queryParameters),e.extraQueryParameters&&n.push(e.extraQueryParameters),n.push("client-request-id="+encodeURIComponent(e.correlationId)),n},e.getCurrentUrl=function(){return window.location.href.split("?")[0].split("#")[0]},e.removeHashFromUrl=function(e){return e.split("#")[0]},e.replaceTenantPath=function(e,t){var n=e.toLowerCase(),a=this.GetUrlComponents(n),i=a.PathSegments;return!t||0===i.length||i[0]!==p.common&&i[0]!==y.ORGANIZATIONS&&i[0]!==y.CONSUMERS||(i[0]=t),this.constructAuthorityUriFromObject(a,i)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.isCommonAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===p.common},e.isOrganizationsAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===y.ORGANIZATIONS},e.isConsumersAuthority=function(e){var t=this.CanonicalizeUri(e),n=this.GetUrlComponents(t).PathSegments;return 0!==n.length&&n[0]===y.CONSUMERS},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=e.match(t);if(!n||n.length<6)throw"Valid url required";var a={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5]},i=a.AbsolutePath.split("/");return i=i.filter(function(e){return e&&e.length>0}),a.PathSegments=i,n[6]&&(a.Search=n[6]),n[8]&&(a.Hash=n[8]),a},e.CanonicalizeUri=function(t){if(t){var n=t.toLowerCase();return e.endsWith(n,"/")||(n+="/"),n}return t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(s.isEmpty(e))return e;var n=new RegExp("(\\&"+t+"=)[^&]+");return e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):e},e.urlContainsHash=function(t){var n=e.deserializeHash(t);return n.hasOwnProperty(d.ERROR_DESCRIPTION)||n.hasOwnProperty(d.ERROR)||n.hasOwnProperty(d.ACCESS_TOKEN)||n.hasOwnProperty(d.ID_TOKEN)},e.deserializeHash=function(t){var n=e.getHashFromUrl(t);return f.deserialize(n)},e.getHostFromUri=function(e){return String(e).replace(/^(https?:)\/\//,"").split("/")[0]},e}(),N=function(e,t,n,a,i){this.authority=R.CanonicalizeUri(e),this.clientId=t,this.scopes=n,this.homeAccountIdentifier=f.base64Encode(a)+"."+f.base64Encode(i)},B=function(e,t,n,a){this.accessToken=e,this.idToken=t,this.expiresIn=n,this.homeAccountIdentifier=a},j=function(){function e(e,t,n,a,i,r,o){this.authorityInstance=e,this.clientId=t,this.nonce=f.createNewGuid(),this.scopes=i?i.slice():p.oidcScopes,this.scopes=H.trimScopes(this.scopes),this.state=r,this.correlationId=o,this.xClientSku="MSAL.JS",this.xClientVer=c,this.responseType=n,this.redirectUri=a}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,n,a,i){var r={};n&&(n.prompt&&(this.promptValue=n.prompt),n.claimsRequest&&(this.claimsValue=n.claimsRequest),e.isSSOParam(n)&&(r=this.constructUnifiedCacheQueryParameter(n,null))),a&&(r=this.constructUnifiedCacheQueryParameter(null,a)),r=this.addHintParameters(t,r);var o=n?n.extraQueryParameters:null;this.queryParameters=e.generateQueryParametersString(r),this.extraQueryParameters=e.generateQueryParametersString(o,i)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var n,a;if(e)if(e.account){var i=e.account;i.sid?(n=y.SID,a=i.sid):i.userName&&(n=y.LOGIN_HINT,a=i.userName)}else e.sid?(n=y.SID,a=e.sid):e.loginHint&&(n=y.LOGIN_HINT,a=e.loginHint);else t&&t.hasOwnProperty(p.upn)&&(n=y.ID_TOKEN,a=t.upn);return this.addSSOParameter(n,a)},e.prototype.addHintParameters=function(e,t){var n=t;return e&&!n[y.SID]&&(!n[y.LOGIN_HINT]&&e.sid&&this.promptValue===x.NONE?n=this.addSSOParameter(y.SID,e.sid,n):!n[y.LOGIN_HINT]&&e.userName&&!s.isEmpty(e.userName)&&(n=this.addSSOParameter(y.LOGIN_HINT,e.userName,n))),n},e.prototype.addSSOParameter=function(e,t,n){var a=n||{};if(!t)return a;switch(e){case y.SID:a[y.SID]=t;break;case y.ID_TOKEN:case y.LOGIN_HINT:a[y.LOGIN_HINT]=t}return a},e.generateQueryParametersString=function(e,t){var n=null;return e&&Object.keys(e).forEach(function(a){a===p.domain_hint&&(t||e[y.SID])||(n?n+="&"+a+"="+encodeURIComponent(e[a]):n=a+"="+encodeURIComponent(e[a]))}),n},e.isSSOParam=function(e){return!(!e||!(e.account||e.sid||e.loginHint))},e.determineResponseType=function(e,t){return H.onlyContainsOidcScopes(t)?b:e?this.responseTypeForMatchingAccounts(t):v},e.responseTypeForMatchingAccounts=function(e){return H.containsAnyOidcScopes(e)?v:g},e}(),V=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,n){var a=this;return new Promise(function(n,i){var r=new XMLHttpRequest;if(r.open(t,e,!0),r.onload=function(){var e;(r.status<200||r.status>=300)&&i(a.handleError(r.responseText));try{e=JSON.parse(r.responseText)}catch(e){i(a.handleError(r.responseText))}var t={statusCode:r.status,body:e};n(t)},r.onerror=function(){i(r.status)},"GET"!==t)throw"not implemented";r.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}(),z=function(){function e(){}return e.setTrustedAuthoritiesFromConfig=function(t,n){t&&!this.getTrustedHostList().length&&n.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})},e.getAliases=function(e,t,n){return u.t(this,void 0,void 0,function(){var a,i,r;return u.i(this,function(o){return a=new V,i="https://login.microsoftonline.com/common//discovery/instance?api-version=1.1&authorization_endpoint="+e+"oauth2/v2.0/authorize",r=t.createAndStartHttpEvent(n,"GET",i,"getAliases"),[2,a.sendRequestAsync(i,"GET",!0).then(function(e){return r.httpResponseStatus=e.statusCode,t.stopEvent(r),e.body.metadata}).catch(function(e){throw r.serverErrorCode=e,t.stopEvent(r),e})]})})},e.setTrustedAuthoritiesFromNetwork=function(t,n,a){return u.t(this,void 0,void 0,function(){var i;return u.i(this,function(r){switch(r.label){case 0:return[4,this.getAliases(t,n,a)];case 1:return r.sent().forEach(function(t){t.aliases.forEach(function(t){e.TrustedHostList.push(t.toLowerCase())})}),i=R.GetUrlComponents(t).HostNameAndPort,e.getTrustedHostList().length&&!e.IsInTrustedHostList(i)&&e.TrustedHostList.push(i.toLowerCase()),[2]}})})},e.getTrustedHostList=function(){return this.TrustedHostList},e.IsInTrustedHostList=function(e){return this.TrustedHostList.indexOf(e.toLowerCase())>-1},e.TrustedHostList=[],e}();!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(D||(D={}));var G=function(){function e(e,t,n){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri(),this.tenantDiscoveryResponse=n}return e.isAdfs=function(e){var t=R.GetUrlComponents(e).PathSegments;return t.length&&t[0].toLowerCase()===p.ADFS},Object.defineProperty(e.prototype,"AuthorityType",{get:function(){return e.isAdfs(this.canonicalAuthority)?D.Adfs:D.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g,this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.hasCachedMetadata())throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=R.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=R.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.AuthorityType===D.Adfs?""+this.CanonicalAuthority+S:this.CanonicalAuthority+"v2.0/"+S},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw A}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw L;if(!e.PathSegments||e.PathSegments.length<1)throw k},e.prototype.DiscoverEndpoints=function(e,t,n){var a=new V,i=t.createAndStartHttpEvent(n,"GET",e,"openIdConfigurationEndpoint");return a.sendRequestAsync(e,"GET",!0).then(function(e){return i.httpResponseStatus=e.statusCode,t.stopEvent(i),{AuthorizationEndpoint:e.body.authorization_endpoint,EndSessionEndpoint:e.body.end_session_endpoint,Issuer:e.body.issuer}}).catch(function(e){throw i.serverErrorCode=e,t.stopEvent(i),e})},e.prototype.resolveEndpointsAsync=function(e,t){return u.t(this,void 0,void 0,function(){var n,a,i;return u.i(this,function(r){switch(r.label){case 0:return this.IsValidationEnabled?(n=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==z.getTrustedHostList().length?[3,2]:[4,z.setTrustedAuthoritiesFromNetwork(this.canonicalAuthority,e,t)]):[3,3];case 1:r.sent(),r.label=2;case 2:if(!z.IsInTrustedHostList(n))throw F.createUntrustedAuthorityError(n);r.label=3;case 3:return a=this.GetOpenIdConfigurationEndpoint(),i=this,[4,this.DiscoverEndpoints(a,e,t)];case 4:return i.tenantDiscoveryResponse=r.sent(),[2,this.tenantDiscoveryResponse]}})})},e.prototype.hasCachedMetadata=function(){return!!(this.tenantDiscoveryResponse&&this.tenantDiscoveryResponse.AuthorizationEndpoint&&this.tenantDiscoveryResponse.EndSessionEndpoint&&this.tenantDiscoveryResponse.Issuer)},e.prototype.GetOpenIdConfigurationEndpoint=function(){return this.DefaultOpenIdConfigurationEndpoint},e}(),K=function(){function e(t,n){if(!t||s.isEmpty(t))return this.uid="",void(this.utid="");try{var a=f.base64Decode(t),i=JSON.parse(a);i&&(i.hasOwnProperty("uid")&&(this.uid=n?e.stripPolicyFromUid(i.uid,n):i.uid),i.hasOwnProperty("utid")&&(this.utid=i.utid))}catch(e){throw E.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e.createClientInfoFromIdToken=function(t,n){var a={uid:t.subject,utid:""};return new e(f.base64Encode(JSON.stringify(a)),n)},e.stripPolicyFromUid=function(e,t){var n=e.split("-"),a=t.split("/").reverse(),i="";return s.isEmpty(a[0])?a.length>1&&(i=a[1]):i=a[0],n[n.length-1]===i?n.slice(0,n.length-1).join("-"):e},e.prototype.encodeClientInfo=function(){var e=JSON.stringify({uid:this.uid,utid:this.utid});return f.base64Encode(e)},e}(),W=function(){function e(){}return e.parseExpiresIn=function(e){return parseInt(e||"3599",10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e.relativeNowMs=function(){return window.performance.now()},e}(),q=function(){function e(){}return e.decodeJwt=function(e){if(s.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.validateExpirationIsWithinOffset=function(e,t){var n=t||300;return e&&e>W.now()+n},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,a=f.base64Decode(n);return a?JSON.parse(a):null}catch(e){}return null},e}(),Q=function(e){if(s.isEmpty(e))throw E.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=q.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")?this.preferredName=this.claims.preferred_username:this.claims.hasOwnProperty("upn")&&(this.preferredName=this.claims.upn),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid),this.claims.hasOwnProperty("cloud_instance_host_name")&&(this.cloudInstance=this.claims.cloud_instance_host_name))}catch(e){throw E.createIdTokenParsingError(e)}},Y=function(e,t){this.key=e,this.value=t},J=function(){function e(e){if(!window)throw C.createNoWindowObjectError("Browser storage class could not find window object");if(void 0===window[e]||null===window[e])throw F.createStorageNotSupportedError(e);this.cacheLocation=e}return e.prototype.setItem=function(e,t,n){window[this.cacheLocation].setItem(e,t),n&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation].getItem(e)},e.prototype.removeItem=function(e){return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){return window[this.cacheLocation].clear()},e.prototype.setItemCookie=function(e,t,n){var a=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";n&&(a+="expires="+this.getCookieExpirationTime(n)+";"),document.cookie=a},e.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var i=n[a];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""},e.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e}(),X=function(){function e(){}return e.validateRequest=function(e,t,n,a){if(!t&&!e)throw F.createEmptyRequestError();var i,r;e&&(i=t?H.appendScopes(e.scopes,e.extraScopesToConsent):e.scopes,H.validateInputScope(i,!t),i=H.translateClientIdIfSingleScope(i,n),this.validatePromptParameter(e.prompt),r=this.validateEQParameters(e.extraQueryParameters,e.claimsRequest),this.validateClaimsRequest(e.claimsRequest));var o=this.validateAndGenerateState(e&&e.state,a),s=this.validateAndGenerateCorrelationId(e&&e.correlationId);return u.e({},e,{extraQueryParameters:r,scopes:i,state:o,correlationId:s})},e.validatePromptParameter=function(e){if(e&&[x.LOGIN,x.SELECT_ACCOUNT,x.CONSENT,x.NONE].indexOf(e)<0)throw F.createInvalidPromptError(e)},e.validateEQParameters=function(e,t){var n=u.e({},e);return n?(t&&delete n[p.claims],I.forEach(function(e){n[e]&&delete n[e]}),n):null},e.validateClaimsRequest=function(e){if(e)try{JSON.parse(e)}catch(e){throw F.createClaimsRequestParsingError(e)}},e.validateAndGenerateState=function(t,n){return s.isEmpty(t)?e.generateLibraryState(n):""+e.generateLibraryState(n)+p.resourceDelimiter+t},e.generateLibraryState=function(e){var t={id:f.createNewGuid(),ts:W.now(),method:e},n=JSON.stringify(t);return f.base64Encode(n)},e.parseLibraryState=function(e){var t=decodeURIComponent(e).split(p.resourceDelimiter)[0];if(f.isGuid(t))return{id:t,ts:W.now(),method:p.interactionTypeRedirect};try{var n=f.base64Decode(t);return JSON.parse(n)}catch(t){throw E.createInvalidStateError(e,null)}},e.validateAndGenerateCorrelationId=function(e){if(e&&!f.isGuid(e))throw F.createInvalidCorrelationIdError();return f.isGuid(e)?e:f.createNewGuid()},e.createRequestSignature=function(e){return""+e.scopes.join(" ").toLowerCase()+p.resourceDelimiter+e.authority},e}(),Z=function(e){function t(t,n,a){var i=e.call(this,n)||this;return i.clientId=t,i.rollbackEnabled=!0,i.migrateCacheEntries(a),i}return u.a(t,e),t.prototype.migrateCacheEntries=function(t){var n,a=this,i=p.cachePrefix+"."+_.IDTOKEN,r=p.cachePrefix+"."+_.CLIENT_INFO,o=p.cachePrefix+"."+h.ERROR,s=p.cachePrefix+"."+h.ERROR_DESC,c=e.prototype.getItem.call(this,i);if(c)try{n=new Q(c)}catch(e){return}if(n&&n.claims&&n.claims.aud===this.clientId){var d=[c,e.prototype.getItem.call(this,r),e.prototype.getItem.call(this,o),e.prototype.getItem.call(this,s)];[_.IDTOKEN,_.CLIENT_INFO,h.ERROR,h.ERROR_DESC].forEach(function(e,n){return a.duplicateCacheEntry(e,d[n],t)})}},t.prototype.duplicateCacheEntry=function(e,t,n){t&&this.setItem(e,t,n)},t.prototype.generateCacheKey=function(e,t){try{return JSON.parse(e),e}catch(n){return 0===e.indexOf(""+p.cachePrefix)||0===e.indexOf(p.adalIdToken)?e:t?p.cachePrefix+"."+this.clientId+"."+e:p.cachePrefix+"."+e}},t.prototype.matchKeyForType=function(e,t,n,a){var i=s.validateAndParseJsonCacheKey(e);if(!i)return null;var r=e.match(t)&&e.match(n),o=!1;switch(a){case d.ACCESS_TOKEN:o=!!e.match(p.scopes);break;case d.ID_TOKEN:o=!e.match(p.scopes)}return r&&o?i:null},t.prototype.setItem=function(t,n,a){e.prototype.setItem.call(this,this.generateCacheKey(t,!0),n,a),this.rollbackEnabled&&!a&&e.prototype.setItem.call(this,this.generateCacheKey(t,!1),n,a)},t.prototype.getItem=function(t,n){return e.prototype.getItem.call(this,this.generateCacheKey(t,!0),n)},t.prototype.removeItem=function(t){e.prototype.removeItem.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.removeItem.call(this,this.generateCacheKey(t,!1))},t.prototype.resetCacheItems=function(){var t,n=window[this.cacheLocation];for(t in n)n.hasOwnProperty(t)&&-1!==t.indexOf(p.cachePrefix)&&e.prototype.removeItem.call(this,t)},t.prototype.resetTempCacheItems=function(t){var n=this,a=t&&X.parseLibraryState(t).id,i=this.tokenRenewalInProgress(t),r=window[this.cacheLocation];a&&!i&&Object.keys(r).forEach(function(t){-1!==t.indexOf(a)&&(n.removeItem(t),e.prototype.clearItemCookie.call(n,t))}),this.removeItem(m.INTERACTION_STATUS),this.removeItem(m.REDIRECT_REQUEST)},t.prototype.setItemCookie=function(t,n,a){e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!0),n,a),this.rollbackEnabled&&e.prototype.setItemCookie.call(this,this.generateCacheKey(t,!1),n,a)},t.prototype.clearItemCookie=function(t){e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!0)),this.rollbackEnabled&&e.prototype.clearItemCookie.call(this,this.generateCacheKey(t,!1))},t.prototype.getItemCookie=function(t){return e.prototype.getItemCookie.call(this,this.generateCacheKey(t,!0))},t.prototype.getAllTokensByType=function(e,t,n){var a=this;return Object.keys(window[this.cacheLocation]).reduce(function(i,r){var o=a.matchKeyForType(r,e,t,n);if(o){var s=a.getItem(r);if(s)try{var c=new Y(o,JSON.parse(s));return i.concat([c])}catch(e){return i}}return i},[])},t.prototype.getAllAccessTokens=function(e,t){return this.getAllTokensByType(e,t,d.ACCESS_TOKEN)},t.prototype.getAllIdTokens=function(e,t){return this.getAllTokensByType(e,t,d.ID_TOKEN)},t.prototype.getAllTokens=function(e,t){var n=this.getAllAccessTokens(e,t),a=this.getAllIdTokens(e,t);return n.concat(a)},t.prototype.tokenRenewalInProgress=function(e){var n=this.getItem(t.generateTemporaryCacheKey(m.RENEW_STATUS,e));return!(!n||n!==p.inProgress)},t.prototype.clearMsalCookie=function(n){var a=this;n?(this.clearItemCookie(t.generateTemporaryCacheKey(m.NONCE_IDTOKEN,n)),this.clearItemCookie(t.generateTemporaryCacheKey(m.STATE_LOGIN,n)),this.clearItemCookie(t.generateTemporaryCacheKey(m.LOGIN_REQUEST,n)),this.clearItemCookie(t.generateTemporaryCacheKey(m.STATE_ACQ_TOKEN,n))):document.cookie.split(";").forEach(function(t){var n=t.trim().split("=")[0];n.indexOf(p.cachePrefix)>-1&&e.prototype.clearItemCookie.call(a,n)})},t.generateAcquireTokenAccountKey=function(e,t){var n=X.parseLibraryState(t).id;return""+m.ACQUIRE_TOKEN_ACCOUNT+p.resourceDelimiter+e+p.resourceDelimiter+n},t.generateAuthorityKey=function(e){return t.generateTemporaryCacheKey(m.AUTHORITY,e)},t.generateTemporaryCacheKey=function(e,t){var n=X.parseLibraryState(t).id;return""+e+p.resourceDelimiter+n},t}(J),$=function(){function e(e,t,n,a,i,r,o){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=n,this.name=a,this.idToken=i,this.idTokenClaims=i,this.sid=r,this.environment=o}return e.createAccount=function(t,n){var a,i=t.objectId||t.subject,r=n?n.uid:"",o=n?n.utid:"";return s.isEmpty(r)||(a=s.isEmpty(o)?f.base64Encode(r):f.base64Encode(r)+"."+f.base64Encode(o)),new e(i,a,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!!(e&&t&&e.homeAccountIdentifier&&t.homeAccountIdentifier&&e.homeAccountIdentifier===t.homeAccountIdentifier)},e}(),ee=function(){function e(){}return e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return!(!window.opener||window.opener===window)},e.generateFrameName=function(e,t){return""+e+p.resourceDelimiter+t},e.monitorIframeForHash=function(t,n,a,i){return new Promise(function(r,o){var s=W.relativeNowMs()+n;i.verbose("monitorWindowForIframe polling started");var c=setInterval(function(){if(W.relativeNowMs()>s)return i.error("monitorIframeForHash unable to find hash in url, timing out"),i.errorPii("monitorIframeForHash polling timed out for url: "+a),clearInterval(c),void o(E.createTokenRenewalTimeoutError());var e;try{e=t.location.href}catch(e){}e&&R.urlContainsHash(e)&&(i.verbose("monitorIframeForHash found url in hash"),clearInterval(c),r(t.location.hash))},e.POLLING_INTERVAL_MS)})},e.monitorPopupForHash=function(t,n,a,i){return new Promise(function(r,o){var s=n/e.POLLING_INTERVAL_MS,c=0;i.verbose("monitorWindowForHash polling started");var d=setInterval(function(){if(t.closed)return i.error("monitorWindowForHash window closed"),clearInterval(d),void o(E.createUserCancelledError());var n;try{n=t.location.href}catch(e){}if(n&&"about:blank"!==n)if(c++,n&&R.urlContainsHash(n)){i.verbose("monitorPopupForHash found url in hash"),clearInterval(d);var l=t.location.hash;e.clearUrlFragment(t),r(l)}else c>s&&(i.error("monitorPopupForHash unable to find hash in url, timing out"),i.errorPii("monitorPopupForHash polling timed out for url: "+a),clearInterval(d),o(E.createTokenRenewalTimeoutError()))},e.POLLING_INTERVAL_MS)})},e.loadFrame=function(e,t,n,a){var i=this;return a.infoPii("LoadFrame: "+t),new Promise(function(r,o){setTimeout(function(){var n=i.loadFrameSync(e,t,a);n?r(n):o("Unable to load iframe with name: "+t)},n)})},e.loadFrameSync=function(t,n,a){var i=e.addHiddenIFrame(n,a);return i?(""!==i.src&&"about:blank"!==i.src||(i.src=t,a.infoPii("Frame Name : "+n+" Navigated to: "+t)),i):null},e.addHiddenIFrame=function(e,t){if(void 0===e)return null;t.infoPii("Add msal frame to document:"+e);var n=document.getElementById(e);if(!n){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var a=document.createElement("iframe");a.setAttribute("id",e),a.setAttribute("aria-hidden","true"),a.style.visibility="hidden",a.style.position="absolute",a.style.width=a.style.height="0",a.style.border="0",a.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),n=document.getElementsByTagName("body")[0].appendChild(a)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(n=window.frames[e])}return n},e.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},e.getIframeWithHash=function(e){var t=document.getElementsByTagName("iframe");return Array.apply(null,Array(t.length)).map(function(e,n){return t.item(n)}).filter(function(t){try{return t.contentWindow.location.hash===e}catch(e){return!1}})[0]},e.getPopups=function(){return window.openedWindows||(window.openedWindows=[]),window.openedWindows},e.getPopUpWithHash=function(t){return e.getPopups().filter(function(e){try{return e.location.hash===t}catch(e){return!1}})[0]},e.trackPopup=function(t){e.getPopups().push(t)},e.closePopups=function(){e.getPopups().forEach(function(e){return e.close()})},e.blockReloadInHiddenIframes=function(){if(R.urlContainsHash(window.location.hash)&&e.isInIframe())throw E.createBlockTokenRequestsInHiddenIframeError()},e.checkIfBackButtonIsPressed=function(e){var t=e.getItem(m.REDIRECT_REQUEST);if(t&&!R.urlContainsHash(window.location.hash)){var n=t.split(p.resourceDelimiter);n.shift();var a=n.length>0?n.join(p.resourceDelimiter):null;e.resetTempCacheItems(a)}},e.clearUrlFragment=function(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,null,""+e.location.pathname+e.location.search)},e.POLLING_INTERVAL_MS=50,e}(),te=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var n=Number(t.expiration);return n&&!e.expiresOn&&(e.expiresOn=new Date(1e3*n)),u.e({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e.buildAuthResponse=function(t,n,a,i,r,o){switch(a.responseType){case b:var s=u.e({},n,{tokenType:d.ID_TOKEN,account:i,scopes:r,accountState:o});return(s=e.setResponseIdToken(s,t)).idToken?s:null;case v:var c=e.setResponseIdToken(n,t);return c&&c.accessToken&&c.idToken?c:null;case g:return e.setResponseIdToken(n,t);default:return null}},e}(),ne=function(){function e(){}return e.saveMetadataFromNetwork=function(e,t,n){return u.t(this,void 0,void 0,function(){var a;return u.i(this,function(i){switch(i.label){case 0:return[4,e.resolveEndpointsAsync(t,n)];case 1:return a=i.sent(),this.metadataMap.set(e.CanonicalAuthority,a),[2,a]}})})},e.getMetadata=function(e){return this.metadataMap.get(e)},e.saveMetadataFromConfig=function(e,t){try{if(t){var n=JSON.parse(t);if(!n.authorization_endpoint||!n.end_session_endpoint||!n.issuer)throw F.createInvalidAuthorityMetadataError();this.metadataMap.set(e,{AuthorizationEndpoint:n.authorization_endpoint,EndSessionEndpoint:n.end_session_endpoint,Issuer:n.issuer})}}catch(e){throw F.createInvalidAuthorityMetadataError()}},e.CreateInstance=function(e,t,n){return s.isEmpty(e)?null:(n&&this.saveMetadataFromConfig(e,n),new G(e,t,this.metadataMap.get(e)))},e.metadataMap=new Map,e}(),ae={clientId:"",authority:null,validateAuthority:!0,authorityMetadata:"",knownAuthorities:[],redirectUri:function(){return R.getCurrentUrl()},postLogoutRedirectUri:function(){return R.getCurrentUrl()},navigateToLoginRequestUrl:!0},ie={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},re={logger:new l(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},oe={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map},se=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return u.a(t,e),t.createServerUnavailableError=function(){return new t("server_unavailable","Server is temporarily unavailable.")},t.createUnknownServerError=function(e){return new t("unknown_server_error",e)},t}(C),ce="interaction_required",de="consent_required",le="login_required",ue=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return u.a(t,e),t.isInteractionRequiredError=function(e){return e&&[ce,de,le].indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(le,e)},t.createInteractionRequiredAuthError=function(e){return new t(ce,e)},t.createConsentRequiredAuthError=function(e){return new t(de,e)},t}(se);function fe(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e,fromCache:!1}}var pe,me,_e,he="event_name",be="elapsed_time",ge=function(e){var t=R.GetUrlComponents(e);if(G.isAdfs(e))return e;var n=t.PathSegments;if(n&&n.length>=2){var a="tfp"===n[1]?2:1;a<n.length&&(n[a]="<tenant>")}return t.Protocol+"//"+t.HostNameAndPort+"/"+n.join("/")},ve=function(e){return f.base64Encode(e)},ye=function(e){return"msal."+(e||"")},Se=function(){return!!("undefined"!=typeof window&&"performance"in window&&window.performance.mark&&window.performance.measure)},De=function(){function e(e,t,n){var a;this.eventId=f.createNewGuid(),this.label=n,this.event=((a={})[ye(he)]=e,a[ye(be)]=-1,a["Microsoft.MSAL.correlation_id"]=t,a)}return e.prototype.setElapsedTime=function(e){this.event[ye(be)]=e},e.prototype.stop=function(){var e,t,n;this.setElapsedTime(+Date.now()-+this.startTimestamp),e=this.displayName,t=this.perfStartMark,n=this.perfEndMark,Se()&&(window.performance.mark(n),window.performance.measure(e,t,n),window.performance.clearMeasures(e),window.performance.clearMarks(t),window.performance.clearMarks(n))},e.prototype.start=function(){var e;this.startTimestamp=Date.now(),this.event[ye("start_time")]=this.startTimestamp,e=this.perfStartMark,Se()&&window.performance.mark(e)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event["Microsoft.MSAL.correlation_id"]},set:function(e){this.event["Microsoft.MSAL.correlation_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[ye(he)]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return u.e({},this.event,{eventId:this.eventId})},Object.defineProperty(e.prototype,"key",{get:function(){return this.telemetryCorrelationId+"_"+this.eventId+"-"+this.eventName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return"Msal-"+this.label+"-"+this.telemetryCorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfStartMark",{get:function(){return"start-"+this.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"perfEndMark",{get:function(){return"end-"+this.key},enumerable:!0,configurable:!0}),e}(),Ie=function(e){function t(t,n,a,i){var r=e.call(this,ye("default_event"),n,"DefaultEvent")||this;return r.event[ye("client_id")]=a,r.event[ye("sdk_plaform")]=t.sdk,r.event[ye("sdk_version")]=t.sdkVersion,r.event[ye("application_name")]=t.applicationName,r.event[ye("application_version")]=t.applicationVersion,r.event[ye("effective_connection_speed")]=t.networkInformation&&t.networkInformation.connectionSpeed,r.event.Microsoft_MSAL_ui_event_count=r.getEventCount(ye("ui_event"),i),r.event.Microsoft_MSAL_http_event_count=r.getEventCount(ye("http_event"),i),r.event.Microsoft_MSAL_cache_event_count=r.getEventCount(ye("cache_event"),i),r}return u.a(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(De),xe=ye("authority"),Ce=ye("authority_type"),Oe=ye("ui_behavior"),we=ye("tenant_id"),Ee=ye("user_id"),Ae=ye("was_successful"),Le=ye("api_error_code"),ke=ye("login_hint");!function(e){e[e.AcquireTokenRedirect=2001]="AcquireTokenRedirect",e[e.AcquireTokenSilent=2002]="AcquireTokenSilent",e[e.AcquireTokenPopup=2003]="AcquireTokenPopup",e[e.LoginRedirect=2004]="LoginRedirect",e[e.LoginPopup=2005]="LoginPopup",e[e.Logout=2006]="Logout"}(me||(me={})),function(e){e.AcquireTokenRedirect="AcquireTokenRedirect",e.AcquireTokenSilent="AcquireTokenSilent",e.AcquireTokenPopup="AcquireTokenPopup",e.LoginRedirect="LoginRedirect",e.LoginPopup="LoginPopup",e.Logout="Logout"}(_e||(_e={}));var Me=((pe={})[_e.AcquireTokenSilent]=me.AcquireTokenSilent,pe[_e.AcquireTokenPopup]=me.AcquireTokenPopup,pe[_e.AcquireTokenRedirect]=me.AcquireTokenRedirect,pe[_e.LoginPopup]=me.LoginPopup,pe[_e.LoginRedirect]=me.LoginRedirect,pe[_e.Logout]=me.Logout,pe),Pe=function(e){function t(t,n,a){var i=e.call(this,ye("api_event"),t,a)||this;return a&&(i.apiCode=Me[a],i.apiEventIdentifier=a),i.piiEnabled=n,i}return u.a(t,e),Object.defineProperty(t.prototype,"apiEventIdentifier",{set:function(e){this.event["msal.api_telem_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiCode",{set:function(e){this.event["msal.api_id"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{set:function(e){this.event[xe]=ge(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiErrorCode",{set:function(e){this.event[Le]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tenantId",{set:function(e){this.event[we]=this.piiEnabled&&e?ve(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accountId",{set:function(e){this.event[Ee]=this.piiEnabled&&e?ve(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wasSuccessful",{get:function(){return!0===this.event[Ae]},set:function(e){this.event[Ae]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loginHint",{set:function(e){this.event[ke]=this.piiEnabled&&e?ve(e):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authorityType",{set:function(e){this.event[Ce]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"promptType",{set:function(e){this.event[Oe]=e.toLowerCase()},enumerable:!0,configurable:!0}),t}(De),Te=ye("http_path"),Ue=ye("user_agent"),Fe=ye("query_parameters"),He=ye("api_version"),Re=ye("response_code"),Ne=ye("oauth_error_code"),Be=ye("http_method"),je=ye("request_id_header"),Ve=ye("spe_info"),ze=ye("server_error_code"),Ge=ye("server_sub_error_code"),Ke=ye("url"),We=function(e){function t(t,n){return e.call(this,ye("http_event"),t,n)||this}return u.a(t,e),Object.defineProperty(t.prototype,"url",{set:function(e){var t=ge(e);this.event[Ke]=t&&t.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpPath",{set:function(e){this.event[Te]=ge(e).toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userAgent",{set:function(e){this.event[Ue]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryParams",{set:function(e){this.event[Fe]=j.generateQueryParametersString(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiVersion",{set:function(e){this.event[He]=e.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{set:function(e){this.event[Re]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oAuthErrorCode",{set:function(e){this.event[Ne]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"httpMethod",{set:function(e){this.event[Be]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestIdHeader",{set:function(e){this.event[je]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speInfo",{set:function(e){this.event[Ve]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{set:function(e){this.event[ze]=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverSubErrorCode",{set:function(e){this.event[Ge]=e},enumerable:!0,configurable:!0}),t}(De),qe=function(){function e(e,t,n){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=u.e({sdk:p.libraryName,sdkVersion:c,networkInformation:{connectionSpeed:"undefined"!=typeof navigator&&navigator.connection&&navigator.connection.effectiveType}},e.platform),this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t,this.logger=n}return e.getTelemetrymanagerStub=function(e,t){return new this({platform:{applicationName:"UnSetStub",applicationVersion:"0.0"},clientId:e},function(){},t)},e.prototype.startEvent=function(e){this.logger.verbose("Telemetry Event started: "+e.key),this.telemetryEmitter&&(e.start(),this.inProgressEvents[e.key]=e)},e.prototype.stopEvent=function(e){if(this.logger.verbose("Telemetry Event stopped: "+e.key),this.telemetryEmitter&&this.inProgressEvents[e.key]){e.stop(),this.incrementEventCount(e);var t=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(t||[]).concat([e]),delete this.inProgressEvents[e.key]}},e.prototype.flush=function(e){var t=this;if(this.logger.verbose("Flushing telemetry events: "+e),this.telemetryEmitter&&this.completedEvents[e]){var n=this.getOrphanedEvents(e);n.forEach(function(e){return t.incrementEventCount(e)});var a=this.completedEvents[e].concat(n);delete this.completedEvents[e];var i=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],a&&a.length){var r=new Ie(this.telemetryPlatform,e,this.clientId,i),o=a.concat([r]);this.telemetryEmitter(o.map(function(e){return e.get()}))}}},e.prototype.createAndStartApiEvent=function(e,t){var n=new Pe(e,this.logger.isPiiLoggingEnabled(),t);return this.startEvent(n),n},e.prototype.stopAndFlushApiEvent=function(e,t,n,a){t.wasSuccessful=n,a&&(t.apiErrorCode=a),this.stopEvent(t),this.flush(e)},e.prototype.createAndStartHttpEvent=function(e,t,n,a){var i=new We(e,a);return i.url=n,i.httpMethod=t,this.startEvent(i),i},e.prototype.incrementEventCount=function(e){var t,n=e.eventName,a=this.eventCountByCorrelationId[e.telemetryCorrelationId];a?a[n]=a[n]?a[n]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[n]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(n,a){if(-1!==a.indexOf(e)){var i=t.inProgressEvents[a];return delete t.inProgressEvents[a],n.concat([i])}return n},[])},e}(),Qe=function(){function e(){}return e.filterTokenCacheItemsByScope=function(e,t){return e.filter(function(e){var n=e.key.scopes.split(" "),a=H.removeDefaultScopes(t);return 0===a.length?H.containsScope(n,t):H.containsScope(n,a)})},e.filterTokenCacheItemsByAuthority=function(e,t){return e.filter(function(e){return R.CanonicalizeUri(e.key.authority)===t})},e.filterTokenCacheItemsByDomain=function(e,t){return e.filter(function(e){return R.GetUrlComponents(e.key.authority).HostNameAndPort===t})},e}(),Ye=function(){function e(e){var t,n,a,i,r,o,s,c;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(n=(t=e).auth,i=void 0===(a=t.cache)?{}:a,o=void 0===(r=t.system)?{}:r,c=void 0===(s=t.framework)?{}:s,{auth:u.e({},ae,n),cache:u.e({},ie,i),system:u.e({},re,o),framework:u.e({},oe,c)}),this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),z.setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority,this.config.auth.knownAuthorities),ne.saveMetadataFromConfig(this.config.auth.authority,this.config.auth.authorityMetadata),this.authority=this.config.auth.authority||"https://login.microsoftonline.com/common",this.cacheStorage=new Z(this.clientId,this.config.cache.cacheLocation,this.inCookie),window.activeRenewals||(window.activeRenewals={}),window.renewStates||(window.renewStates=[]),window.callbackMappedToRenewStates||(window.callbackMappedToRenewStates={}),window.promiseMappedToRenewStates||(window.promiseMappedToRenewStates={}),window.msal=this;var d=window.location.hash,l=R.urlContainsHash(d);ee.checkIfBackButtonIsPressed(this.cacheStorage),l&&this.getResponseState(d).method===p.interactionTypeRedirect&&this.handleRedirectAuthenticationResponse(d)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=ne.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw F.createInvalidCallbackObjectError(e);t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectError?this.authErrorHandler(p.interactionTypeRedirect,this.redirectError,this.redirectResponse):this.redirectResponse&&this.authResponseHandler(p.interactionTypeRedirect,this.redirectResponse)},e.prototype.urlContainsHash=function(e){return this.logger.verbose("UrlContainsHash has been called"),R.urlContainsHash(e)},e.prototype.authResponseHandler=function(e,t,n){if(this.logger.verbose("AuthResponseHandler has been called"),e===p.interactionTypeRedirect)this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback?(this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling success callback with response"),this.tokenReceivedCallback(t)):this.authResponseCallback&&(this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with response"),this.authResponseCallback(null,t));else{if(e!==p.interactionTypePopup)throw E.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, resolving"),n(t)}},e.prototype.authErrorHandler=function(e,t,n,a){if(this.logger.verbose("AuthErrorHandler has been called"),this.cacheStorage.removeItem(m.INTERACTION_STATUS),e===p.interactionTypeRedirect)if(this.logger.verbose("Interaction type is redirect"),this.errorReceivedCallback)this.logger.verbose("Two callbacks were provided to handleRedirectCallback, calling error callback"),this.errorReceivedCallback(t,n.accountState);else{if(!this.authResponseCallback)throw this.logger.verbose("handleRedirectCallback has not been called and no callbacks are registered, throwing error"),t;this.logger.verbose("One callback was provided to handleRedirectCallback, calling authResponseCallback with error"),this.authResponseCallback(t,n)}else{if(e!==p.interactionTypePopup)throw E.createInvalidInteractionTypeError();this.logger.verbose("Interaction type is popup, rejecting"),a(t)}},e.prototype.loginRedirect=function(e){this.logger.verbose("LoginRedirect has been called");var t=X.validateRequest(e,!0,this.clientId,p.interactionTypeRedirect);this.acquireTokenInteractive(p.interactionTypeRedirect,!0,t,null,null)},e.prototype.acquireTokenRedirect=function(e){this.logger.verbose("AcquireTokenRedirect has been called");var t=X.validateRequest(e,!1,this.clientId,p.interactionTypeRedirect);this.acquireTokenInteractive(p.interactionTypeRedirect,!1,t,null,null)},e.prototype.loginPopup=function(e){var t=this;this.logger.verbose("LoginPopup has been called");var n=X.validateRequest(e,!0,this.clientId,p.interactionTypePopup),a=this.telemetryManager.createAndStartApiEvent(n.correlationId,_e.LoginPopup);return new Promise(function(e,a){t.acquireTokenInteractive(p.interactionTypePopup,!0,n,e,a)}).then(function(e){return t.logger.verbose("Successfully logged in"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,a,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,a,!1,e.errorCode),e})},e.prototype.acquireTokenPopup=function(e){var t=this;this.logger.verbose("AcquireTokenPopup has been called");var n=X.validateRequest(e,!1,this.clientId,p.interactionTypePopup),a=this.telemetryManager.createAndStartApiEvent(n.correlationId,_e.AcquireTokenPopup);return new Promise(function(e,a){t.acquireTokenInteractive(p.interactionTypePopup,!1,n,e,a)}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,a,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,a,!1,e.errorCode),e})},e.prototype.acquireTokenInteractive=function(e,t,n,a,i){var r=this;this.logger.verbose("AcquireTokenInteractive has been called"),ee.blockReloadInHiddenIframes();var o,s=this.cacheStorage.getItem(m.INTERACTION_STATUS);if(e===p.interactionTypeRedirect&&this.cacheStorage.setItem(m.REDIRECT_REQUEST,""+p.inProgress+p.resourceDelimiter+n.state),s===p.inProgress){var c=t?E.createLoginInProgressError():E.createAcquireTokenInProgressError(),d=fe(this.getAccountState(n.state));return this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(e,c,d,i)}if(n&&n.account&&!t?(o=n.account,this.logger.verbose("Account set from request")):(o=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),o||j.isSSOParam(n))this.logger.verbose("User session exists, login not required"),this.acquireTokenHelper(o,e,t,n,a,i);else{if(!t)return this.logger.verbose("AcquireToken call, no context or account given"),this.logger.info("User login is required"),d=fe(this.getAccountState(n.state)),this.cacheStorage.resetTempCacheItems(n.state),void this.authErrorHandler(e,E.createUserLoginRequiredError(),d,i);if(this.extractADALIdToken()&&!n.scopes){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken");var l=this.buildIDTokenRequest(n);this.silentLogin=!0,this.acquireTokenSilent(l).then(function(t){r.silentLogin=!1,r.logger.info("Unified cache call is successful"),r.authResponseHandler(e,t,a)},function(o){r.silentLogin=!1,r.logger.error("Error occurred during unified cache ATS: "+o),r.acquireTokenHelper(null,e,t,n,a,i)})}else this.logger.verbose("Login call but no token found, proceed to login"),this.acquireTokenHelper(null,e,t,n,a,i)}},e.prototype.acquireTokenHelper=function(e,t,n,a,i,r){return u.t(this,void 0,void 0,function(){var o,s,c,d,l,f,_,g,v,y;return u.i(this,function(u){switch(u.label){case 0:this.logger.verbose("AcquireTokenHelper has been called"),this.logger.verbose("Interaction type: "+t+". isLoginCall: "+n),this.cacheStorage.setItem(m.INTERACTION_STATUS,p.inProgress),o=a.scopes?a.scopes.join(" ").toLowerCase():p.oidcScopes.join(" "),this.logger.verbosePii("Request signature: "+o),c=a&&a.authority?ne.CreateInstance(a.authority,this.config.auth.validateAuthority,a.authorityMetadata):this.authorityInstance,u.label=1;case 1:return u.trys.push([1,11,,12]),c.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ne.saveMetadataFromNetwork(c,this.telemetryManager,a.correlationId)]);case 2:return u.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),u.label=4;case 4:if(l=n?b:this.getTokenType(e,a.scopes),f=a.redirectStartPage||window.location.href,s=new j(c,this.clientId,l,this.getRedirectUri(a&&a.redirectUri),a.scopes,a.state,a.correlationId),this.logger.verbose("Finished building server authentication request"),this.updateCacheEntries(s,e,n,f),this.logger.verbose("Updating cache entries"),s.populateQueryParams(e,a),this.logger.verbose("Query parameters populated from account"),_=R.createNavigateUrl(s)+p.response_mode_fragment,t===p.interactionTypeRedirect)n?this.logger.verbose("Interaction type redirect but login call is true. State not cached"):(this.cacheStorage.setItem(Z.generateTemporaryCacheKey(m.STATE_ACQ_TOKEN,a.state),s.state,this.inCookie),this.logger.verbose("State cached for redirect"),this.logger.verbosePii("State cached: "+s.state));else{if(t!==p.interactionTypePopup)throw this.logger.verbose("Invalid interaction error. State not cached"),E.createInvalidInteractionTypeError();window.renewStates.push(s.state),window.requestType=n?p.login:p.renewToken,this.logger.verbose("State saved to window"),this.logger.verbosePii("State saved: "+s.state),this.registerCallback(s.state,o,i,r)}if(t!==p.interactionTypePopup)return[3,9];this.logger.verbose("Interaction type is popup. Generating popup window");try{d=this.openPopup(_,"msal",p.popUpWidth,p.popUpHeight),ee.trackPopup(d)}catch(e){if(this.logger.info("popup_window_error:"+w),this.cacheStorage.setItem(h.ERROR,O),this.cacheStorage.setItem(h.ERROR_DESC,w),r)return r(E.createPopupWindowError()),[2]}if(!d)return[3,8];u.label=5;case 5:return u.trys.push([5,7,,8]),[4,ee.monitorPopupForHash(d,this.config.system.loadFrameTimeout,_,this.logger)];case 6:return g=u.sent(),this.handleAuthenticationResponse(g),this.cacheStorage.removeItem(m.INTERACTION_STATUS),this.logger.info("Closing popup window"),this.config.framework.isAngular&&this.broadcast("msal:popUpHashChanged",g),ee.closePopups(),[3,8];case 7:return v=u.sent(),r&&r(v),this.config.framework.isAngular?this.broadcast("msal:popUpClosed",v.errorCode+p.resourceDelimiter+v.errorMessage):(this.cacheStorage.removeItem(m.INTERACTION_STATUS),d.close()),[3,8];case 8:return[3,10];case 9:a.onRedirectNavigate?(this.logger.verbose("Invoking onRedirectNavigate callback"),!1!==a.onRedirectNavigate(_)?(this.logger.verbose("onRedirectNavigate did not return false, navigating"),this.navigateWindow(_)):this.logger.verbose("onRedirectNavigate returned false, stopping navigation")):(this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(_)),u.label=10;case 10:return[3,12];case 11:return y=u.sent(),this.logger.error(y),this.cacheStorage.resetTempCacheItems(a.state),this.authErrorHandler(t,E.createEndpointResolutionError(y.toString),fe(a.state),r),d&&d.close(),[3,12];case 12:return[2]}})})},e.prototype.ssoSilent=function(e){if(this.logger.verbose("ssoSilent has been called"),!e)throw F.createEmptyRequestError();if(!e.sid&&!e.loginHint)throw F.createSsoSilentError();return this.acquireTokenSilent(u.e({},e,{scopes:p.oidcScopes}))},e.prototype.acquireTokenSilent=function(e){var t=this;this.logger.verbose("AcquireTokenSilent has been called");var n=X.validateRequest(e,!1,this.clientId,p.interactionTypeSilent),a=this.telemetryManager.createAndStartApiEvent(n.correlationId,_e.AcquireTokenSilent),i=X.createRequestSignature(n);return new Promise(function(e,a){return u.t(t,void 0,void 0,function(){var t,r,o,c,d,l,f,m,_,h,b;return u.i(this,function(u){switch(u.label){case 0:if(ee.blockReloadInHiddenIframes(),t=n.scopes.join(" ").toLowerCase(),this.logger.verbosePii("Serialized scopes: "+t),n.account?(r=n.account,this.logger.verbose("Account set from request")):(r=this.getAccount(),this.logger.verbose("Account set from MSAL Cache")),o=this.cacheStorage.getItem(p.adalIdToken),!r&&!n.sid&&!n.loginHint&&s.isEmpty(o))return this.logger.info("User login is required"),[2,a(E.createUserLoginRequiredError())];if(c=this.getTokenType(r,n.scopes),this.logger.verbose("Response type: "+c),d=new j(ne.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata),this.clientId,c,this.getRedirectUri(n.redirectUri),n.scopes,n.state,n.correlationId),this.logger.verbose("Finished building server authentication request"),j.isSSOParam(n)||r?(d.populateQueryParams(r,n,null,!0),this.logger.verbose("Query parameters populated from existing SSO or account")):r||s.isEmpty(o)?this.logger.verbose("No additional query parameters added"):(l=q.extractIdToken(o),this.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters"),d.populateQueryParams(r,null,l,!0)),!(f=n.claimsRequest||d.claimsValue)&&!n.forceRefresh)try{_=this.getCachedToken(d,r)}catch(e){m=e}return _?(this.logger.verbose("Token found in cache lookup"),this.logger.verbosePii("Scopes found: "+JSON.stringify(_.scopes)),e(_),[2,null]):[3,1];case 1:return m?(this.logger.infoPii(m.errorCode+":"+m.errorMessage),a(m),[2,null]):[3,2];case 2:h=f?"Skipped cache lookup since claims were given":n.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"No valid token found in cache lookup",this.logger.verbose(h),d.authorityInstance||(d.authorityInstance=n.authority?ne.CreateInstance(n.authority,this.config.auth.validateAuthority,n.authorityMetadata):this.authorityInstance),this.logger.verbosePii("Authority instance: "+d.authority),u.label=3;case 3:return u.trys.push([3,7,,8]),d.authorityInstance.hasCachedMetadata()?[3,5]:(this.logger.verbose("No cached metadata for authority"),[4,ne.saveMetadataFromNetwork(d.authorityInstance,this.telemetryManager,n.correlationId)]);case 4:return u.sent(),this.logger.verbose("Authority has been updated with endpoint discovery response"),[3,6];case 5:this.logger.verbose("Cached metadata found for authority"),u.label=6;case 6:return window.activeRenewals[i]?(this.logger.verbose("Renewing token in progress. Registering callback"),this.registerCallback(window.activeRenewals[i],i,e,a)):n.scopes&&H.onlyContainsOidcScopes(n.scopes)?(this.logger.verbose("OpenID Connect scopes only, renewing idToken"),this.silentLogin=!0,this.renewIdToken(i,e,a,r,d)):(this.logger.verbose("Renewing access token"),this.renewToken(i,e,a,r,d)),[3,8];case 7:return b=u.sent(),this.logger.error(b),a(E.createEndpointResolutionError(b.toString())),[2,null];case 8:return[2]}})})}).then(function(e){return t.logger.verbose("Successfully acquired token"),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,a,!0),e}).catch(function(e){throw t.cacheStorage.resetTempCacheItems(n.state),t.telemetryManager.stopAndFlushApiEvent(n.correlationId,a,!1,e.errorCode),e})},e.prototype.openPopup=function(e,t,n,a){this.logger.verbose("OpenPopup has been called");try{var i=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=o/2-n/2+i,d=s/2-a/2+r,l=window.open(e,t,"width="+n+", height="+a+", top="+d+", left="+c+", scrollbars=yes");if(!l)throw E.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.cacheStorage.removeItem(m.INTERACTION_STATUS),E.createPopupWindowError(e.toString())}},e.prototype.loadIframeTimeout=function(e,t,n){return u.t(this,void 0,void 0,function(){var a,i,r,o,s;return u.i(this,function(c){switch(c.label){case 0:return a=window.activeRenewals[n],this.logger.verbosePii("Set loading state to pending for: "+n+":"+a),this.cacheStorage.setItem(Z.generateTemporaryCacheKey(m.RENEW_STATUS,a),p.inProgress),this.config.system.navigateFrameWait?[4,ee.loadFrame(e,t,this.config.system.navigateFrameWait,this.logger)]:[3,2];case 1:return r=c.sent(),[3,3];case 2:r=ee.loadFrameSync(e,t,this.logger),c.label=3;case 3:i=r,c.label=4;case 4:return c.trys.push([4,6,,7]),[4,ee.monitorIframeForHash(i.contentWindow,this.config.system.loadFrameTimeout,e,this.logger)];case 5:return(o=c.sent())&&this.handleAuthenticationResponse(o),[3,7];case 6:throw s=c.sent(),this.cacheStorage.getItem(Z.generateTemporaryCacheKey(m.RENEW_STATUS,a))===p.inProgress&&(this.logger.verbose("Loading frame has timed out after: "+this.config.system.loadFrameTimeout/1e3+" seconds for scope/authority "+n+":"+a),a&&window.callbackMappedToRenewStates[a]&&window.callbackMappedToRenewStates[a](null,s),this.cacheStorage.removeItem(Z.generateTemporaryCacheKey(m.RENEW_STATUS,a))),ee.removeHiddenIframe(i),s;case 7:return ee.removeHiddenIframe(i),[2]}})})},e.prototype.navigateWindow=function(e,t){if(!e||s.isEmpty(e))throw this.logger.info("Navigate url is empty"),C.createUnexpectedError("Navigate url is empty");var n=t||window,a=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(a),n.location.assign(e)},e.prototype.registerCallback=function(e,t,n,a){var i=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:n,reject:a}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(n,a){delete window.activeRenewals[t];for(var r=0;r<window.promiseMappedToRenewStates[e].length;++r)try{if(a)window.promiseMappedToRenewStates[e][r].reject(a);else{if(!n)throw i.cacheStorage.resetTempCacheItems(e),C.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][r].resolve(n)}}catch(e){i.logger.warning(e)}delete window.promiseMappedToRenewStates[e],delete window.callbackMappedToRenewStates[e]})},e.prototype.logout=function(e){this.logger.verbose("Logout has been called"),this.logoutAsync(e)},e.prototype.logoutAsync=function(e){return u.t(this,void 0,void 0,function(){var t,n,a,i,r,o;return u.i(this,function(s){switch(s.label){case 0:t=e||f.createNewGuid(),n=this.telemetryManager.createAndStartApiEvent(t,_e.Logout),this.clearCache(),this.account=null,s.label=1;case 1:return s.trys.push([1,5,,6]),this.authorityInstance.hasCachedMetadata()?[3,3]:(this.logger.verbose("No cached metadata for authority"),[4,ne.saveMetadataFromNetwork(this.authorityInstance,this.telemetryManager,e)]);case 2:return s.sent(),[3,4];case 3:this.logger.verbose("Cached metadata found for authority"),s.label=4;case 4:return a="client-request-id="+t,i=void 0,this.getPostLogoutRedirectUri()?(i="&post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri()),this.logger.verbose("redirectUri found and set")):(i="",this.logger.verbose("No redirectUri set for app. postLogoutQueryParam is empty")),r=void 0,this.authorityInstance.EndSessionEndpoint?(r=this.authorityInstance.EndSessionEndpoint+"?"+a+i,this.logger.verbose("EndSessionEndpoint found and urlNavigate set"),this.logger.verbosePii("urlNavigate set to: "+this.authorityInstance.EndSessionEndpoint)):(r=this.authority+"oauth2/v2.0/logout?"+a+i,this.logger.verbose("No endpoint, urlNavigate set to default")),this.telemetryManager.stopAndFlushApiEvent(t,n,!0),this.logger.verbose("Navigating window to urlNavigate"),this.navigateWindow(r),[3,6];case 5:return o=s.sent(),this.telemetryManager.stopAndFlushApiEvent(t,n,!1,o.errorCode),[3,6];case 6:return[2]}})})},e.prototype.clearCache=function(){this.logger.verbose("Clearing cache"),window.renewStates=[];for(var e=this.cacheStorage.getAllTokens(p.clientId,p.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearMsalCookie(),this.logger.verbose("Cache cleared")},e.prototype.clearCacheForScope=function(e){this.logger.verbose("Clearing access token from cache");for(var t=this.cacheStorage.getAllAccessTokens(p.clientId,p.homeAccountIdentifier),n=0;n<t.length;n++){var a=t[n];a.value.accessToken===e&&(this.cacheStorage.removeItem(JSON.stringify(a.key)),this.logger.verbosePii("Access token removed: "+a.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.logger.verbose("isCallback has been called"),R.urlContainsHash(e)},e.prototype.processCallBack=function(e,t,n){this.logger.info("ProcessCallBack has been called. Processing callback from redirect response");var a,i,r=t;r||(this.logger.verbose("StateInfo is null, getting stateInfo from hash"),r=this.getResponseState(e));try{a=this.saveTokenFromHash(e,r)}catch(e){i=e}try{this.cacheStorage.clearMsalCookie(r.state);var o=this.getAccountState(r.state);if(a){if(r.requestType===p.renewToken||a.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("Acquiring token interactive in progress"),this.logger.verbose("Response tokenType set to "+d.ACCESS_TOKEN),a.tokenType=d.ACCESS_TOKEN):r.requestType===p.login&&(this.logger.verbose("Response tokenType set to "+d.ID_TOKEN),a.tokenType=d.ID_TOKEN),!n)return this.logger.verbose("Setting redirectResponse"),void(this.redirectResponse=a)}else if(!n)return this.logger.verbose("Response is null, setting redirectResponse with state"),this.redirectResponse=fe(o),this.redirectError=i,void this.cacheStorage.resetTempCacheItems(r.state);this.logger.verbose("Calling callback provided to processCallback"),n(a,i)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),E.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){this.logger.verbose("HandleAuthenticationResponse has been called");var t=e||window.location.hash,n=this.getResponseState(t);this.logger.verbose("Obtained state from response");var a=window.callbackMappedToRenewStates[n.state];this.processCallBack(t,n,a)},e.prototype.handleRedirectAuthenticationResponse=function(e){this.logger.info("Returned from redirect url"),this.logger.verbose("HandleRedirectAuthenticationResponse has been called"),ee.clearUrlFragment(window),this.logger.verbose("Window.location.hash cleared");var t=this.getResponseState(e);if(this.config.auth.navigateToLoginRequestUrl&&window.parent===window){this.logger.verbose("Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on");var n=this.cacheStorage.getItem(Z.generateTemporaryCacheKey(m.LOGIN_REQUEST,t.state),this.inCookie);if(!n||"null"===n)return this.logger.error("Unable to get valid login request url from cache, redirecting to home page"),void window.location.assign("/");this.logger.verbose("Valid login request url obtained from cache");var a=R.removeHashFromUrl(window.location.href),i=R.removeHashFromUrl(n);if(a!==i)return this.logger.verbose("Current url is not login request url, navigating"),this.logger.verbosePii("CurrentUrl: "+a+", finalRedirectUrl: "+i),void window.location.assign(""+i+e);this.logger.verbose("Current url matches login request url");var r=R.GetUrlComponents(n);r.Hash&&(this.logger.verbose("Login request url contains hash, resetting non-msal hash"),window.location.hash=r.Hash)}else this.config.auth.navigateToLoginRequestUrl||this.logger.verbose("Default navigation to start page after login turned off");this.processCallBack(e,t,null)},e.prototype.getResponseState=function(e){this.logger.verbose("GetResponseState has been called");var t,n=R.deserializeHash(e);if(!n)throw C.createUnexpectedError("Hash was not parsed correctly.");if(!n.hasOwnProperty(d.STATE))throw C.createUnexpectedError("Hash does not contain state.");this.logger.verbose("Hash contains state. Creating stateInfo object");var a=X.parseLibraryState(n.state);if((t={requestType:p.unknown,state:n.state,timestamp:a.ts,method:a.method,stateMatch:!1}).state===this.cacheStorage.getItem(Z.generateTemporaryCacheKey(m.STATE_LOGIN,t.state),this.inCookie)||t.state===this.silentAuthenticationState)return this.logger.verbose("State matches cached state, setting requestType to login"),t.requestType=p.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(Z.generateTemporaryCacheKey(m.STATE_ACQ_TOKEN,t.state),this.inCookie))return this.logger.verbose("State matches cached state, setting requestType to renewToken"),t.requestType=p.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){this.logger.verbose("State does not match cached state, setting requestType to type from window"),t.requestType=window.requestType;for(var i=window.renewStates,r=0;r<i.length;r++)if(i[r]===t.state){this.logger.verbose("Matching state found for request"),t.stateMatch=!0;break}t.stateMatch||this.logger.verbose("Matching state not found for request")}return t},e.prototype.getCachedToken=function(e,t){this.logger.verbose("GetCachedToken has been called");var n=e.scopes,a=this.getCachedIdToken(e,t),i=this.getCachedAccessToken(e,t,n),r=this.getAccountState(e.state);return te.buildAuthResponse(a,i,e,t,n,r)},e.prototype.getTokenCacheItemByAuthority=function(e,t,n,a){var i,r=this;return 1===(i=R.isCommonAuthority(e)||R.isOrganizationsAuthority(e)||R.isConsumersAuthority(e)?Qe.filterTokenCacheItemsByDomain(t,R.GetUrlComponents(e).HostNameAndPort):Qe.filterTokenCacheItemsByAuthority(t,e)).length?i[0]:i.length>1?(this.logger.warning("Multiple matching tokens found. Cleaning cache and requesting a new token."),i.forEach(function(e){r.cacheStorage.removeItem(JSON.stringify(e.key))}),null):(this.logger.verbose("No matching tokens of type "+a+" found"),null)},e.prototype.getCachedIdToken=function(e,t){this.logger.verbose("Getting all cached tokens of type ID Token");var n=this.cacheStorage.getAllIdTokens(this.clientId,t?t.homeAccountIdentifier:null),a=e.authority||this.authority,i=this.getTokenCacheItemByAuthority(a,n,null,d.ID_TOKEN);if(i){if(this.logger.verbose("Evaluating ID token found"),this.evaluateTokenExpiration(i)){this.logger.verbose("ID token expiration is within offset, using ID token found in cache");var r=i.value;return r?this.logger.verbose("ID Token found in cache is valid and unexpired"):this.logger.verbose("ID Token found in cache is invalid"),r?new Q(r.idToken):null}return this.logger.verbose("Cached ID token is expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(i.key)),null}return this.logger.verbose("No tokens found"),null},e.prototype.getCachedAccessToken=function(e,t,n){this.logger.verbose("Getting all cached tokens of type Access Token");var a=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null),i=Qe.filterTokenCacheItemsByScope(a,n),r=e.authority||this.authority,o=this.getTokenCacheItemByAuthority(r,i,n,d.ACCESS_TOKEN);if(o){if(e.authorityInstance=ne.CreateInstance(o.key.authority,this.config.auth.validateAuthority),this.logger.verbose("Evaluating access token found"),this.evaluateTokenExpiration(o)){this.logger.verbose("Access token expiration is within offset, using access token found in cache");var s=t||this.getAccount();if(!s)throw C.createUnexpectedError("Account should not be null here.");var c=this.getAccountState(e.state);return{uniqueId:"",tenantId:"",tokenType:d.ACCESS_TOKEN,idToken:null,idTokenClaims:null,accessToken:o.value.accessToken,scopes:o.key.scopes.split(" "),expiresOn:new Date(1e3*Number(o.value.expiresIn)),account:s,accountState:c,fromCache:!0}}return this.logger.verbose("Access token expired, removing from cache"),this.cacheStorage.removeItem(JSON.stringify(o.key)),null}return this.logger.verbose("No matching token found when filtering by scope and authority"),null},e.prototype.evaluateTokenExpiration=function(e){var t=Number(e.value.expiresIn);return q.validateExpirationIsWithinOffset(t,this.config.system.tokenRenewalOffsetSeconds)},e.prototype.extractADALIdToken=function(){this.logger.verbose("ExtractADALIdToken has been called");var e=this.cacheStorage.getItem(p.adalIdToken);return s.isEmpty(e)?null:q.extractIdToken(e)},e.prototype.renewToken=function(e,t,n,a,i){this.logger.verbose("RenewToken has been called"),this.logger.verbosePii("RenewToken scope and authority: "+e);var r=ee.generateFrameName("msalRenewFrame",e);ee.addHiddenIFrame(r,this.logger),this.updateCacheEntries(i,a,!1),this.logger.verbosePii("RenewToken expected state: "+i.state);var o=R.urlRemoveQueryStringParameter(R.createNavigateUrl(i),p.prompt)+p.prompt_none+p.response_mode_fragment;window.renewStates.push(i.state),window.requestType=p.renewToken,this.logger.verbose("Set window.renewState and requestType"),this.registerCallback(i.state,e,t,n),this.logger.infoPii("Navigate to: "+o),this.loadIframeTimeout(o,r,e).catch(function(e){return n(e)})},e.prototype.renewIdToken=function(e,t,n,a,i){this.logger.info("RenewIdToken has been called");var r=ee.generateFrameName("msalIdTokenFrame",e);ee.addHiddenIFrame(r,this.logger),this.updateCacheEntries(i,a,!1),this.logger.verbose("RenewIdToken expected state: "+i.state);var o=R.urlRemoveQueryStringParameter(R.createNavigateUrl(i),p.prompt)+p.prompt_none+p.response_mode_fragment;this.silentLogin?(this.logger.verbose("Silent login is true, set silentAuthenticationState"),window.requestType=p.login,this.silentAuthenticationState=i.state):(this.logger.verbose("Not silent login, set window.renewState and requestType"),window.requestType=p.renewToken,window.renewStates.push(i.state)),this.registerCallback(i.state,e,t,n),this.logger.infoPii('Navigate to:" '+o),this.loadIframeTimeout(o,r,e).catch(function(e){return n(e)})},e.prototype.saveToken=function(e,t,n,a,i){var r=new N(t,this.clientId,n,a.uid,a.utid),o=new B(e.accessToken,e.idToken.rawIdToken,i.toString(),a.encodeClientInfo());return this.cacheStorage.setItem(JSON.stringify(r),JSON.stringify(o)),i?(this.logger.verbose("New expiration set for token"),e.expiresOn=new Date(1e3*i)):this.logger.error("Could not parse expiresIn parameter for access token"),e},e.prototype.saveIdToken=function(e,t,n,a,i){this.logger.verbose("SaveIdToken has been called");var r=u.e({},e);r.scopes=p.oidcScopes,r.accessToken=n[d.ID_TOKEN];var o=Number(i.expiration);return this.logger.verbose("Saving ID token to cache"),this.saveToken(r,t,void 0,a,o)},e.prototype.saveAccessToken=function(e,t,n,a){this.logger.verbose("SaveAccessToken has been called");var i=u.e({},e),r=n[d.SCOPE],o=r.split(" "),s=this.cacheStorage.getAllAccessTokens(this.clientId,t);this.logger.verbose("Retrieving all access tokens from cache and removing duplicates");for(var c=0;c<s.length;c++){var l=s[c];if(l.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var f=l.key.scopes.split(" ");H.isIntersectingScopes(f,o)&&this.cacheStorage.removeItem(JSON.stringify(l.key))}}i.accessToken=n[d.ACCESS_TOKEN],i.scopes=o;var p=W.parseExpiresIn(n[d.EXPIRES_IN]),m=X.parseLibraryState(n[d.STATE]).ts+p;return this.logger.verbose("Saving access token to cache"),this.saveToken(i,t,r,a,m)},e.prototype.saveTokenFromHash=function(e,t){this.logger.verbose("SaveTokenFromHash has been called"),this.logger.info("State status: "+t.stateMatch+"; Request type: "+t.requestType);var n,a={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:"",fromCache:!1},i=R.deserializeHash(e),r="",o="",c=null;if(i.hasOwnProperty(d.ERROR_DESCRIPTION)||i.hasOwnProperty(d.ERROR)){if(this.logger.verbose("Server returned an error"),this.logger.infoPii("Error : "+i[d.ERROR]+"; Error description: "+i[d.ERROR_DESCRIPTION]),this.cacheStorage.setItem(h.ERROR,i[d.ERROR]),this.cacheStorage.setItem(h.ERROR_DESC,i[d.ERROR_DESCRIPTION]),t.requestType===p.login&&(this.logger.verbose("RequestType is login, caching login error, generating authorityKey"),this.cacheStorage.setItem(h.LOGIN_ERROR,i[d.ERROR_DESCRIPTION]+":"+i[d.ERROR]),r=Z.generateAuthorityKey(t.state)),t.requestType===p.renewToken){this.logger.verbose("RequestType is renewToken, generating acquireTokenAccountKey"),r=Z.generateAuthorityKey(t.state);var l=this.getAccount(),u=void 0;l&&!s.isEmpty(l.homeAccountIdentifier)?(u=l.homeAccountIdentifier,this.logger.verbose("AccountId is set")):(u=p.no_account,this.logger.verbose("AccountId is set as no_account")),o=Z.generateAcquireTokenAccountKey(u,t.state)}var f=i[d.ERROR],b=i[d.ERROR_DESCRIPTION];n=ue.isInteractionRequiredError(f)||ue.isInteractionRequiredError(b)?new ue(i[d.ERROR],i[d.ERROR_DESCRIPTION]):new se(i[d.ERROR],i[d.ERROR_DESCRIPTION])}else if(this.logger.verbose("Server returns success"),t.stateMatch){this.logger.info("State is right"),i.hasOwnProperty(d.SESSION_STATE)&&(this.logger.verbose("Fragment has session state, caching"),this.cacheStorage.setItem(Z.generateTemporaryCacheKey(m.SESSION_STATE,t.state),i[d.SESSION_STATE])),a.accountState=this.getAccountState(t.state);var g=void 0;if(i.hasOwnProperty(d.ACCESS_TOKEN)){this.logger.info("Fragment has access token"),a.accessToken=i[d.ACCESS_TOKEN],i.hasOwnProperty(d.SCOPE)&&(a.scopes=i[d.SCOPE].split(" ")),i.hasOwnProperty(d.ID_TOKEN)?(this.logger.verbose("Fragment has id_token"),c=new Q(i[d.ID_TOKEN])):(this.logger.verbose("No idToken on fragment, getting idToken from cache"),c=new Q(this.cacheStorage.getItem(_.IDTOKEN))),a=te.setResponseIdToken(a,c);var v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,c);this.logger.verbose("Got authority from cache"),i.hasOwnProperty(d.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),g=new K(i[d.CLIENT_INFO],v)):this.authorityInstance.AuthorityType===D.Adfs?g=K.createClientInfoFromIdToken(c,v):this.logger.warning("ClientInfo not received in the response from AAD"),a.account=$.createAccount(c,g),this.logger.verbose("Account object created from response");var y=void 0;a.account&&!s.isEmpty(a.account.homeAccountIdentifier)?(this.logger.verbose("AccountKey set"),y=a.account.homeAccountIdentifier):(this.logger.verbose("AccountKey set as no_account"),y=p.no_account),o=Z.generateAcquireTokenAccountKey(y,t.state);var S=Z.generateAcquireTokenAccountKey(p.no_account,t.state);this.logger.verbose("AcquireTokenAccountKey generated");var I=this.cacheStorage.getItem(o),x=void 0;s.isEmpty(I)?s.isEmpty(this.cacheStorage.getItem(S))||(this.logger.verbose("No acquireToken account retrieved from cache"),a=this.saveAccessToken(a,v,i,g)):(x=JSON.parse(I),this.logger.verbose("AcquireToken request account retrieved from cache"),a.account&&x&&$.compareAccounts(a.account,x)?(a=this.saveAccessToken(a,v,i,g),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(i.hasOwnProperty(d.ID_TOKEN))if(this.logger.info("Fragment has idToken"),c=new Q(i[d.ID_TOKEN]),v=this.populateAuthority(t.state,this.inCookie,this.cacheStorage,c),a=te.setResponseIdToken(a,c),i.hasOwnProperty(d.CLIENT_INFO)?(this.logger.verbose("Fragment has clientInfo"),g=new K(i[d.CLIENT_INFO],v)):this.authorityInstance.AuthorityType===D.Adfs?g=K.createClientInfoFromIdToken(c,v):this.logger.warning("ClientInfo not received in the response from AAD"),this.account=$.createAccount(c,g),a.account=this.account,this.logger.verbose("Account object created from response"),c&&c.nonce){this.logger.verbose("IdToken has nonce");var O=this.cacheStorage.getItem(Z.generateTemporaryCacheKey(m.NONCE_IDTOKEN,t.state),this.inCookie);c.nonce!==O?(this.account=null,this.cacheStorage.setItem(h.LOGIN_ERROR,"Nonce Mismatch. Expected Nonce: "+O+",Actual Nonce: "+c.nonce),this.logger.error("Nonce Mismatch. Expected Nonce: "+O+", Actual Nonce: "+c.nonce),n=E.createNonceMismatchError(O,c.nonce)):(this.logger.verbose("Nonce matches, saving idToken to cache"),this.cacheStorage.setItem(_.IDTOKEN,i[d.ID_TOKEN],this.inCookie),this.cacheStorage.setItem(_.CLIENT_INFO,g.encodeClientInfo(),this.inCookie),this.saveIdToken(a,v,i,g,c))}else this.logger.verbose("No idToken or no nonce. Cache key for Authority set as state"),r=t.state,o=t.state,this.logger.error("Invalid id_token received in the response"),n=E.createInvalidIdTokenError(c),this.cacheStorage.setItem(h.ERROR,n.errorCode),this.cacheStorage.setItem(h.ERROR_DESC,n.errorMessage)}else{this.logger.verbose("State mismatch"),r=t.state,o=t.state;var w=this.cacheStorage.getItem(Z.generateTemporaryCacheKey(m.STATE_LOGIN,t.state),this.inCookie);this.logger.error("State Mismatch. Expected State: "+w+", Actual State: "+t.state),n=E.createInvalidStateError(t.state,w),this.cacheStorage.setItem(h.ERROR,n.errorCode),this.cacheStorage.setItem(h.ERROR_DESC,n.errorMessage)}if(this.cacheStorage.removeItem(Z.generateTemporaryCacheKey(m.RENEW_STATUS,t.state)),this.cacheStorage.resetTempCacheItems(t.state),this.logger.verbose("Status set to complete, temporary cache cleared"),this.inCookie&&(this.logger.verbose("InCookie is true, setting authorityKey in cookie"),this.cacheStorage.setItemCookie(r,"",-1),this.cacheStorage.clearMsalCookie(t.state)),n)throw n;if(!a)throw C.createUnexpectedError("Response is null");return a},e.prototype.populateAuthority=function(e,t,n,a){this.logger.verbose("PopulateAuthority has been called");var i=Z.generateAuthorityKey(e),r=n.getItem(i,t);return s.isEmpty(r)?r:R.replaceTenantPath(r,a.tenantId)},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(_.IDTOKEN,this.inCookie),t=this.cacheStorage.getItem(_.CLIENT_INFO,this.inCookie);if(!s.isEmpty(e)&&!s.isEmpty(t)){var n=new Q(e),a=new K(t,"");return this.account=$.createAccount(n,a),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf(p.resourceDelimiter);if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(p.clientId,p.homeAccountIdentifier),n=0;n<t.length;n++){var a=new Q(t[n].value.idToken),i=new K(t[n].value.homeAccountIdentifier,""),r=$.createAccount(a,i);e.push(r)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],n=[],a=0;a<e.length;++a)e[a].homeAccountIdentifier&&-1===t.indexOf(e[a].homeAccountIdentifier)&&(t.push(e[a].homeAccountIdentifier),n.push(e[a]));return n},e.prototype.broadcast=function(e,t){var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},e.prototype.getCachedTokenInternal=function(e,t,n,a){var i=t||this.getAccount();if(!i)return null;var r=this.authorityInstance?this.authorityInstance:ne.CreateInstance(this.authority,this.config.auth.validateAuthority),o=this.getTokenType(i,e),s=new j(r,this.clientId,o,this.getRedirectUri(),e,n,a);return this.getCachedToken(s,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var n=0,a=Array.from(this.config.framework.protectedResourceMap.keys());n<a.length;n++){var i=a[n];if(e.indexOf(i)>-1)return this.config.framework.protectedResourceMap.get(i)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?R.getHostFromUri(e)===R.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return this.cacheStorage.getItem(m.INTERACTION_STATUS)===p.inProgress},e.prototype.setInteractionInProgress=function(e){e?this.cacheStorage.setItem(m.INTERACTION_STATUS,p.inProgress):this.cacheStorage.removeItem(m.INTERACTION_STATUS)},e.prototype.setloginInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getAcquireTokenInProgress=function(){return this.cacheStorage.getItem(m.INTERACTION_STATUS)===p.inProgress},e.prototype.setAcquireTokenInProgress=function(e){this.setInteractionInProgress(e)},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.getRedirectUri=function(e){return e||("function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri)},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw F.createNoSetConfigurationError();return this.config},e.prototype.getTokenType=function(e,t){var n=$.compareAccounts(e,this.getAccount());return j.determineResponseType(n,t)},e.prototype.setAccountCache=function(e,t){var n=e?this.getAccountId(e):p.no_account,a=Z.generateAcquireTokenAccountKey(n,t);this.cacheStorage.setItem(a,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var n=Z.generateAuthorityKey(e);this.cacheStorage.setItem(n,R.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,n,a){a&&this.cacheStorage.setItem(Z.generateTemporaryCacheKey(m.LOGIN_REQUEST,e.state),a,this.inCookie),n?this.cacheStorage.setItem(Z.generateTemporaryCacheKey(m.STATE_LOGIN,e.state),e.state,this.inCookie):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(Z.generateTemporaryCacheKey(m.NONCE_IDTOKEN,e.state),e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return s.isEmpty(e.homeAccountIdentifier)?p.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:p.oidcScopes,authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters,correlationId:e.correlationId}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return qe.getTelemetrymanagerStub(t,this.logger);var n=e.applicationName,a=e.applicationVersion,i=e.telemetryEmitter;if(!n||!a||!i)throw F.createTelemetryConfigError(e);return new qe({platform:{applicationName:n,applicationVersion:a},clientId:t},i,this.logger)},e}(),Je=n(1030),Xe=n(314),Ze=n(395),$e=n(852),et=n(393),tt=n(1042),nt=n(1043),at=n(934),it=function(){function e(e){this._defaultConfiguration=e,this._requestMap=new Map,this._msalInstance=this._initializeMsalJs(),this._allowedRedirectAttempts=Object(Je.e)()?13:7;var t=e.servicePrincipalId,n=e.aadInstanceUrl+"/"+e.aadTenantId;this._redirectManager=new nt.e(n,t,!1)}return e.prototype.getToken=function(e,t){void 0===t&&(t=!0);var n=t&&"object"==typeof t?Object(i.__assign)({},t):{useCachedToken:t};return this.getTokenData(e,n).then(function(e){return e.accessToken})},e.prototype.getTokenData=function(e,t,n){var a=this;void 0===t&&(t=!0),void 0===n&&(n=!1);var i,s=t&&"object"==typeof t?t:{useCachedToken:t,skipLoggingAndDisableRedirects:n,claims:void 0},c=s.claims,d=s.useCachedToken,l=void 0===d||d,u=s.skipLoggingAndDisableRedirects,f=void 0!==u&&u;if(Object($e.n)())return this.getTokenDataV2(e,{claims:c,useCachedToken:l,skipLoggingAndDisableRedirects:f});var p=this._generateTelemetryExtraData();f||(i=new o.a("MsalTokenProvider.GetTokenData")),p.isInternal&&(p.name=e);var m,_=r.f.getBrowserInformation().browser;return m=_===r.u.IE||_===r.u.Edge?this._loginSilent().then(function(){return a._acquireTokenData(e,c,f)}):this._acquireTokenData(e,c,f),p.CorrelationId=this._defaultConfiguration.spRequestGuid||r.e.newGuid().toString(),m.then(function(e){return p.alias=(!!e.fromCache).toString(),null==i||i.writeSuccess(p),e}).catch(function(e){if(f)throw e;throw a._isExpectedFailure(e)?i.writeExpectedFailure(e.errorCode,e,p):a._writeUnexpectedFailure(i,e.errorCode,e,p),e})},e.prototype.getTokenDataV2=function(e,t){var n=this,a=t.skipLoggingAndDisableRedirects,i=void 0!==a&&a,s=t.claims;return tt.e.acquireControl().then(function(){var t,a=n._generateTelemetryExtraData();i||(t=new o.a("MsalTokenProvider.GetTokenData")),a.isInternal&&(a.name=e);var c,d=r.f.getBrowserInformation().browser;return c=d===r.u.IE||d===r.u.Edge?n._loginSilent().then(function(){return n._acquireTokenData(e,s,i)}):n._acquireTokenData(e,s,i),a.CorrelationId=n._defaultConfiguration.spRequestGuid||r.e.newGuid().toString(),c.then(function(e){return tt.e.releaseControl(),a.alias=(!!e.fromCache).toString(),null==t||t.writeSuccess(a),e}).catch(function(e){if(i)throw tt.e.releaseControl(),e;throw n._isExpectedFailure(e)?t.writeExpectedFailure(e.errorCode,e,a):n._writeUnexpectedFailure(t,e.errorCode,e,a),e})})},e.prototype._loginSilent=function(){var e=new o.a("MsalTokenProvider.GetIdToken");return this._loginSilentHelper(0,e)},e.prototype._loginSilentHelper=function(e,t){var n,a=this;e>0&&(n=new o.a("MsalTokenProvider.RetryGetIdToken"));var i=this._generateTelemetryExtraData(),r={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:i.CorrelationId,loginHint:this._defaultConfiguration.userPrincipalName,scopes:[this._defaultConfiguration.servicePrincipalId]};return 0===e&&(r.sid=this._defaultConfiguration.aadSessionId,r.loginHint=void 0),this._msalInstance.acquireTokenSilent(r).then(function(e){return i.alias=(!!e.fromCache).toString(),i.jsonExtraData=JSON.stringify(a._requestMap.get(i.CorrelationId)),t.writeSuccess(i),e.accessToken}).catch(function(r){if(i.jsonExtraData=JSON.stringify(a._requestMap.get(i.CorrelationId)),a._writeUnexpectedFailure(n,r.errorCode,r,i),Ze.e._isInteractionRequired(r.message,r.errorCode)&&e<1)return a._loginSilentHelper(++e,t);a._handleAuthErrors(t,r,i,a._defaultConfiguration.servicePrincipalId)})},e.prototype._acquireTokenData=function(e,t,n){var a;return void 0===n&&(n=!1),n||(a=new o.a("MsalTokenProvider.GetAccessTokenData")),this._acquireTokenDataHelper(e,t,0,a)},e.prototype._acquireTokenDataHelper=function(e,t,n,a,r){var s,c=this;void 0===r&&(r=!1),n>0&&(s=r?new o.a("MsalTokenProvider.RetryLoginHintGetAccessToken"):new o.a("MsalTokenProvider.RetryGetAccessToken"));var d=this._generateTelemetryExtraData(),l=Object(i.__assign)({authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:d.CorrelationId,loginHint:this._defaultConfiguration.userPrincipalName,scopes:[e+"/.default"]},t?{claimsRequest:t}:{});return r||(l.sid=this._defaultConfiguration.aadSessionId,l.loginHint=void 0),this._msalInstance.acquireTokenSilent(l).then(function(e){return d.alias=(!!e.fromCache).toString(),d.jsonExtraData=JSON.stringify(c._requestMap.get(d.CorrelationId)),null==a||a.writeSuccess(d),null==s||s.writeSuccess(d),e}).catch(function(i){if(d.jsonExtraData=JSON.stringify(c._requestMap.get(d.CorrelationId)),c._writeUnexpectedFailure(s,i.errorCode,i,d),Ze.e._isTokenRenewalTimeout(i.errorCode)&&n<1||Ze.e._isEndpointsResolutionError(i.errorCode)&&n<1)return c._acquireTokenDataHelper(e,t,++n,a);if(c._defaultConfiguration.userPrincipalName&&(Ze.e._isInteractionRequired(i.message,i.errorCode)||c._isUserLoginError(i))&&n<1)return c._acquireTokenDataHelper(e,t,++n,a,!0);if(!a)throw i;c._handleAuthErrors(a,i,d,e)})},e.prototype._initializeMsalJs=function(){var e,t=this;return(e=r.b.isEnabled(467)?{auth:{clientId:this._defaultConfiguration.servicePrincipalId,navigateToLoginRequestUrl:!0,redirectUri:this._defaultConfiguration.redirectUri,validateAuthority:!1,authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId},system:{loadFrameTimeout:1e4,navigateFrameWait:0}}:{auth:{clientId:this._defaultConfiguration.servicePrincipalId,navigateToLoginRequestUrl:!1,redirectUri:this._defaultConfiguration.redirectUri,validateAuthority:!1},system:{loadFrameTimeout:1e4,navigateFrameWait:0}}).system.telemetry={applicationName:this._defaultConfiguration.servicePrincipalId,applicationVersion:"1.0",telemetryEmitter:function(e){var n="",a={};e.forEach(function(e){"msal.api_event"===e["msal.event_name"]?(n=e["Microsoft.MSAL.correlation_id"],a=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},a),t._requestMap.get(n)),e)):"msal.default_event"===e["msal.event_name"]&&(a=Object(i.__assign)(Object(i.__assign)({},a),{"msal.effective_connection_speed":e["msal.effective_connection_speed"]}))}),t._requestMap.set(n,a)}},at.e.shouldPrintMsalLogsToConsole()&&(e.system.logger=new l(at.e.msalLoggerCallback,{level:a.Verbose,piiLoggingEnabled:!0})),new Ye(e)},e.prototype._generateTelemetryExtraData=function(){return{alias:"false",CorrelationId:r.e.newGuid().toString(),isInternal:this._defaultConfiguration.servicePrincipalId===Xe.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,jsonExtraData:"",msalVersion:"1.4.12"}},e.prototype._cancelRedirect=function(){this._redirectCancelled=!0},e.prototype._handleAuthErrors=function(e,t,n,a){var i=this;if(Object($e.n)())return this._handleAuthErrorsV2(e,t,n,a);var o=r.f.getBrowserInformation().userAgent||"";if(r.b.isEnabled(467)&&r.u.IE!==r.f.getBrowserInformation().browser&&(Ze.e._isInteractionRequired(t.message,t.errorCode)||this._isUserLoginError(t))){var s=new Date,c=1,d=!1;if((c=this._getNumberOfAttemptsInLastMinute()+1)>1&&(d=!0),d||window.sessionStorage.setItem("msalRedirectFirstAttempTime",s.toString()),c<this._allowedRedirectAttempts){e.writeExpectedFailure(t.errorCode,t,n),window.sessionStorage.setItem("msalRedirectAttempNumber",c.toString()),window.sessionStorage.setItem("msalRedirectClientId",this._defaultConfiguration.servicePrincipalId);var l=function(e){return i._redirectCancelled=!1,r._.instance.raiseEvent(et.a._onBeforeRedirectEventId,new et.e(e,i._cancelRedirect.bind(i))),"true"===window.sessionStorage.getItem("_isRunningTABTest")&&(i._redirectCancelled=!0),!i._redirectCancelled},u={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:n.CorrelationId,scopes:[a+"/.default"],state:window.location.href,onRedirectNavigate:l};if(this._defaultConfiguration.userPrincipalName&&(u.loginHint=this._defaultConfiguration.userPrincipalName),this._defaultConfiguration.userPrincipalName||this._msalInstance.getAccount())this._msalInstance.acquireTokenRedirect(u);else{var f={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:n.CorrelationId,scopes:[a+"/.default"],redirectUri:this._defaultConfiguration.redirectUri,state:window.location.href};f.onRedirectNavigate=l,this._msalInstance.loginRedirect(f)}}else this._writeUnexpectedFailure(e,t.errorCode,t,n)}else Ze.e._doesAadErrorCodeExist(t.message,Xe.e.EXPECTED_AAD_ERRORS)||o.indexOf("TabStop/1.0")>-1?e.writeExpectedFailure(t.errorCode,t,n):this._writeUnexpectedFailure(e,t.errorCode,t,n);throw t},e.prototype._handleAuthErrorsV2=function(e,t,n,a){var i=this,o=r.f.getBrowserInformation().userAgent||"";if(r.u.IE!==r.f.getBrowserInformation().browser&&(Ze.e._isInteractionRequired(t.message,t.errorCode)||this._isUserLoginError(t)))if(this._redirectManager.isAllowedToRedirect()){e.writeExpectedFailure(t.errorCode,t,n),this._redirectManager.prepareForRedirect();var s=function(e){return i._redirectCancelled=!1,r._.instance.raiseEvent(et.a._onBeforeRedirectEventId,new et.e(e,i._cancelRedirect.bind(i))),"true"===window.sessionStorage.getItem("_isRunningTABTest")&&(i._redirectCancelled=!0),i._redirectCancelled&&i._redirectManager.cancelRedirect(),!i._redirectCancelled},c={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:n.CorrelationId,scopes:[a+"/.default"],state:window.location.href,onRedirectNavigate:s};if(this._defaultConfiguration.userPrincipalName&&(c.loginHint=this._defaultConfiguration.userPrincipalName),this._defaultConfiguration.userPrincipalName||this._msalInstance.getAccount())this._msalInstance.acquireTokenRedirect(c);else{var d={authority:this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId,correlationId:n.CorrelationId,scopes:[a+"/.default"],redirectUri:this._defaultConfiguration.redirectUri,state:window.location.href};d.onRedirectNavigate=s,this._msalInstance.loginRedirect(d)}}else this._writeUnexpectedFailure(e,t.errorCode,t,n),tt.e.releaseControl();else Ze.e._doesAadErrorCodeExist(t.message,Xe.e.EXPECTED_AAD_ERRORS)||o.indexOf("TabStop/1.0")>-1?(e.writeExpectedFailure(t.errorCode,t,n),tt.e.releaseControl()):(this._writeUnexpectedFailure(e,t.errorCode,t,n),tt.e.releaseControl());throw t},e.prototype._isUserLoginError=function(e){return"user_login_error"===e.errorCode},e.prototype._isExpectedFailure=function(e){var t=Ze.e._doesAadErrorCodeExist(e.message,Xe.e.EXPECTED_AAD_ERRORS),n=(r.f.getBrowserInformation().userAgent||"").indexOf("TabStop/1.0")>-1,a=this._isUserLoginError(e),i=Ze.e._isInteractionRequired(e.message,e.errorCode),o=this._getNumberOfAttemptsInLastMinute()<this._allowedRedirectAttempts;return t||n||(a||i)&&o},e.prototype._getNumberOfAttemptsInLastMinute=function(){var e=0,t=window.sessionStorage.getItem("msalRedirectFirstAttempTime");if(t){var n=new Date,a=new Date(t);if(n.getTime()-a.getTime()<6e4){var i=window.sessionStorage.getItem("msalRedirectAttempNumber")||"0";e=parseInt(i,10)}}return e},e.prototype._writeUnexpectedFailure=function(e,t,n,a){r.f.getBrowserInformation().browser===r.u.IE?null==e||e.writeExpectedFailure(t,n,a):null==e||e.writeUnexpectedFailure(t,n,a)},e}()}}]);