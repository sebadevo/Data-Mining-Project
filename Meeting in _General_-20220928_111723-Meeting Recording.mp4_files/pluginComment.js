(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[581],{84:function(e,t,n){"use strict";n.d(t,"e",function(){return a.e}),n.d(t,"n",function(){return a.n}),n.d(t,"a",function(){return a.a}),n.d(t,"t",function(){return a.t}),n.d(t,"r",function(){return a.i}),n.d(t,"o",function(){return a.r}),n.d(t,"i",function(){return i.e});var a=n(125),i=n(126),r=n(132);Object(r.e)("@uifabric/styling","7.23.0")},125:function(e,t,n){"use strict";var a=n(122);n.d(t,"e",function(){return a.t});var i=n(76);n.d(t,"n",function(){return i.t}),n.d(t,"a",function(){return i.a}),n.d(t,"t",function(){return i.e}),n.d(t,"i",function(){return i.i}),n.d(t,"r",function(){return i.r})},126:function(e,t,n){"use strict";var a=n(87);n.d(t,"e",function(){return a.n})},131:function(e,t,n){"use strict";n.d(t,"e",function(){return a.e}),n.d(t,"n",function(){return a.n}),n.d(t,"a",function(){return a.a}),n.d(t,"t",function(){return a.t}),n.d(t,"r",function(){return a.r}),n.d(t,"o",function(){return a.o}),n.d(t,"i",function(){return a.i});var a=n(84),i=n(132);Object(i.e)("@fluentui/style-utilities","0.0.0");var r=n(76);Object(r.n)()},132:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a={},i=void 0;try{i=window}catch(e){}function r(e,t){if(void 0!==i){var n=i.__packages__=i.__packages__||{};n[e]&&a[e]||(a[e]=t,(n[e]=n[e]||[]).push(t))}}r("@uifabric/set-version","6.0.0")},1081:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(421),i=n(160),r=n(43),o=n.n(r),s=n(3423),c=n(131),d=function(e){var t={color1:"#0086F0",color2:"black",color3:"#B3AFAB",color4:"#B3AFAB",color5:"#33312D",color6:"#605D5A",color7:"#797673",color8:"##605D5A",color9:"#797673"};return e.theme.isInverted&&(t={color1:"#FFD590",color2:"white",color3:"#3E8EED",color4:"#28C2D1",color5:"#E1DFDD",color6:"#72ACF1",color7:"#A7CBF6",color8:"#7BDDEF",color9:"#C3F2F4"}),o.a.createElement("svg",{width:"160",height:"160",viewBox:"0 0 160 160",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("g",{clipPath:"url(#clip0)"},o.a.createElement("path",{d:"M139.5 59.1003L105.2 93.7003C103.2 95.7003 104.1 99.2003 106.9 99.9003L154 112.4C156.8 113.1 159.3 110.6 158.6 107.8L145.8 60.8003C144.9 58.0003 141.5 57.0003 139.5 59.1003Z",fill:"url(#paint0_linear)"}),o.a.createElement("path",{d:"M39.6999 19.9007L19.2999 64.2007C18.0999 66.8007 20.1999 69.7007 22.9999 69.5007L71.4999 65.0007C74.3999 64.7007 75.8999 61.5007 74.1999 59.1007L46.0999 19.3007C44.3999 16.9007 40.8999 17.3007 39.6999 19.9007Z",fill:"url(#paint1_linear)"}),o.a.createElement("path",{d:"M78.5002 26.1006L19.6002 113.401C16.1002 118.501 19.5002 125.501 25.7002 126.001L130.8 133.401C137 133.801 141.3 127.401 138.6 121.801L92.4002 27.1006C89.7002 21.5006 82.0002 21.0006 78.5002 26.1006Z",fill:t.color1}),o.a.createElement("path",{d:"M80.5002 97.0996C78.3002 96.8996 76.6002 94.9996 76.8002 92.7996L79.7002 51.8996C79.9002 49.6996 81.8002 47.9996 84.0002 48.1996C86.2002 48.3996 87.9002 50.2996 87.7002 52.4996L84.8002 93.3996C84.6002 95.5996 82.7002 97.1996 80.5002 97.0996Z",fill:t.color2}),o.a.createElement("path",{d:"M79.9004 111.1C82.3857 111.1 84.4004 109.085 84.4004 106.6C84.4004 104.114 82.3857 102.1 79.9004 102.1C77.4151 102.1 75.4004 104.114 75.4004 106.6C75.4004 109.085 77.4151 111.1 79.9004 111.1Z",fill:t.color2}),o.a.createElement("path",{d:"M34.6001 47.6992C32.5001 48.2992 30.3001 47.0992 29.7001 44.8992L21.5001 15.9992C20.9001 13.8992 22.1001 11.6992 24.3001 11.0992C26.4001 10.4992 28.6001 11.6992 29.2001 13.8992L37.4001 42.7992C37.9001 44.8992 36.7001 47.0992 34.6001 47.6992Z",fill:t.color4}),o.a.createElement("path",{d:"M37.2002 61.3984C39.6855 61.3984 41.7002 59.3837 41.7002 56.8984C41.7002 54.4132 39.6855 52.3984 37.2002 52.3984C34.7149 52.3984 32.7002 54.4132 32.7002 56.8984C32.7002 59.3837 34.7149 61.3984 37.2002 61.3984Z",fill:t.color4}),o.a.createElement("path",{d:"M144.1 82.5994C142 81.9994 140.8 79.6994 141.4 77.5994L150 48.8994C150.6 46.7994 152.9 45.5994 155 46.1994C157.1 46.7994 158.3 49.0994 157.7 51.1994L149 79.9994C148.4 82.0994 146.2 83.2994 144.1 82.5994Z",fill:t.color3}),o.a.createElement("path",{d:"M141.3 96.2988C143.785 96.2988 145.8 94.2841 145.8 91.7988C145.8 89.3135 143.785 87.2988 141.3 87.2988C138.815 87.2988 136.8 89.3135 136.8 91.7988C136.8 94.2841 138.815 96.2988 141.3 96.2988Z",fill:t.color3}),o.a.createElement("path",{d:"M34.6001 47.6992C32.5001 48.2992 30.3001 47.0992 29.7001 44.8992L21.5001 15.9992C20.9001 13.8992 22.1001 11.6992 24.3001 11.0992C26.4001 10.4992 28.6001 11.6992 29.2001 13.8992L37.4001 42.7992C37.9001 44.8992 36.7001 47.0992 34.6001 47.6992Z",fill:t.color4}),o.a.createElement("path",{d:"M37.2002 61.3984C39.6855 61.3984 41.7002 59.3837 41.7002 56.8984C41.7002 54.4132 39.6855 52.3984 37.2002 52.3984C34.7149 52.3984 32.7002 54.4132 32.7002 56.8984C32.7002 59.3837 34.7149 61.3984 37.2002 61.3984Z",fill:t.color4}),o.a.createElement("path",{d:"M95.3996 15.3994C94.7996 16.3994 94.9996 17.5994 95.7996 18.3994C95.8996 18.4994 96.0996 18.6994 96.2996 18.6994C97.4996 19.3994 98.9996 18.9994 99.5996 17.8994L102.7 12.6994C103 12.0994 103.1 11.4994 103 10.7994C102.9 10.2994 102.6 9.79942 102.2 9.49942C102.1 9.39942 102 9.39942 101.9 9.29942C100.7 8.59942 99.1996 8.99942 98.5996 10.0994L95.3996 15.3994Z",fill:t.color5}),o.a.createElement("path",{d:"M104.9 26.5007C105 26.7007 105.2 27.0007 105.4 27.2007C106.2 27.9007 107.3 28.1007 108.2 27.6007L113.4 25.0007C114 24.7007 114.4 24.2007 114.6 23.6007C114.8 23.0007 114.8 22.3007 114.5 21.7007C114.3 21.4007 114.1 21.1007 113.8 20.9007C113.6 20.7007 113.3 20.6007 113.1 20.5007C112.5 20.3007 111.8 20.3007 111.2 20.6007L106 23.2007C105.4 23.5007 105 24.0007 104.8 24.6007C104.6 25.3007 104.6 25.9007 104.9 26.5007Z",fill:t.color5}),o.a.createElement("path",{d:"M83.1999 13.2001C83.2999 13.7001 83.4999 14.2001 83.8999 14.6001C84.3999 15.1001 85.1999 15.4001 85.8999 15.3001C87.1999 15.1001 88.1999 13.9001 87.9999 12.5001L87.0999 6.10009C86.9999 5.50009 86.6999 4.90009 86.1999 4.50009C85.6999 4.10009 84.9999 3.90009 84.2999 4.00009C82.9999 4.20009 81.9999 5.40009 82.1999 6.80009L83.1999 13.2001Z",fill:t.color5})),o.a.createElement("defs",null,o.a.createElement("linearGradient",{id:"paint0_linear",x1:"102.11",y1:"94.8736",x2:"139.197",y2:"87.1553",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{offset:"0.000984252",stopColor:t.color6}),o.a.createElement("stop",{offset:"1",stopColor:t.color7})),o.a.createElement("linearGradient",{id:"paint1_linear",x1:"70.8941",y1:"66.3197",x2:"43.1627",y2:"49.7215",gradientUnits:"userSpaceOnUse"},o.a.createElement("stop",{offset:"0.000984252",stopColor:t.color8}),o.a.createElement("stop",{offset:"1",stopColor:t.color9})),o.a.createElement("clipPath",{id:"clip0"},o.a.createElement("rect",{width:"156.6",height:"151.1",fill:"white",transform:"translate(2 4)"}))))},l=function(e){var t,n=(t=e.theme,Object(s.t)({container:{textAlign:"center",margin:"auto",fontFamily:"Segoe UI",overflow:"auto",padding:"16px"},errorMessage:{fontSize:"14px",marginTop:"8px",padding:"0 46px",color:t.palette.black},errorTitle:{fontSize:"20px",fontWeight:c.e.semibold,color:t.palette.black}}));return o.a.createElement("div",{className:n.container},e.isError?o.a.createElement(o.a.Fragment,null,o.a.createElement(d,{theme:e.theme}),o.a.createElement("div",{className:n.errorTitle},e.errorTitle),o.a.createElement("div",{className:n.errorMessage},e.errorMessage)):o.a.createElement(a.e,{size:i.e.large,label:e.loadingMessage}))}},3434:function(e,t,n){"use strict";n.r(t),n.d(t,"createPluginInstance",function(){return p});var a=n(0),i=n(43),r=n.n(i),o=n(52),s=n(1155),c=n(558),d=n(55),l=n(76),u=n(387),f=n(1081);function p(e){return new m(e)}var m=function(){function e(e){var t=this;this.metadata=e,this.areCommentsEnabled=new o.e(!1),this.richCommentsComponentPromise=void 0,this.onToggleChange=function(e){return Object(a.t)(t,void 0,void 0,function(){var t,n;return Object(a.i)(this,function(a){switch(a.label){case 0:if(!this.pluginProps.commentPropsPromise)throw"Comment props are not initialized";return this.navigation.isVisible=e,[4,this.pluginProps.commentPropsPromise];case 1:t=a.sent(),n=t.hostCommentAPI;try{n.setCommentsEnabled(e),this.areCommentsEnabled.value=e}catch(t){throw this.navigation.isVisible=!e,t}return[2]}})})}}return e.prototype.phaseHandler=function(e,t){return Object(a.t)(this,void 0,void 0,function(){var n,o,s=this;return Object(a.i)(this,function(c){switch(c.label){case 0:return"BeforeUi"!==e?[3,2]:(this.validateMetadata(t),this.isMetadataValid?(this.areCommentsEnabled.value=this.metadata.commentsOptions.value.areCommentsEnabled,this.pluginProps={telemetryApi:t.log,commentPropsPromise:void 0,localization:t.localization,areCommentsEnabled:this.areCommentsEnabled,onChangeCommentsEnabled:function(e){s.areCommentsEnabled.value=e},mediaType:this.metadata.mediaType.value,isPanelOpen:void 0,currentPlaybackTimeInSeconds:t.player.currentTimeInSeconds,targetCommentId:this.metadata.commentsOptions.value.targetCommentId},n={ariaLabel:t.localization.getString("Comments.PluginTitle"),text:t.localization.getString("Comments.PluginTitle"),tooltip:t.localization.getString("Comments.PluginTitle"),userActionName:"Comments",icon:"Comments",isEnabled:!0,hasActivity:!1,isVisible:this.areCommentsEnabled.value,getMainElement:function(){var e=Object(i.lazy)(function(){return Object(a.t)(s,void 0,void 0,function(){var e,n=this;return Object(a.i)(this,function(i){switch(i.label){case 0:return[4,this.loadRichCommentsModule(t)];case 1:return e=i.sent(),[2,{default:function(){return e?r.a.createElement(e,Object(a.e)({},n.pluginProps)):r.a.createElement(f.e,{theme:Object(l.t)(),isError:!0,errorMessage:t.localization.getString("StateLoading.Error.Message"),errorTitle:t.localization.getString("StateLoading.Error.Title")})}}]}})})});return r.a.createElement(i.Suspense,{fallback:r.a.createElement(f.e,{theme:Object(l.t)(),loadingMessage:t.localization.getString("StateLoading.Loading.Message")})},r.a.createElement(e,null))}},[4,t.ui]):[2]);case 1:return o=c.sent(),this.navigation=o.addNavigation(n),this.pluginProps.isPanelOpen=this.navigation.isPanelOpen,this.registerSetting(o,t.localization),[3,3];case 2:if("AfterUi"===e){if(!this.isMetadataValid)return[2];this.loadRichCommentsModule(t)}c.label=3;case 3:return[2]}})})},e.prototype.loadRichCommentsModule=function(e){var t=this;if(this.richCommentsComponentPromise)return this.richCommentsComponentPromise;var i=this.metadata.getAccessToken("Loki"),r={playerApi:e.player,metadata:this.metadata,sharePointLocator:this.metadata.sharePointLocator.value,telemetryApi:e.log,onePlayerVersion:u.e,localization:e.localization,settingsStore:e.onePlayerSettingsStore,showModal:function(n){return Object(a.t)(t,void 0,void 0,function(){return Object(a.i)(this,function(t){switch(t.label){case 0:return[4,e.ui];case 1:return[2,t.sent().showModal(n)]}})})},currentPlaybackTimeInSeconds:e.player.currentTimeInSeconds,lokiTokenAvailabilityCheck:i,commentsOptions:this.metadata.commentsOptions.value},o=e.log.startQos({name:"RichCommentsModuleLoad"});return this.richCommentsComponentPromise=Promise.all([n.e(14),n.e(12),n.e(13),n.e(644),n.e(146)]).then(n.bind(null,3237)).then(function(e){if(e&&e.Comment)return o.end(),t.pluginProps.commentPropsPromise=e.getCommentPropsAsync(r),e.Comment;o.endUnexpectedError("Fatal",Object(s.e)(new Error(Object(c.n)("Loaded Rich Comments entry point module is undefined"))))}).catch(function(e){o.endUnexpectedError("Fatal",Object(s.e)(e))}),this.richCommentsComponentPromise},e.prototype.registerSetting=function(e,t){var n=this;e.registerSetting({icon:"Comments",label:t.getString("MediaSettingsComments"),userActionName:"Comments",toggle:{ariaLabel:t.getString("MediaSettingsComments"),onChange:this.onToggleChange,userActionName:"Comments",value:this.areCommentsEnabled.value,getValue:function(){return n.areCommentsEnabled.value}}})},e.prototype.validateMetadata=function(e){var t;return this.metadata.sharePointLocator.value&&this.metadata.sharePointLocator.value.siteUrl!==d.e&&this.metadata.sharePointLocator.value.listItemId!==d.e&&this.metadata.sharePointLocator.value.listId!==d.e?void 0===(null===(t=this.metadata.commentsOptions.value)||void 0===t?void 0:t.areCommentsEnabled)?(e.log.fatal(Object(c.n)("Unexpected: Comments enabled flag is undefined in BeforeUi phase!"),{name:"AreCommentsEnabledUndefined",isExpected:!1}),void(this.isMetadataValid=!1)):void(this.isMetadataValid=!0):(e.log.fatal(Object(c.n)("Unexpected: SharePointLocator is undefined in BeforeUi phase!"),{name:"SharePointLocatorNotAvailable",isExpected:!1}),void(this.isMetadataValid=!1))},e}()}}]);