(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[25],Array(97).concat([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(847);t.NodeBlockElement=a.default;var i=n(391);t.getBlockElementAtNode=i.default;var r=n(1171);t.getFirstLastBlockElement=r.default;var o=n(1169);t.StartEndBlockElement=o.default;var s=n(851);t.ContentTraverser=s.default;var c=n(1959);t.PositionContentSearcher=c.default;var d=n(495);t.getInlineElementAtNode=d.default;var l=n(1172);t.ImageInlineElement=l.default;var u=n(1173);t.LinkInlineElement=u.default;var f=n(687);t.NodeInlineElement=f.default;var p=n(689);t.PartialInlineElement=p.default;var m=n(852);t.applyTextStyle=m.default;var _=n(1177);t.Browser=_.Browser,t.getBrowserInfo=_.getBrowserInfo;var h=n(1960);t.applyFormat=h.default;var b=n(1178);t.changeElementTag=b.default;var g=n(848);t.collapseNodes=g.default;var v=n(313);t.contains=v.default;var y=n(1961);t.extractClipboardEvent=y.default;var S=n(686);t.findClosestElementAncestor=S.default;var D=n(1170);t.fromHtml=D.default;var I=n(688);t.getComputedStyles=I.default,t.getComputedStyle=I.getComputedStyle;var x=n(1962);t.getPendableFormatState=x.default,t.PendableFormatCommandMap=x.PendableFormatCommandMap;var C=n(314);t.getTagOfNode=C.default;var O=n(849);t.isBlockElement=O.default;var w=n(856);t.isNodeEmpty=w.default;var E=n(1963);t.isRtl=E.default;var A=n(850);t.isVoidHtmlElement=A.default;var L=n(1964);t.matchLink=L.default;var k=n(1965);t.adjustNodeInsertPosition=k.default;var M=n(1180);t.queryElements=M.default;var P=n(572);t.splitParentNode=P.default,t.splitBalancedNodeRange=P.splitBalancedNodeRange;var T=n(1181);t.unwrap=T.default;var U=n(685);t.wrap=U.default;var F=n(496);t.getNextLeafSibling=F.getNextLeafSibling,t.getPreviousLeafSibling=F.getPreviousLeafSibling;var H=n(1175);t.getFirstLeafNode=H.getFirstLeafNode,t.getLastLeafNode=H.getLastLeafNode;var R=n(1966);t.getTextContent=R.default;var N=n(853);t.splitTextNode=N.default;var B=n(1182);t.VTable=B.default;var j=n(351);t.Position=j.default;var V=n(433);t.createRange=V.default,t.getRangeFromSelectionPath=V.getRangeFromSelectionPath;var z=n(1967);t.getPositionRect=z.default;var G=n(1179);t.isPositionAtBeginningOf=G.default;var K=n(1183);t.getSelectionPath=K.default;var W=n(1968);t.getHtmlWithSelectionPath=W.default;var q=n(1969);t.setHtmlWithSelectionPath=q.default;var Q=n(1970);t.addSnapshot=Q.default;var Y=n(857);t.canMoveCurrentSnapshot=Y.default;var J=n(1184);t.clearProceedingSnapshots=J.default;var X=n(1971);t.moveCurrentSnapsnot=X.default;var Z=n(1972);t.createSnapshots=Z.default}],Array(155),[function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.info=0]="info",e[e.error=1]="error",e[e.blocked=2]="blocked",e[e.severeWarning=3]="severeWarning",e[e.success=4]="success",e[e.warning=5]="warning"}(a||(a={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1949);t.isDocumentFragment=a.default;var i=n(1950);t.isHTMLElement=i.default;var r=n(1951);t.isHTMLOListElement=r.default;var o=n(1952);t.isHTMLTableCellElement=o.default;var s=n(1953);t.isHTMLTableElement=s.default;var c=n(1954);t.isNode=c.default;var d=n(1955);t.isRange=d.default;var l=n(390);t.safeInstanceOf=l.default}],Array(41),[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1973);t.Keys=a.Keys;var i=n(1974);t.Editor=i.default;var r=n(1194);t.Undo=r.default;var o=n(1188);t.EditPlugin=o.default;var s=n(1192);t.MouseUpPlugin=s.default;var c=n(1187);t.DOMEventPlugin=c.default;var d=n(1193);t.TypeInContainerPlugin=d.default;var l=n(1189);t.FirefoxTypeAfterLink=l.default;var u=n(1185);t.CopyPlugin=u.default;var f=n(859);t.cacheGetEventData=f.default;var p=n(1191);t.clearEventDataCache=p.default;var m=n(1190);t.cacheGetContentSearcher=m.cacheGetContentSearcher,t.clearContentSearcherCache=m.clearContentSearcherCache;var _=n(1988);t.cacheGetElementAtCursor=_.default;var h=n(1196);t.isModifierKey=h.default;var b=n(1195);t.isCharacterValue=b.default;var g=n(858);t.isCtrlOrMetaPressed=g.default}],Array(16),[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(254);t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||(a.isRange(t)&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&e.contains(t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}}],Array(16),[function(e,t,n){"use strict";function a(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1947);t.createEditor=i.default,a(n(2036)),a(n(97)),a(n(296)),a(n(434)),a(n(1168)),a(n(2051)),a(n(435)),a(n(2053))}],Array(19),[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(686),i=n(571),r=function(){function e(e,t){switch(e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=o(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=o(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=s(this.node),this.isAtEnd=!0;break;default:var n=s(this.node);this.offset=Math.max(0,Math.min(t,n)),this.isAtEnd=t>0&&t>=n}this.element=a.default(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType;){var a=0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!a)break;t=a,n=this.isAtEnd?-1:0}return new e(t,n)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:i.default(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return new e(t.endContainer,t.endOffset)},e}();function o(e){for(var t=0;e=e.previousSibling;)t++;return t}function s(e){return 3==e.nodeType?e.nodeValue.length:1==e.nodeType?e.childNodes.length:1}t.default=r}],Array(38),[function(e,t,n){"use strict";function a(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=a,t.default=function(e,t){var n=a(e),i=n&&n[t],r=window,o=r&&r[t];return o&&e instanceof o||i&&e instanceof i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(848),i=n(313),r=n(314),o=n(849),s=n(847),c=n(1169);function d(e,t,n){var a=e;if("BR"==r.default(a)&&n)return a;for(;a;){for(var i=e;!(i=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return a;for(;i;){if(o.default(i))return a;if("BR"==r.default(i))return n?i:a;e=i,i=n?e.firstChild:e.lastChild}a=e}return a}t.default=function(e,t){if(!i.default(e,t))return null;var n=c.default.getBlockContext(t);if(n==t)return new s.default(n);var r=d(t,n,!1),l=d(t,n,!0),u=a.default(e,r,l,!1);if(r=u[0],l=u[u.length-1],r.parentNode!=l.parentNode)return new c.default(e,r,l);for(;!r.previousSibling&&!l.nextSibling;){var f=r.parentNode;if(f==n){n!=e&&(r=l=f);break}r=l=f}return r==l&&o.default(r)?new s.default(r):new c.default(e,r,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=null;t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},r=e.getSelectionRange();r&&r.collapsed?(e.addUndoSnapshot(),n(),function(e){return i||(i=Object.keys(a.PendableFormatCommandMap).map(function(e){return a.PendableFormatCommandMap[e]})),i.indexOf(e)>=0}(t)&&e.triggerPluginEvent(12,{formatState:a.getPendableFormatState(e.getDocument())})):e.addUndoSnapshot(n,"Format")}}],Array(40),[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(850),i=n(351),r=n(254);function o(e,t,n,a){var o,l;if(c(e)?(o=e,l=c(t)?t:null):r.isNode(e)&&(Array.isArray(t)?(o=d(e,t),l=Array.isArray(n)?d(e,n):null):"number"==typeof t?(o=new i.default(e,t),l=r.isNode(n)?new i.default(n,a):null):!r.isNode(t)&&t||(o=new i.default(e,-2),l=new i.default(t||e,-3))),o&&o.node){var u=o.node.ownerDocument.createRange();return o=s(o),l=s(l||o),u.setStart(o.node,o.offset),u.setEnd(l.node,l.offset),u}return null}function s(e){return 1==e.node.nodeType&&a.default(e.node)?new i.default(e.node,e.isAtEnd?-3:-2):e}function c(e){return e&&e.node}function d(e,t){if(!e||!t)return null;for(var n,a=0;a<t.length&&(n=t[a],a<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);a++)e=e.childNodes[n];return new i.default(e,n)}t.default=o,t.getRangeFromSelectionPath=function(e,t){return o(e,t.start,t.end)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1991);t.changeFontSize=a.default,t.FONT_SIZES=a.FONT_SIZES;var i=n(1992);t.clearBlockFormat=i.default,t.TAGS_TO_UNWRAP=i.TAGS_TO_UNWRAP,t.TAGS_TO_STOP_UNWRAP=i.TAGS_TO_STOP_UNWRAP,t.ATTRIBUTES_TO_PRESERVE=i.ATTRIBUTES_TO_PRESERVE;var r=n(1993);t.clearFormat=r.default;var o=n(1994);t.createLink=o.default;var s=n(1997);t.getFormatState=s.default,t.getElementBasedFormatState=s.getElementBasedFormatState,t.getStyleBasedFormatState=s.getStyleBasedFormatState;var c=n(1998);t.insertImage=c.default;var d=n(1999);t.insertTable=d.default;var l=n(2e3);t.editTable=l.default;var u=n(2001);t.formatTable=u.default;var f=n(2002);t.removeLink=f.default;var p=n(2003);t.replaceWithNode=p.default;var m=n(2004);t.setAlignment=m.default;var _=n(1201);t.setBackgroundColor=_.default;var h=n(1204);t.setTextColor=h.default;var b=n(2005);t.setDirection=b.default;var g=n(1202);t.setFontName=g.default;var v=n(1203);t.setFontSize=v.default;var y=n(2006);t.setImageAltText=y.default;var S=n(2007);t.setIndentation=S.default;var D=n(1205);t.toggleBold=D.default;var I=n(2008);t.toggleBullet=I.default;var x=n(1206);t.toggleItalic=x.default;var C=n(2009);t.toggleNumbering=C.default;var O=n(2010);t.toggleBlockQuote=O.default;var w=n(2011);t.toggleCodeBlock=w.default;var E=n(2012);t.toggleStrikethrough=E.default;var A=n(2013);t.toggleSubscript=A.default;var L=n(2014);t.toggleSuperscript=L.default;var k=n(1207);t.toggleUnderline=k.default;var M=n(2015);t.toggleHeader=M.default;var P=n(97);t.getPendableFormatState=P.getPendableFormatState},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1995);t.HtmlSanitizer=a.default;var i=n(1209);t.htmlToDom=i.default,t.splitWithFragment=i.splitWithFragment;var r=n(1208);t.getInheritableStyles=r.default}],Array(59),[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(391),i=n(314),r=n(1172),o=n(1173),s=n(687),c=n(254);t.default=function(e,t){var n=c.isNode(e)?a.default(e,t):e;return t&&n&&function(e,t){for(var n,a=[e],c=e.parentNode;c&&t.contains(c);c=c.parentNode)a.push(c);for(var d=a.length-1;d>=0&&!n;d--){var l=a[d],u=i.default(l);"A"==u?n=new o.default(l,t):"IMG"==u&&(n=new r.default(l,t))}return n||new s.default(e,t)}(t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(313),i=n(854);function r(e,t,n){var r=null,o=n?function(e){return e.nextSibling}:function(e){return e.previousSibling},s=n?function(e){return e.firstChild}:function(e){return e.lastChild};if(a.default(e,t))for(var c=t,d=!0;d;){var l=c.parentNode;for(c=o(c);!c&&l!=e;)c=o(l),l=l.parentNode;for(;c&&s(c);)c=s(c);if(!(d=c&&i.default(c))){r=c;break}}return r}t.getLeafSibling=r,t.getNextLeafSibling=function(e,t){return r(e,t,!0)},t.getPreviousLeafSibling=function(e,t){return r(e,t,!1)}}],Array(67),[function(e,t,n){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)},function(e,t,n){"use strict";var a="%[a-f0-9]{2}",i=new RegExp(a,"gi"),r=new RegExp("("+a+")+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),a=e.slice(t);return Array.prototype.concat.call([],o(n),o(a))}function s(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(i),n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(i);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var a=s(n[0]);a!==n[0]&&(t[n[0]]=a)}n=r.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),o=0;o<i.length;o++){var c=i[o];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},function(e,t,n){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(571);function i(e,t){if(!e||!e.parentNode)return null;var n=e.parentNode,a=n.cloneNode(!1);if(a.removeAttribute("id"),t)for(;n.firstChild&&n.firstChild!=e;)a.appendChild(n.firstChild);else for(;e.nextSibling;)a.appendChild(e.nextSibling);return a.firstChild&&""!=a.innerHTML?n.parentNode.insertBefore(a,t?n:n.nextSibling):a=null,a}t.default=i,t.splitBalancedNodeRange=function(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,r=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(r){if(a.default(t,n)){var o=n;n=t,t=o}i(t,!0),i(n,!1)}return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var i=n.startContainer;"SPAN"!=a.getTagOfNode(i)||i.firstChild&&("BR"!=a.getTagOfNode(i.firstChild)||i.firstChild.nextSibling)?(i&&3==i.nodeType&&"​"==i.nodeValue&&"SPAN"==a.getTagOfNode(i.parentNode)||(e.addUndoSnapshot(),i=e.getDocument().createTextNode("​"),n.insertNode(i)),a.applyTextStyle(i,t),e.select(i,-1)):(e.addUndoSnapshot(),t(i))}else e.addUndoSnapshot(function(){for(var n,a,i=e.getSelectionTraverser(),r=i&&i.currentInlineElement;r;){var o=i.getNextInlineElement();r.applyStyle(function(e,i){t(e,i),n=n||e,a=e}),r=o}n&&a&&e.select(n,-2,a,-3)},"Format")}}],Array(108),[function(e,t,n){"use strict";const a=n(564),i=n(565),r=n(566);function o(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function s(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function c(e,t){return t.decode?i(e):e}function d(e){return Array.isArray(e)?e.sort():"object"==typeof e?d(Object.keys(e)).sort((e,t)=>Number(e)-Number(t)).map(t=>e[t]):e}function l(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function u(e){const t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function p(e,t){o((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,a)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===a[e]&&(a[e]={}),a[e][t[1]]=n):a[e]=n};case"bracket":return(e,n,a)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==a[e]?a[e]=[].concat(a[e],n):a[e]=[n]:a[e]=n};case"comma":case"separator":return(t,n,a)=>{const i="string"==typeof n&&n.includes(e.arrayFormatSeparator),r="string"==typeof n&&!i&&c(n,e).includes(e.arrayFormatSeparator);n=r?c(n,e):n;const o=i||r?n.split(e.arrayFormatSeparator).map(t=>c(t,e)):null===n?n:c(n,e);a[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const i of e.split("&")){let[e,o]=r(t.decode?i.replace(/\+/g," "):i,"=");o=void 0===o?null:["comma","separator"].includes(t.arrayFormat)?o:c(o,t),n(c(e,t),o,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=f(n[e],t);else a[e]=f(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=d(n):e[t]=n,e},Object.create(null))}t.extract=u,t.parse=p,t.stringify=(e,t)=>{if(!e)return"";o((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,a)=>{const i=n.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,[s(t,e),"[",i,"]"].join("")]:[...n,[s(t,e),"[",s(i,e),"]=",s(a,e)].join("")]};case"bracket":return t=>(n,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,[s(t,e),"[]"].join("")]:[...n,[s(t,e),"[]=",s(a,e)].join("")];case"comma":case"separator":return t=>(n,a)=>null==a||0===a.length?n:0===n.length?[[s(t,e),"=",s(a,e)].join("")]:[[n,s(a,e)].join(e.arrayFormatSeparator)];default:return t=>(n,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,s(t,e)]:[...n,[s(t,e),"=",s(a,e)].join("")]}}(t),i={};for(const t of Object.keys(e))n(t)||(i[t]=e[t]);const r=Object.keys(i);return!1!==t.sort&&r.sort(t.sort),r.map(n=>{const i=e[n];return void 0===i?"":null===i?s(n,t):Array.isArray(i)?i.reduce(a(n),[]).join("&"):s(n,t)+"="+s(i,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,a]=r(e,"#");return Object.assign({url:n.split("?")[0]||"",query:p(u(e),t)},t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:c(a,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const a=l(e.url).split("?")[0]||"",i=t.extract(e.url),r=t.parse(i,{sort:!1}),o=Object.assign(r,e.query);let c=t.stringify(o,n);c&&(c=`?${c}`);let d=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(d=`#${s(e.fragmentIdentifier,n)}`),`${a}${c}${d}`}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1170),i=n(254);t.default=function(e,t){if(0==(e=e?i.isNode(e)?[e]:e:[]).length||!e[0])return null;if(!i.isHTMLElement(t)){var n=e[0].ownerDocument;t=/^\w+$/.test(t=t||"div")?n.createElement(t):a.default(t,n)[0]}var r=e[0].parentNode;r&&r.insertBefore(t,e[0]);for(var o=0,s=e;o<s.length;o++){var c=s[o];t.appendChild(c)}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(313);t.default=function(e,t,n){var i=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(i&&n)if(i.closest)i=i.closest(n);else for(;i&&i!=t&&!(i.matches||i.msMatchesSelector).call(i,n);)i=i.parentElement;return!t||a.default(t,i)?i:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(852),i=n(571),r=n(351),o=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return 3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new r.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new r.default(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&i.default(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){a.default(this.containerNode,e)},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(686);function i(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var n,i=a.default(e),r=[];if(t=Array.isArray(t)?t:[t],i){var o=(i.ownerDocument.defaultView||window).getComputedStyle(i);if(o)for(var s=0,c=t;s<c.length;s++){var d=c[s],l=(o.getPropertyValue(d)||"").toLowerCase();l="font-size"==d?(n=l)&&n.indexOf("px")==n.length-2?Math.round(75*parseFloat(n)+.05)/100+"pt":n:l,r.push(l)}}return r}t.default=i,t.getComputedStyle=function(e,t){return i(e,t)[0]||""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(852),i=n(433),r=n(351),o=n(496),s=function(){function e(e,t,n){this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return i.default(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end&&new e(this.inlineElement,this.end,null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start&&new e(this.inlineElement,null,this.start)},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),i=this.getContainerNode();if(t.isAtEnd){var s=o.getNextLeafSibling(i,t.node);t=s?new r.default(s,0):null}if(0==n.offset){var c=o.getPreviousLeafSibling(i,n.node);n=c?new r.default(c,-1):null}a.default(i,e,t,n)},e}();t.default=s}],Array(150),[function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,i)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(841),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.schemaVersion=void 0,t.schemaVersion="2.1.0"},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(313),i=n(571),r=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return i.default(this.element,e.getEndNode())},e.prototype.contains=function(e){return a.default(this.element,e,!0)},e.prototype.getTextContent=function(){return this.element.textContent},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(313),i=n(572);function r(e,t,n,r,o){for(;t.parentNode!=e&&!a.default(t.parentNode,n);){if(r&&t.previousSibling||!r&&t.nextSibling){if(!o)break;i.default(t,r)}t=t.parentNode}return t}t.default=function(e,t,n,i){if(!a.default(e,t)||!a.default(e,n))return[];if(t=r(e,t,n,!0,i),n=r(e,n,t,!1,i),a.default(t,n,!0))return[t];if(a.default(n,t))return[n];if(t.parentNode==n.parentNode){var o=[].slice.call(t.parentNode.childNodes),s=o.indexOf(t),c=o.indexOf(n);return o.slice(s,c+1)}return[t,n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(314),i="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),r=["block","list-item","table-cell"];t.default=function(e){var t=a.default(e);return!(!t||!(r.indexOf(e.style.display)>=0||i.indexOf(t)>=0))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(314),i="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&i.indexOf(a.default(e))>=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1956),i=n(1176),r=n(391),o=n(495),s=n(689),c=n(1957),d=n(1958),l=n(855),u=n(496),f=function(){function e(e){this.scoper=e}return e.createBodyTraverser=function(t,n){return new e(new a.default(t,n))},e.createSelectionTraverser=function(t,n){return new e(new d.default(t,n))},e.createBlockTraverser=function(t,n,a){return void 0===a&&(a=3),new e(new c.default(t,n,a))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!0,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement,n=u.getLeafSibling(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e),a=n?r.default(this.scoper.rootNode,n):null;return a&&this.scoper.isBlockInScope(a)&&(e&&a.isAfter(t)||!e&&t.isAfter(a))?(this.currentBlock=a,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof i.default?null:this.currentInline},enumerable:!0,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n instanceof i.default?(t=l.getInlineElementBeforeAfter(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):(t=function(e,t,n){if(!t)return null;if(t instanceof s.default){var a=n?t.nextInlineElement:t.previousInlineElement;if(a)return a}var i=t.getContainerNode();return i=u.getLeafSibling(e,i,n),o.default(e,i)}(this.scoper.rootNode,n,e),t=t&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null),t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(314),i=n(351),r=n(853),o=n(685),s=n(496),c=n(572),d="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function l(e,t){e&&1==e.nodeType&&t(e,!0)}t.default=function(e,t,n,u){void 0===n&&(n=new i.default(e,0).normalize()),void 0===u&&(u=new i.default(e,-1).normalize());for(var f=[];n&&u&&u.isAfter(n);){var p=n.node,m=a.default(p.parentNode),_=s.getNextLeafSibling(e,p);3==p.nodeType&&["TR","TABLE"].indexOf(m)<0&&(p!=u.node||u.isAtEnd||(p=r.default(p,u.offset,!0)),n.offset>0&&(p=r.default(p,n.offset,!1)),f.push(p)),n=_&&new i.default(_,0)}if(f.length>0){if(f.every(function(e){return e.parentNode==f[0].parentNode})){var h=f.shift();f.forEach(function(e){h.nodeValue+=e.nodeValue,e.parentNode.removeChild(e)}),f=[h]}f.forEach(function(e){for(;"SPAN"!=a.default(e)&&d.indexOf(a.default(e.parentNode))>=0;)l(e,t),e=c.splitBalancedNodeRange(e);"SPAN"!=a.default(e)&&(l(e,t),e=o.default(e,"SPAN")),t(e)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var a=e.nodeValue.substr(0,t),i=e.nodeValue.substr(t),r=e.ownerDocument.createTextNode(n?a:i);return e.nodeValue=n?i:a,e.parentNode.insertBefore(r,n?e:e.nextSibling),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(688),i=/^[\r\n]+$/gm;t.default=function(e){return 3==e.nodeType?!e.nodeValue||""==e.textContent||i.test(e.nodeValue):1!=e.nodeType||"none"==a.getComputedStyle(e,"display")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(495),i=n(689),r=n(854),o=n(496);function s(e,t,n){if(!e||!t||!t.node)return null;var s=(t=t.normalize()).node,c=t.offset,d=t.isAtEnd,l=!1;!n&&0==c&&!d||n&&d?s=o.getLeafSibling(e,s,n):3==s.nodeType&&(!n&&!d||n&&c>0)&&(l=!0),s&&r.default(s)&&(s=o.getLeafSibling(e,s,n));var u=a.default(e,s);return u&&(l||u.contains(t))&&(u=n?new i.default(u,t,null):new i.default(u,null,t)),u}t.getInlineElementBefore=function(e,t){return s(e,t,!1)},t.getInlineElementAfter=function(e,t){return s(e,t,!0)},t.getInlineElementBeforeAfter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(314),i=["IMG"],r=["TABLE","IMG","LI"].join(","),o=/\u200b/g;function s(e,t){return e=e.replace(o,""),t?e.trim():e}t.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==s(e.nodeValue,t);if(1==e.nodeType){var n=e;if(""!=s(n.textContent,t)||i.indexOf(a.default(n))>=0||n.querySelectorAll(r)[0])return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var a=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=a),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.default=function(e,t){var n=e.getElementAtCursor("OL,UL");if(a.Browser.isChrome&&"indent"!==t){var i=e.getElementAtCursor("LI");if(i){var r=e.getSelectionRange(),o=a.getSelectionPath(i,r);if(r&&(r.collapsed||e.getElementAtCursor("LI",r.startContainer)==i&&e.getElementAtCursor("LI",r.endContainer)==i))if("OL"===n.tagName&&"insertUnorderedList"===t||"UL"===n.tagName&&"insertOrderedList"===t)e.getDocument().execCommand(t,!1,null);else{var s=n.parentElement;if("OL"==s.tagName||"UL"==s.tagName)i.nextElementSibling&&a.splitBalancedNodeRange(i),n.insertAdjacentElement("afterend",i),e.select(a.createRange(i,o.start,o.end));else{i.nextElementSibling&&a.splitBalancedNodeRange(i);var c=a.wrap([].slice.call(i.childNodes)),d=a.createRange(c,o.start,o.end),l=a.getSelectionPath(c,d);n.insertAdjacentElement("afterend",c),e.deleteNode(i);var u=a.createRange(c,l.start,l.end);e.select(u)}0==n.childElementCount&&e.deleteNode(n)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null);var f=e.getElementAtCursor("OL,UL");return f==n&&(f=null),f}}],Array(307),[function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1948);t.HyperLink=a.default;var i=n(1989);t.ContentEdit=i.default;var r=n(2022);t.Paste=r.default;var o=n(1199);t.getDefaultContentEditFeatures=o.getDefaultContentEditFeatures;var s=n(2033);t.Watermark=s.default;var c=n(2034);t.TableResize=c.default;var d=n(2035);t.CustomReplace=d.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(848),i=n(313),r=n(314),o=n(849),s=n(571),c=n(685),d=n(572),l=n(433),u=["TD","TH","LI","BLOCKQUOTE"],f=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(;e&&!o.default(e);)e=e.parentNode;return e},e.prototype.collapseToSingleElement=function(){for(var t=a.default(e.getBlockContext(this.startNode),this.startNode,this.endNode,!0),n=e.getBlockContext(this.startNode);t[0]&&t[0]!=n&&t[0].parentNode!=this.rootNode&&u.indexOf(r.default(t[0].parentNode))<0;)t=[d.splitBalancedNodeRange(t)];return 1==t.length&&o.default(t[0])?t[0]:c.default(t)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return s.default(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return i.default(this.startNode,e,!0)||i.default(this.endNode,e,!0)||s.default(e,this.startNode)&&s.default(this.endNode,e)},e.prototype.getTextContent=function(){return l.default(this.getStartNode(),this.getEndNode()).toString()},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,[].slice.call(n.childNodes)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(391);function i(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&a.default(e,n)}t.default=i,t.getFirstBlockElement=function(e){return i(e,!0)},t.getLastBlockElement=function(e){return i(e,!1)}},function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t}(n(687).default);t.default=r},function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t}(n(687).default);t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(495),i=n(1175);t.getFirstInlineElement=function(e){var t=i.getFirstLeafNode(e);return t?a.default(e,t):null},t.getLastInlineElement=function(e){var t=i.getLastLeafNode(e);return t?a.default(e,t):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(854),i=n(496);function r(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},r=n(e);r&&n(r);)r=n(r);return r&&a.default(r)&&(r=i.getLeafSibling(e,r,t)),r}t.getFirstLeafNode=function(e){return r(e,!0)},t.getLastLeafNode=function(e){return r(e,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=a},function(e,t,n){"use strict";function a(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),a=-1!=e.indexOf("MSIE")||n,i=!1,r=!1,o=!1,s=!1,c=-1!=e.indexOf("WebKit");return a||(i=-1!=e.indexOf("Chrome"),r=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(o=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(s=-1!=e.indexOf("Edge"))&&(c=i=r=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:c,isIE:a,isIE11OrGreater:n,isSafari:o,isChrome:i,isFirefox:r,isEdge:s,isIEOrEdge:a||s}}Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserInfo=a,t.Browser=window?a(window.navigator.userAgent,window.navigator.appVersion):{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(688),i=n(314);t.default=function(e,t){var n;if(!e||!t)return null;for(var r=e.ownerDocument.createElement(t),o=0;o<e.attributes.length;o++){var s=e.attributes[o];r.setAttribute(s.name,s.value)}for(;e.firstChild;)r.appendChild(e.firstChild);return"P"!=i.default(e)&&"P"!=i.default(r)||(n=a.default(e,["margin-top","margin-bottom"]),r.style.marginTop=n[0],r.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(r,e),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(313),i=n(314),r=n(856);function o(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==i.default(e)||!r.default(e))return!1;return!0}t.default=function(e,t){if(e){var n=e.normalize(),i=n.node;if(0==n.offset){for(;a.default(t,i)&&o(i);)i=i.parentNode;return i==t}}return!1}},function(e,t,n){"use strict";function a(e,t){return t.some(function(t){return 0==t?0==e:(e&t)==t})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i,r){if(void 0===i&&(i=0),!e||!t)return[];var o=[].slice.call(e.querySelectorAll(t));return 0!=i&&r&&(o=o.filter(function(e){return function(e,t,n){var i=e.compareDocumentPosition(t.startContainer),r=e.compareDocumentPosition(t.endContainer),o=[0,8];return n||o.push(16),a(i,o)||a(r,o)||a(i,[2])&&a(r,[4])&&!a(r,[16])}(e,r,2==i)})),n&&o.forEach(n),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(254),i=function(){function e(e){var t=this;if(this.trs=[],this.table=a.isHTMLTableElement(e)?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var n=a.isHTMLTableElement(e)?null:e,i=[].slice.call(this.table.rows);this.cells=i.map(function(e){return[]}),i.forEach(function(e,a){t.trs[a%2]=e;for(var i=0,r=0;i<e.cells.length;i++){for(;t.cells[a][r];r++);var o=e.cells[i];o==n&&(t.col=r,t.row=a);for(var s=0;s<o.colSpan;s++,r++)for(var c=0;c<o.rowSpan;c++)t.cells[a+c][r]={td:s+c==0?o:null,spanLeft:s>0,spanAbove:c>0}}})}}return e.prototype.writeBack=function(){var e=this;this.cells?(c(this.table),this.cells.forEach(function(t,n){var a=s(e.trs[n%2]||e.trs[0]);e.table.appendChild(a),t.forEach(function(t,i){t.td&&(e.recalcSpans(n,i),a.appendChild(t.td))})})):this.table&&this.table.parentNode.removeChild(this.table)},e.prototype.applyFormat=function(e){e&&this.table&&(this.table.style.borderCollapse="collapse",this.trs[0].style.backgroundColor=e.bgColorOdd||"transparent",this.trs[1]&&(this.trs[1].style.backgroundColor=e.bgColorEven||"transparent"),this.cells.forEach(function(t){return t.filter(function(e){return e.td}).forEach(function(t){t.td.style.borderTop=r(e.topBorderColor),t.td.style.borderBottom=r(e.bottomBorderColor),t.td.style.borderLeft=r(e.verticalBorderColor),t.td.style.borderRight=r(e.verticalBorderColor)})}))},e.prototype.edit=function(e){var t=this;if(this.table){var n=this.cells[this.row],a=n[this.col];switch(e){case 0:this.cells.splice(this.row,0,n.map(o));break;case 1:var i=this.row+this.countSpanAbove(this.row,this.col);this.cells.splice(i,0,this.cells[i-1].map(function(e,n){var a=t.getCell(i,n);if(a.spanAbove)return o(a);if(e.spanLeft){var r=o(e);return r.spanAbove=!1,r}return{td:s(t.getTd(t.row,n))}}));break;case 2:this.forEachCellOfCurrentColumn(function(e,n){n.splice(t.col,0,o(e))});break;case 3:var r=this.col+this.countSpanLeft(this.row,this.col);this.forEachCellOfColumn(r-1,function(e,n,a){var i,c=t.getCell(a,r);c.spanLeft?i=o(c):e.spanAbove?(i=o(e)).spanLeft=!1:i={td:s(t.getTd(a,t.col))},n.splice(r,0,i)});break;case 6:this.forEachCellOfCurrentRow(function(e,n){var a=t.getCell(t.row+1,n);e.td&&e.td.rowSpan>1&&a.spanAbove&&(a.td=e.td)}),this.cells.splice(this.row,1);break;case 5:this.forEachCellOfCurrentColumn(function(e,n,a){var i=t.getCell(a,t.col+1);e.td&&e.td.colSpan>1&&i.spanLeft&&(i.td=e.td),n.splice(t.col,1)});break;case 7:case 8:for(var d=7==e?-1:1,l=this.row+d;l>=0&&l<this.cells.length;l+=d)if((_=this.getCell(l,this.col)).td&&!_.spanAbove){var u=l<this.row?_:a,f=l<this.row?a:_;u.td.colSpan==f.td.colSpan&&(c(f.td,u.td),f.td=null,f.spanAbove=!0);break}break;case 9:case 10:for(var p=9==e?-1:1,m=this.col+p;m>=0&&m<this.cells[this.row].length;m+=p){var _;if((_=this.getCell(this.row,m)).td&&!_.spanLeft){var h=m<this.col?_:a,b=m<this.col?a:_;h.td.rowSpan==b.td.rowSpan&&(c(b.td,h.td),b.td=null,b.spanLeft=!0);break}}break;case 4:this.cells=null;break;case 12:if(a.td.rowSpan>1)this.getCell(this.row+1,this.col).td=s(a.td);else{var g=n.map(function(e){return{td:e==a?s(e.td):null,spanAbove:e!=a,spanLeft:e.spanLeft}});this.cells.splice(this.row+1,0,g)}break;case 11:a.td.colSpan>1?this.getCell(this.row,this.col+1).td=s(a.td):this.forEachCellOfCurrentColumn(function(e,a){a.splice(t.col+1,0,{td:a==n?s(e.td):null,spanAbove:e.spanAbove,spanLeft:a!=n})})}}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells)for(e=Math.min(this.cells.length-1,e),t=Math.min(this.cells[e].length-1,t);e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){for(var n=0;n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){for(var n=0;n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalcSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,a=t+1;a<this.cells[e].length;a++){var i=this.getCell(e,a);if(i.td||!i.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,a=e+1;a<this.cells.length;a++){var i=this.getCell(a,t);if(i.td||!i.spanAbove)break;n++}return n},e}();function r(e){return"solid 1px "+(e||"transparent")}function o(e){return{td:s(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function s(e){var t=e?e.cloneNode(!1):null;return a.isHTMLTableCellElement(t)&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}function c(e,t){for(;e.firstChild;)t?t.appendChild(e.firstChild):e.removeChild(e.firstChild)}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(313),i=n(351);function r(e,t){if(!e||!t)return[];var n,i=e.node,r=e.offset,o=[];if(!a.default(t,i,!0))return[];if(3==i.nodeType){for(n=i.parentNode;i.previousSibling&&3==i.previousSibling.nodeType;)r+=i.previousSibling.nodeValue.length,i=i.previousSibling;o.unshift(r)}else n=i,i=i.childNodes[r];do{r=0;for(var s=!1,c=n.firstChild;c&&c!=i;c=c.nextSibling){if(3==c.nodeType){if(0==c.nodeValue.length||s)continue;s=!0}else s=!1;r++}o.unshift(r),i=n,n=n.parentNode}while(i&&i!=t);return o}t.default=function(e,t){return t?{start:r(i.default.getStart(t),e),end:r(i.default.getEnd(t),e)}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(857);t.default=function(e){if(a.default(e,1)){for(var t=0,n=e.currentIndex+1;n<e.snapshots.length;n++)t+=e.snapshots[n].length;e.snapshots.splice(e.currentIndex+1),e.totalSize-=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1186),i=function(){function e(){var e=this;this.onExtract=function(t){return function(n){if(e.editor&&e.editor.isDarkMode()){var i=e.editor.getSelectionRange();if(i&&!i.collapsed){var r=n,o=e.editor.getSelectionRange().cloneContents(),s=a.default(o),c=e.editor.getDocument().createElement("div");c.setAttribute("contenteditable","true"),c.innerHTML=s,r.clipboardData.setData("text/html",s),r.clipboardData.setData("text/plain",c.innerText),t&&e.editor.getSelectionRange().deleteContents(),n.preventDefault()}}}}}return e.prototype.getName=function(){return"Copy"},e.prototype.initialize=function(e){this.editor=e,this.eventDisposer=e.addDomEventHandler({copy:this.onExtract(!1),cut:this.onExtract(!0)})},e.prototype.dispose=function(){this.eventDisposer(),this.eventDisposer=null,this.editor=null},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(254);function i(e){return e&&"undefined"!=e&&"null"!=e}t.default=function(e){var t=document.createElement("div");t.setAttribute("contenteditable","true"),a.isDocumentFragment(e)?t.appendChild(e):t.innerHTML=e;var n=t.getElementsByTagName("*");return[].forEach.call(n,function(e){e.dataset&&(e.style.color=i(e.dataset.ogsc)?e.dataset.ogsc:"",e.style.backgroundColor=i(e.dataset.ogsb)?e.dataset.ogsb:"",i(e.dataset.ogac)?e.setAttribute("color",e.dataset.ogac):e.removeAttribute("color"),i(e.dataset.ogab)?e.setAttribute("bgcolor",e.dataset.ogab):e.removeAttribute("bgcolor"),e.dataset.ogsc&&delete e.dataset.ogsc,e.dataset.ogsb&&delete e.dataset.ogsb,e.dataset.ogac&&delete e.dataset.ogac,e.dataset.ogab&&delete e.dataset.ogab)}),t.innerHTML}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=function(){function e(e){var t=this;this.disableRestoreSelectionOnFocus=e,this.inIme=!1,this.onNativeEvent=function(e){t.editor.runAsync(function(){t.editor.addUndoSnapshot(function(){},"cut"==e.type?"Cut":"Drop")})},this.onFocus=function(){if(t.disableRestoreSelectionOnFocus){if(t.cachedPosition&&t.cachedFormatState){var e=t.editor.getSelectionRange();e.collapsed&&a.Position.getStart(e).normalize().equalTo(t.cachedPosition)?t.restorePendingFormatState():t.clear()}}else t.editor.restoreSavedRange()},this.onBlur=function(){t.editor.saveSelectionRange()},this.onScroll=function(e){t.editor.triggerPluginEvent(14,{rawEvent:e,scrollContainer:t.editor.getScrollContainer()})}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n=this;this.editor=e,this.disposer=e.addDomEventHandler(((t={compositionstart:function(){return n.inIme=!0},compositionend:function(t){n.inIme=!1,e.triggerPluginEvent(3,{rawEvent:t})},drop:this.onNativeEvent,cut:this.onNativeEvent,focus:this.onFocus})[a.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.onBlur,t)),this.editor.getScrollContainer().addEventListener("scroll",this.onScroll)},e.prototype.dispose=function(){this.editor.getScrollContainer().removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null,this.clear()},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 12:this.cachedPosition=this.getCurrentPosition(),this.cachedFormatState=e.formatState;break;case 0:case 4:case 6:this.cachedPosition&&!this.cachedPosition.equalTo(this.getCurrentPosition())&&this.clear()}},e.prototype.restorePendingFormatState=function(){var e=this;if(this.cachedFormatState){var t=a.getPendableFormatState(this.editor.getDocument());Object.keys(a.PendableFormatCommandMap).forEach(function(n){e.cachedFormatState[n]!=t[n]&&e.editor.getDocument().execCommand(a.PendableFormatCommandMap[n],!1,null)}),this.cachedPosition=this.getCurrentPosition()}},e.prototype.isInIME=function(){return this.inIme},e.prototype.clear=function(){this.cachedPosition=null,this.cachedFormatState=null},e.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&a.Position.getStart(e).normalize()},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(858),i=function(){function e(){this.featureMap={},this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.addFeature({keys:[8],shouldHandleEvent:function(){return null!==t.autoCompleteSnapshot},handleEvent:function(e,n){e.rawEvent.preventDefault(),n.setContent(t.autoCompleteSnapshot,!1)}})},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=!1,n=this.findFeature(e);switch(e.eventType){case 6:t=this.autoCompleteChangeSource!=e.source;break;case 4:case 0:t=!0}n&&n.handleEvent(e,this.editor),t&&(this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null)},e.prototype.addFeature=function(e){var t=this;e.keys.forEach(function(n){var a=t.featureMap[n]||[];a.push(e),t.featureMap[n]=a})},e.prototype.performAutoComplete=function(e,t){var n=this;this.editor.addUndoSnapshot(function(a,i,r){var o=e();return n.autoCompleteSnapshot=r,n.autoCompleteChangeSource=t,o},t)},e.prototype.findFeature=function(e){var t,n=this,i=!1,r=!1;if(0==e.eventType){var o=e.rawEvent;r=a.default(o),i=r||o.altKey,t=this.featureMap[o.which]}else 6==e.eventType&&(t=this.featureMap[2048]);return t&&t.filter(function(t){return(t.allowFunctionKeys||!i)&&t.shouldHandleEvent(e,n.editor,r)})[0]},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=n(1190),r=function(){function e(){}return e.prototype.getName=function(){return"FirefoxTypeAfterLink"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(a.Browser.isFirefox&&1==e.eventType||8==e.eventType){var t=this.editor.getSelectionRange();if(t&&t.collapsed&&this.editor.getElementAtCursor("A[href]")){var n=i.cacheGetContentSearcher(e,this.editor).getInlineElementBefore();n instanceof a.LinkInlineElement&&this.editor.select(new a.Position(n.getContainerNode(),-3))}}},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(859),i=n(1191),r="CONTENTSEARCHER";t.cacheGetContentSearcher=function(e,t){return a.default(e,r,function(){return t.getContentSearcherOfCursor()})},t.clearContentSearcherCache=function(e){i.default(e,r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)&&delete e.eventDataCache[t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(5,{rawEvent:t}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){4!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(254),i=n(97),r=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){1==e.eventType&&this.onKeyPress(e)},e.prototype.ensureTypeInElement=function(e,t){var n,a=e.normalize(),r=this.editor.getBlockElementAtNode(a.node);if(r){n=r.collapseToSingleElement();var o=i.isNodeEmpty(n)||t&&this.wasNodeJustCreatedByKeyboardEvent(t,n);n=n&&o?n:null}else n=i.fromHtml(i.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",this.editor.getDocument())[0],this.editor.insertNode(n,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),a=new i.Position(n.firstChild,0);return n&&i.applyFormat(n,this.editor.getDefaultFormat(),this.editor.isDarkMode()),a},e.prototype.onKeyPress=function(e){var t=this,n=this.editor.getSelectionRange();n&&!this.editor.contains(i.findClosestElementAncestor(n.startContainer))&&(n.collapsed?this.tryNormalizeTyping(e,n):n.collapsed||this.editor.runAsync(function(){t.tryNormalizeTyping(e)}))},e.prototype.tryNormalizeTyping=function(e,t){var n=this.ensureTypeInElement(i.Position.getStart(t||this.editor.getSelectionRange()),e);this.editor.select(n)},e.prototype.wasNodeJustCreatedByKeyboardEvent=function(e,t){return a.isNode(e.rawEvent.target)&&e.rawEvent.target.contains(t)&&e.rawEvent.key===t.innerText},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(858),i=n(1977),r=function(){function e(e,t){void 0===t&&(t=1e7),this.preserveSnapshots=e,this.maxBufferSize=t}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.preserveSnapshots||this.clear()},e.prototype.onPluginEvent=function(e){if(!this.editor.isInIME())switch(e.eventType){case 9:this.preserveSnapshots&&(this.canUndo()||this.canRedo())||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 3:this.clearRedoForInput(),this.addUndoSnapshot();break;case 6:this.isRestoring||this.clearRedoForInput()}},e.prototype.clear=function(){this.undoSnapshots=null,this.hasNewContent=!1},e.prototype.undo=function(){this.hasNewContent&&this.addUndoSnapshot(),this.restoreSnapshot(-1)},e.prototype.redo=function(){this.restoreSnapshot(1)},e.prototype.canUndo=function(){return this.hasNewContent||this.getSnapshotsManager().canMove(-1)},e.prototype.canRedo=function(){return this.getSnapshotsManager().canMove(1)},e.prototype.addUndoSnapshot=function(){var e=this.editor.getContent(!1,!0);return this.getSnapshotsManager().addSnapshot(e),this.hasNewContent=!1,e},e.prototype.getSnapshotsManager=function(){return this.undoSnapshots||(this.undoSnapshots=new i.default(this.maxBufferSize)),this.undoSnapshots},e.prototype.restoreSnapshot=function(e){var t=this.getSnapshotsManager().move(e);if(null!=t)try{this.isRestoring=!0,this.editor.setContent(t)}finally{this.isRestoring=!1}},e.prototype.onKeyDown=function(e){if(8==e.which||46==e.which){var t=this.editor.getSelectionRange();!t||t.collapsed&&this.lastKeyPress==e.which&&!a.default(e)||this.addUndoSnapshot(),this.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.getSnapshotsManager().clearRedo(),this.lastKeyPress=0,this.hasNewContent=!0},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1196);t.default=function(e){return!a.default(e)&&e.key&&1==e.key.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,a=e.metaKey||"Meta"===e.key;return t||n||a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},r={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"};t.calculateDefaultFormat=function(e,t,n){if(n&&(t.backgroundColors||(t.backgroundColors=i),t.textColors||(t.textColors=r)),t&&0===Object.keys(t).length)return{};var o=(t=t||{}).fontFamily,s=t.fontSize,c=t.textColor,d=t.textColors,l=t.backgroundColor,u=t.backgroundColors,f=t.bold,p=t.italic,m=t.underline,_=o&&s&&(c||d)?null:a.getComputedStyles(e);return{fontFamily:o||_[0],fontSize:s||_[1],get textColor(){return d?n?d.darkModeColor:d.lightModeColor:c||_[2]},textColors:d,get backgroundColor(){return u?n?u.darkModeColor:u.lightModeColor:l||""},backgroundColors:u,bold:f,italic:p,underline:m}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.hasFocus=function(e){var t=e.document.activeElement;return t&&a.contains(e.contentDiv,t,!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.getDefaultContentEditFeatures=function(){return{autoLink:!0,indentWhenTab:!0,outdentWhenShiftTab:!0,outdentWhenBackspaceOnEmptyFirstLine:!0,outdentWhenEnterOnEmptyLine:a.Browser.isIE||a.Browser.isChrome,mergeInNewLineWhenBackspaceOnFirstChar:!1,unquoteWhenBackspaceOnEmptyFirstLine:!0,unquoteWhenEnterOnEmptyLine:!0,autoBullet:!0,tabInTable:!0,upDownInTable:a.Browser.isChrome||a.Browser.isSafari,insertLineBeforeStructuredNodeFeature:!1,defaultShortcut:!0,unlinkWhenBackspaceAfterLink:!1,noCycleCursorMove:a.Browser.isChrome,smartOrderedList:!1,smartOrderedListStyles:["lower-alpha","lower-roman","decimal"]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);function i(e){var t=e.getStartNode();return e instanceof a.StartEndBlockElement&&t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(a.getTagOfNode(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),a=n&&n.currentBlockElement,r=[];a;)i(a)||r.push(a),a=n.getNextBlockElement();r.forEach(function(e){var n=e.collapseToSingleElement();t(n)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(573);t.default=function(e,t){if("string"==typeof t){var n=t.trim();a.default(e,function(e,t){e.style.backgroundColor=t?"":n})}else{var i=e.isDarkMode(),r=i?t.darkModeColor:t.lightModeColor;a.default(e,function(e,n){e.style.backgroundColor=n?"":r,i&&(e.dataset.ogsb=t.lightModeColor)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(573);t.default=function(e,t){t=t.trim(),a.default(e,function(e,n){e.style.fontFamily=n?"":t})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(573),i=n(97);t.default=function(e,t){t=t.trim(),a.default(e,function(e,n){e.style.fontSize=n?"":t,"normal"!=i.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(573);t.default=function(e,t){if("string"==typeof t){var n=t.trim();a.default(e,function(e,t){e.style.color=t?"":n})}else{var i=e.isDarkMode(),r=i?t.darkModeColor:t.lightModeColor;a.default(e,function(e,n){e.style.color=n?"":r,i&&(e.dataset.ogsc=t.lightModeColor)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(392);t.default=function(e){a.default(e,"bold")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(392);t.default=function(e){a.default(e,"italic")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(392);t.default=function(e){a.default(e,"underline")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&t.getComputedStyle(e),i={};return a.forEach(function(e){return i[e]=n&&n.getPropertyValue(e)||""}),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="\x3c!--StartFragment--\x3e",i="\x3c!--EndFragment--\x3e";function r(e,t){var n=o(t)[0];e.body.innerHTML=n}function o(e){var t=e.indexOf(a),n=e.lastIndexOf(i);if(t>=0&&n>=0&&n>=t+a.length){var r=e.substr(0,t),o=e.substr(n+i.length);return[e=e.substring(t+a.length,n),r,o]}return[e,null,null]}t.default=function(e,t,n){var a=(new DOMParser).parseFromString(e||"","text/html");return a&&a.body&&a.body.firstChild?(t&&(n||r)(a,e),a):null},t.splitWithFragment=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneObject=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var a=0,i=Object.keys(e);a<i.length;a++){var r=i[a];n[r]=e[r]}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i="LI,THEAD,TBODY,TR,TD,TH".split(","),r=function(e){};t.default=function(e,t,n,o,s){void 0===o&&(o=function(e){return a.wrap(e,t)}),void 0===s&&(s=a.unwrap),e.focus(),e.addUndoSnapshot(function(c,d){var l,u=e.getSelectionRange();if(u&&0==e.queryElements(t,1,s).length){var f=a.Position.getStart(u).normalize().node,p=e.getBlockElementAtNode(f),m=a.Position.getEnd(u).normalize().node,_=e.getBlockElementAtNode(m),h=p&&_?e.collapseNodes(p.getStartNode(),_.getEndNode(),!0):[];if(0==h.length)h=a.fromHtml("<DIV>"+(a.Browser.isIEOrEdge?"&#8203;":"<BR>")+"</DIV>",e.getDocument()),e.insertNode(h[0]),e.select(h[0],0);else if(1==h.length){var b=a.getTagOfNode(h[0]);"BR"==b?h=[a.wrap(h[0])]:"LI"!=b&&"TD"!=b||(h=[].slice.call(h[0].childNodes))}else for(;h[0]&&e.contains(h[0].parentNode)&&h.some(function(e){return i.indexOf(a.getTagOfNode(e))>=0});)h=[a.splitBalancedNodeRange(h)];l=o(h),(n||r)(l)}return!e.select(c,d)&&l&&e.select(l),l},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="NodeId";function i(e,t){var n=t.getAttribute(a);return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute(a,n)),n}t.createCustomData=function(){return{dict:{},nextNodeId:1}},t.setObject=function(e,t,n,a){if(1==t.nodeType){var r=i(e,t);""!=r&&(e.dict[r]||(e.dict[r]={}),e.dict[r][n]=a)}},t.getObject=function(e,t,n){if(1==t.nodeType){var a=i(e,t);if(""!=a)return e.dict[a]&&e.dict[a][n]}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WORD_ORDERED_LIST_SELECTOR='div.ListContainerWrapper > ul[class^="BulletListStyle"]',t.WORD_UNORDERED_LIST_SELECTOR='div.ListContainerWrapper > ol[class^="NumberListStyle"]',t.WORD_ONLINE_IDENTIFYING_SELECTOR=t.WORD_ORDERED_LIST_SELECTOR+","+t.WORD_UNORDERED_LIST_SELECTOR,t.LIST_CONTAINER_ELEMENT_CLASS_NAME="ListContainerWrapper",t.UNORDERED_LIST_TAG_NAME="UL",t.ORDERED_LIST_TAG_NAME="OL",t.WAC_IDENTIFING_SELECTOR='ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement'}],Array(720),[function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,i)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(840),t)},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1168),i=n(296);t.default=function(e,t,n){var r=[new a.HyperLink,new a.Paste,new a.ContentEdit];t&&(r=r.concat(t));var o={plugins:r,initialContent:n,defaultFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new i.Editor(e,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=n(296),r=function(){function e(e,t,n){var a=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.onMouse=function(e){var t=a.editor.getElementAtCursor("a[href]",e.target),n=a.tryGetHref(t);n&&a.editor.setEditorDomAttribute("title","mouseover"==e.type?a.getTooltipCallback(n,t):null)}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(5==e.eventType){var t=this.editor.getElementAtCursor("A",e.rawEvent.srcElement);if(t){if(this.onLinkClick&&!1!==this.onLinkClick(t,e.rawEvent))return;var n=void 0;if(!a.Browser.isFirefox&&(n=this.tryGetHref(t))&&i.isCtrlOrMetaPressed(e.rawEvent)&&0===e.rawEvent.button)try{var r=this.target||"_blank";this.editor.getDocument().defaultView.open(n,r)}catch(e){}}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(390);t.default=function(e){return a.default(e,"DocumentFragment")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(390);t.default=function(e){return a.default(e,"HTMLElement")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(390);t.default=function(e){return a.default(e,"HTMLOListElement")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(390);t.default=function(e){return a.default(e,"HTMLTableCellElement")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(390);t.default=function(e){return a.default(e,"HTMLTableElement")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(390);t.default=function(e){return a.default(e,"Node")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(390);t.default=function(e){return a.default(e,"Range")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(313),i=n(391),r=n(495),o=n(1171),s=n(1174),c=function(){function e(e,t){this.rootNode=e,this.startNode=a.default(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?i.default(this.rootNode,this.startNode):o.getFirstBlockElement(this.rootNode)},e.prototype.getStartInlineElement=function(){return this.startNode?r.default(this.rootNode,this.startNode):s.getFirstInlineElement(this.rootNode)},e.prototype.isBlockInScope=function(e){return a.default(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1176),i=n(391),r=n(495),o=n(847),s=n(351),c=n(855),d=n(254),l=n(1174),u=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,t=d.isRange(t)?s.default.getStart(t):t,this.position=t.normalize(),this.block=i.default(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof o.default){var n=e.getStartNode();return t?l.getFirstInlineElement(n):l.getLastInlineElement(n)}return r.default(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=c.getInlineElementAfter(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new a.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(391),i=n(689),r=n(351),o=n(855),s=function(){function e(e,t){this.rootNode=e,this.start=r.default.getStart(t).normalize(),this.end=r.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=a.default(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement(o.getInlineElementAfter(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=n&&n.equals(e);else{var i=a.default(this.rootNode,this.end.node);t=n&&i&&(e.equals(n)||e.equals(i)||e.isAfter(n)&&i.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var a=!1,r=!1;return this.start.isAfter(t)&&(t=this.start,a=!0),n.isAfter(this.end)&&(n=this.end,r=!0),t.isAfter(n)||t.equalTo(n)?null:a||r?new i.default(e,a&&t,r&&n):e},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(851),i=n(433),r=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,o=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.inlineElements=[]}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse(function(){return e.word}),this.word},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=a.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse(function(){return t.text.length>=e}),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n,a,r=e.length-1;return this.forEachTextInlineElement(function(i){for(var o=i.getTextContent()||"",s=o.length-1;s>=0&&r>=0;s--)if(e.charCodeAt(r)==o.charCodeAt(s))r--,a||(a=i.getStartPosition().move(s+1));else if(t||a)return!0;return-1==r&&(n=i.getStartPosition().move(s+1),!0)}),n&&a&&i.default(n,a)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse(function(){return e.nearestNonTextInlineElement}),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||a.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var i=r.exec(n);i&&2==i.length&&(this.word=i[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(t){var a=e.style,i=t.fontFamily,r=t.fontSize,o=t.textColor,s=t.textColors,c=t.backgroundColor,d=t.backgroundColors,l=t.bold,u=t.italic,f=t.underline;i&&(a.fontFamily=i),r&&(a.fontSize=r),(o||s)&&(s&&n&&(e.dataset.ogsc=s.lightModeColor),a.color=o),(c||d)&&(d&&n&&(e.dataset.ogsb=d.lightModeColor),a.backgroundColor=c),l&&(a.fontWeight="bold"),u&&(a.fontStyle="italic"),f&&(a.textDecoration="underline")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1177),i=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i;function r(e){for(var t=e.items?e.items.length:0,n=0;n<t;n++){var a=e.items[n];if(a.type&&0==a.type.indexOf("image/"))return a.getAsFile()}for(t=e.files?e.files.length:0,n=0;n<t;n++){var i=e.files.item(n);if(i.type&&0==i.type.indexOf("image/"))return i}return null}function o(e){var t=i.exec(e);if(t&&3==t.length){var n=parseInt(t[1]),a=parseInt(t[2]);n>0&&a>n&&(e=e.substring(n,a))}return e}t.default=function(e,t){var n=e.clipboardData||e.target.ownerDocument.defaultView.clipboardData,i={types:n.types?[].slice.call(n.types):[],text:n.getData("text"),image:r(n),html:void 0};if(e.clipboardData&&e.clipboardData.items){e.preventDefault();for(var s=e.clipboardData.items,c=0;c<s.length;c++){var d=s[c];if(d.type&&0==d.type.indexOf("text/html"))return void d.getAsString(function(e){i.html=a.Browser.isEdge?o(e):e,t(i)})}i.html=null}t(i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},t.default=function(e){return Object.keys(t.PendableFormatCommandMap).reduce(function(n,a){return n[a]=e.queryCommandState(t.PendableFormatCommandMap[a]),n},{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(688);t.default=function(e){return"rtl"==a.getComputedStyle(e,"direction")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,i="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",r={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+i+"|www\\."+i,"i"),except:a,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+i,"i"),except:a},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+i+"|ftp\\."+i,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+i,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+i,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+i,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+i,"i")}};t.default=function(e){if(e)for(var t=0,n=Object.keys(r);t<n.length;t++){var a=n[t],i=r[a],o=e.match(i.match);if(o&&o[0]==e&&(!i.except||!i.except.test(e)))return{scheme:a,originalUrl:e,normalizedUrl:i.normalizeUrl?i.normalizeUrl(e):e}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1178),i=n(313),r=n(433),o=n(686),s=n(391),c=n(314),d=n(856),l=n(1179),u=n(850),f=n(351),p=n(1180),m=n(853),_=n(1181),h=n(1182),b=n(685),g=n(572),v=[function(e,t,n){var a=s.default(e,n.node);if(a){var o=p.default(e,"a[href]",null,1,r.default(n)).filter(function(e){return a.contains(e)})[0];if(o&&d.default(o)&&(n=new f.default(o,-2),y(o),o=null),o&&t.querySelector&&t.querySelector("a[href]")){var c=n.normalize(),l=c.node.parentNode,u=3==c.node.nodeType?m.default(c.node,c.offset,!1):c.isAtEnd?c.node.nextSibling:c.node,_=e.ownerDocument.createTextNode("");for(l.insertBefore(_,u);i.default(o,_);)_=g.splitBalancedNodeRange(_);n=new f.default(_,-2),y(_)}}return n},function(e,t,n){var a=t;if(11==a.nodeType){var i=[].slice.call(a.childNodes).filter(function(e){return"BR"!=c.default(e)});a=1==i.length?i[0]:null}var r=c.default(a),s=r&&"BR"==c.default(a.nextSibling),d=o.default(n.node,e,"LI"),u=d&&o.default(d,e,"OL,UL"),p=o.default(n.node,e,"TD,TH"),m=p&&o.default(p,e,"TR");if("LI"==r&&(r=u?c.default(u):"UL",a=b.default(a,r)),"OL"!=r&&"UL"!=r||"LI"!=c.default(a.firstChild)){if("TABLE"==r&&m){var g=new h.default(a),v=new h.default(p);0==v.col&&p==v.getCell(v.row,0).td&&g.cells[0]&&g.cells[0].length==v.cells[0].length&&l.default(n,p)&&("TBODY"!=c.default(a.firstChild)||a.firstChild.nextSibling||_.default(a.firstChild),_.default(a),n=new f.default(m,-3))}}else{var S=!a.firstChild.nextSibling&&!s;s&&a.parentNode&&y(a.nextSibling),S?(_.default(a.firstChild),_.default(a)):c.default(u)==r&&(_.default(a),n=new f.default(d,l.default(n,d)?-2:-3))}return n},function(e,t,n){if("P"==c.default(n.node)){var i=n.normalize(),r=a.default(n.node,"div");i.node!=r&&(n=i)}return n},function(e,t,n){return u.default(n.node)&&(n=new f.default(n.node,n.isAtEnd?-3:-2)),n}];function y(e){e&&e.parentNode&&e.parentNode.removeChild(e)}t.default=function(e,t,n){return v.forEach(function(a){n=a(e,t,n)}),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(851);t.default=function(e){for(var t=a.default.createBodyTraverser(e),n=t&&t.currentBlockElement,i=[];n;)i.push(n.getTextContent()),n=t.getNextBlockElement();return i.join("\n")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(433);function i(e){var t=e||{},n=t.left,a=t.right,i=t.top,r=t.bottom;return n+a+i+r>0?{left:Math.round(n),right:Math.round(a),top:Math.round(i),bottom:Math.round(r)}:null}t.default=function(e){if(!e)return null;var t=a.default(e),n=t.getBoundingClientRect&&i(t.getBoundingClientRect());if(n)return n;e=e.normalize();var r=t.getClientRects&&t.getClientRects();if(n=r&&1==r.length&&i(r[0]))return n;if(3==e.node.nodeType){var o=e.node.ownerDocument.createElement("SPAN");if(o.innerHTML="​",(t=a.default(e)).insertNode(o),n=o.getBoundingClientRect&&i(o.getBoundingClientRect()),o.parentNode.removeChild(o),n)return n}var s=e.element;return s&&s.getBoundingClientRect&&(n=i(s.getBoundingClientRect()))?n:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1183);t.default=function(e,t){if(!e)return"";var n=e.innerHTML,i=t&&a.default(e,t);return i?n+"\x3c!--"+JSON.stringify(i)+"--\x3e":n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(433);t.default=function(e,t){e.innerHTML=t||"";var n=null,i=e.lastChild;try{(n=i&&8==i.nodeType&&JSON.parse(i.nodeValue))&&n.end&&n.end.length>0&&n.start&&n.start.length>0?e.removeChild(i):n=null}catch(e){}return n&&a.default(e,n.start,n.end)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1184);t.default=function(e,t){if(e.currentIndex<0||t!=e.snapshots[e.currentIndex]){a.default(e),e.snapshots.push(t),e.currentIndex++,e.totalSize+=t.length;for(var n=0;n<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=e.snapshots[n].length,n++;n>0&&(e.snapshots.splice(0,n),e.currentIndex-=n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(857);t.default=function(e,t){return a.default(e,t)?(e.currentIndex+=t,e.snapshots[e.currentIndex]):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,maxSize:e}}},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.Keys||(t.Keys={}))[a.NULL=0]="NULL",a[a.BACKSPACE=8]="BACKSPACE",a[a.TAB=9]="TAB",a[a.ENTER=13]="ENTER",a[a.SPACE=32]="SPACE",a[a.LEFT=37]="LEFT",a[a.UP=38]="UP",a[a.RIGHT=39]="RIGHT",a[a.DOWN=40]="DOWN",a[a.B=66]="B",a[a.I=73]="I",a[a.U=85]="U",a[a.Y=89]="Y",a[a.Z=90]="Z",a[a.COMMA=188]="COMMA",a[a.PERIOD=190]="PERIOD",a[a.FORWARDSLASH=191]="FORWARDSLASH",a[a.Ctrl=256]="Ctrl",a[a.Meta=512]="Meta",a[a.Shift=1024]="Shift",a[a.CONTENTCHANGED=2048]="CONTENTCHANGED",a[a.MOUSEDOWN=4096]="MOUSEDOWN"},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1975),r=n(1976),o=n(1186),s=n(1986),c=n(1197),d=n(1987),l=n(254),u=n(97),f=function(){function e(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=u.getTagOfNode(e))throw new Error("contentDiv must be an HTML DIV element");if(this.core=r.default(e,t),this.core.plugins.forEach(function(e){return e.initialize(n)}),this.setContent(t.initialContent||e.innerHTML||"",!1),this.eventDisposers=s.default(this.core),t.additionalEditFeatures&&t.additionalEditFeatures.forEach(function(e){return n.addContentEditFeature(e)}),!t.omitContentEditableAttributeChanges&&!e.isContentEditable){e.setAttribute("contenteditable","true");var a=e.style;a.userSelect=a.msUserSelect=a.webkitUserSelect="text",this.contenteditableChanged=!0}i.default(this.core.document),this.triggerPluginEvent(9,{},!0),this.core.corePlugins.typeInContainer.ensureTypeInElement(this.getFocusedPosition()||new u.Position(e,0))}return e.prototype.dispose=function(){this.triggerPluginEvent(10,{},!0),this.core.plugins.forEach(function(e){return e.dispose()}),this.eventDisposers.forEach(function(e){return e()}),this.eventDisposers=null;for(var e=0,t=Object.keys(this.core.customData);e<t.length;e++){var n=t[e],a=this.core.customData[n];a&&a.disposer&&a.disposer(a.value),delete this.core.customData[n]}if(this.contenteditableChanged){var i=this.core.contentDiv.style;i.userSelect=i.msUserSelect=i.webkitUserSelect="",this.core.contentDiv.removeAttribute("contenteditable")}this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.getDarkModeOptions(),a=this.isDarkMode()?d.convertContentToDarkMode(e,n&&n.onExternalContentTransform?n.onExternalContentTransform:void 0):null,i=!!e&&this.core.api.insertNode(this.core,e,t);return i&&a&&a(),i},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e)||(e.parentNode.removeChild(e),0))},e.prototype.replaceNode=function(e,t){return!!(e&&t&&this.contains(e))&&(e.parentNode.replaceChild(t,e),!0)},e.prototype.getInlineElementAtNode=function(e){return u.getInlineElementAtNode(this.core.contentDiv,e)},e.prototype.getBlockElementAtNode=function(e){return u.getBlockElementAtNode(this.core.contentDiv,e)},e.prototype.contains=function(e){return u.contains(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var a=t instanceof Function?0:t;n=t instanceof Function?t:n;var i=0==a?null:this.getSelectionRange();return u.queryElements(this.core.contentDiv,e,n,a,i)},e.prototype.collapseNodes=function(e,t,n){return u.collapseNodes(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return u.isNodeEmpty(this.core.contentDiv,e)},e.prototype.getContent=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1);var n=u.getHtmlWithSelectionPath(this.core.contentDiv,t&&this.getSelectionRange());return e&&(n=this.triggerPluginEvent(7,{content:n},!0).content),this.core.inDarkMode&&(n=o.default(n)),n},e.prototype.getTextContent=function(){return u.getTextContent(this.core.contentDiv)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var n=this.core.contentDiv,a=!1;if(n.innerHTML!=e){var i=u.setHtmlWithSelectionPath(n,e);this.select(i),a=!0}if(this.core.inDarkMode){var r=this.getDarkModeOptions(),o=d.convertContentToDarkMode(n,r&&r.onExternalContentTransform?r.onExternalContentTransform:void 0,!0);o&&(o(),a=!0)}t&&a&&this.triggerContentChangedEvent()},e.prototype.insertContent=function(e,t){if(e){var n=u.fromHtml(e,this.core.document);t&&t.insertOnNewLine&&n.length>1&&(n=[u.wrap(n)]);var a=this.core.document.createDocumentFragment();n.forEach(function(e){return a.appendChild(e)}),this.insertNode(a,t)}},e.prototype.getSelectionRange=function(){return this.core.api.getSelectionRange(this.core,!0)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&u.getSelectionPath(this.core.contentDiv,e)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,a){var i=e?l.isRange(e)?e:Array.isArray(e.start)&&Array.isArray(e.end)?u.createRange(this.core.contentDiv,e.start,e.end):u.createRange(e,t,n,a):null;return this.contains(i)&&this.core.api.selectRange(this.core,i)},e.prototype.getSelection=function(){return this.core.document.defaultView.getSelection()},e.prototype.saveSelectionRange=function(){this.core.cachedSelectionRange=this.core.api.getSelectionRange(this.core,!1)},e.prototype.restoreSavedRange=function(){this.select(this.core.cachedSelectionRange),this.core.cachedSelectionRange=null},e.prototype.getFocusedPosition=function(){var e=this.getSelection();if(this.contains(e&&e.focusNode))return new u.Position(e.focusNode,e.focusOffset);var t=this.getSelectionRange();return t?u.Position.getStart(t):null},e.prototype.getCursorRect=function(){var e=this.getFocusedPosition();return e&&u.getPositionRect(e)},e.prototype.getElementAtCursor=function(e,t){if(!t){var n=this.getFocusedPosition();t=n&&n.node}return t&&u.findClosestElementAncestor(t,this.core.contentDiv,e)},e.prototype.isPositionAtBeginning=function(e){return u.isPositionAtBeginningOf(e,this.core.contentDiv)},e.prototype.addDomEventHandler=function(e,t){var n=this;if(e instanceof Object){var a=Object.keys(e).map(function(t){return e[t]&&n.core.api.attachDomEvent(n.core,t,null,e[t])}).filter(function(e){return e});return function(){return a.forEach(function(e){return e()})}}return this.core.api.attachDomEvent(this.core,e,null,t)},e.prototype.triggerPluginEvent=function(e,t,n){var i=a({eventType:e},t);return this.core.api.triggerEvent(this.core,i,n),i},e.prototype.triggerEvent=function(e,t){void 0===t&&(t=!0),this.core.api.triggerEvent(this.core,e,t)},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(6,{source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.corePlugins.undo.undo()},e.prototype.redo=function(){this.focus(),this.core.corePlugins.undo.redo()},e.prototype.addUndoSnapshot=function(e,t){this.core.api.editWithUndo(this.core,e,t)},e.prototype.performAutoComplete=function(e,t){this.core.corePlugins.edit.performAutoComplete(e,t)},e.prototype.canUndo=function(){return this.core.corePlugins.undo.canUndo()},e.prototype.canRedo=function(){return this.core.corePlugins.undo.canRedo()},e.prototype.getDocument=function(){return this.core.document},e.prototype.getScrollContainer=function(){return this.core.scrollContainer},e.prototype.getCustomData=function(e,t,n){return this.core.api.getCustomData(this.core,e,t,n)},e.prototype.isInIME=function(){return this.core.corePlugins.domEvent.isInIME()},e.prototype.getDefaultFormat=function(){return this.core.defaultFormat},e.prototype.getBodyTraverser=function(e){return u.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(){return this.getSelectionRange()&&u.ContentTraverser.createSelectionTraverser(this.core.contentDiv,this.getSelectionRange())},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&u.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(){var e=this.getSelectionRange();return e&&new u.PositionContentSearcher(this.core.contentDiv,u.Position.getStart(e))},e.prototype.runAsync=function(e){var t=this;(this.core.contentDiv.ownerDocument.defaultView||window).requestAnimationFrame(function(){!t.isDisposed()&&e&&e()})},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},e.prototype.addContentEditFeature=function(e){this.core.corePlugins.edit.addFeature(e)},e.prototype.setDarkModeState=function(e){if(this.isDarkMode()!=e){var t=this.getContent(void 0,!0);this.core.inDarkMode=e,this.core.defaultFormat=c.calculateDefaultFormat(this.core.contentDiv,this.core.defaultFormat,this.core.inDarkMode),this.setContent(t),this.triggerPluginEvent(13,{changedToDarkMode:e})}},e.prototype.isDarkMode=function(){return this.core.inDarkMode},e.prototype.getDarkModeOptions=function(){return this.core.darkModeOptions},e}();t.default=f},function(e,t,n){"use strict";var a,i;Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),o=r.Browser.isFirefox?((a={}).enableObjectResizing=!1,a.enableInlineTableEditing=!1,a):r.Browser.isIE?((i={}).defaultParagraphSeparator="div",i.AutoUrlDetect=!1,i):{};t.default=function(e){Object.keys(o).forEach(function(t){try{e.execCommand(t,!1,o[t])}catch(e){}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1185),i=n(1187),r=n(1188),o=n(1189),s=n(1192),c=n(1193),d=n(1194),l=n(1978),u=n(97),f=n(1197),p=n(1979),m=n(1980),_=n(1981),h=n(1982),b=n(1198),g=n(1983),v=n(1984),y=n(1985);function S(e){return{attachDomEvent:(e=e||{}).attachDomEvent||l.attachDomEvent,editWithUndo:e.editWithUndo||p.editWithUndo,focus:e.focus||m.focus,getCustomData:e.getCustomData||_.getCustomData,getSelectionRange:e.getSelectionRange||h.getSelectionRange,hasFocus:e.hasFocus||b.hasFocus,insertNode:e.insertNode||g.insertNode,select:e.select||v.select,selectRange:e.selectRange||v.selectRange,triggerEvent:e.triggerEvent||y.triggerEvent}}t.default=function(e,t){var n,l={undo:t.undo||new d.default,edit:new r.default,typeInContainer:new c.default,mouseUp:new s.default,domEvent:new i.default(t.disableRestoreSelectionOnFocus),firefoxTypeAfterLink:new o.default,copyPlugin:!u.Browser.isIE&&new a.default},p=function(e,t){return[e.typeInContainer,e.edit,e.mouseUp].concat(t||[],[e.firefoxTypeAfterLink,e.undo,e.domEvent,e.copyPlugin]).filter(function(e){return!!e})}(l,t.plugins),m=p.filter(function(e){return e.onPluginEvent||e.willHandleEventExclusively});return{contentDiv:e,scrollContainer:t.scrollContainer||e,document:e.ownerDocument,defaultFormat:f.calculateDefaultFormat(e,t.defaultFormat,t.inDarkMode),corePlugins:l,currentUndoSnapshot:null,customData:(n=t.customData||{},Object.keys(n).reduce(function(e,t){return e[t]={value:n[t]},e},{})),cachedSelectionRange:null,plugins:p,eventHandlerPlugins:m,api:S(t.coreApiOverride),defaultApi:S(),inDarkMode:t.inDarkMode,darkModeOptions:t.darkModeOptions}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=function(){function e(e){void 0===e&&(e=1e7),this.maxSize=e,this.snapshots=a.createSnapshots(e)}return e.prototype.canMove=function(e){return a.canMoveCurrentSnapshot(this.snapshots,e)},e.prototype.move=function(e){return a.moveCurrentSnapsnot(this.snapshots,e)},e.prototype.addSnapshot=function(e){a.addSnapshot(this.snapshots,e)},e.prototype.clearRedo=function(){a.clearProceedingSnapshots(this.snapshots)},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1195);t.attachDomEvent=function(e,t,n,i){var r=function(t){var r;(("keydown"==(r=t).type||"keypress"==r.type||"keyup"==r.type)&&a.default(t)||11==n)&&t.stopPropagation(),i&&i(t),null!=n&&e.api.triggerEvent(e,{eventType:n,rawEvent:t},!1)};return e.contentDiv.addEventListener(t,r),function(){e.contentDiv.removeEventListener(t,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.editWithUndo=function(e,t,n){var i,r=null!==e.currentUndoSnapshot;r||(e.currentUndoSnapshot=e.corePlugins.undo.addUndoSnapshot());try{if(t){var o=e.api.getSelectionRange(e,!0);i=t(o&&a.Position.getStart(o).normalize(),o&&a.Position.getEnd(o).normalize(),e.currentUndoSnapshot),r||e.corePlugins.undo.addUndoSnapshot()}}finally{r||(e.currentUndoSnapshot=null)}if(t&&n){var s={eventType:6,source:n,data:i};e.api.triggerEvent(e,s,!0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.focus=function(e){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.cachedSelectionRange&&e.api.selectRange(e,e.cachedSelectionRange,!0))){var t=a.getFirstLeafNode(e.contentDiv)||e.contentDiv;e.api.selectRange(e,a.createRange(t,0),!0)}e.cachedSelectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCustomData=function(e,t,n,a){return(e.customData[t]=e.customData[t]||{value:n?n():void 0,disposer:a}).value}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.getSelectionRange=function(e,t){var n=null;if(!t||e.api.hasFocus(e)){var i=e.document.defaultView.getSelection();if(i&&i.rangeCount>0){var r=i.getRangeAt(0);a.contains(e.contentDiv,r)&&(n=r)}}return!n&&t&&(n=e.cachedSelectionRange),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.insertNode=function(e,t,n){n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var i=e.contentDiv;switch(n.updateCursor&&e.api.focus(e),n.position){case 0:case 1:var r,o=0==n.position,s=a.getFirstLastBlockElement(i,o);if(s){var c=o?s.getStartNode():s.getEndNode();r=n.insertOnNewLine||3==c.nodeType||a.isVoidHtmlElement(c)?c.parentNode.insertBefore(t,o?c:c.nextSibling):c.insertBefore(t,o?c.firstChild:null)}else r=i.appendChild(t);r&&n.insertOnNewLine&&!a.isBlockElement(r)&&a.wrap(r);break;case 2:var d=i.appendChild(t);d&&n.insertOnNewLine&&!a.isBlockElement(d)&&a.wrap(d);break;case 5:case 3:var l=function(e,t){var n=e.api.getSelectionRange(e,!0),a=null;return 5==t.position?(a=n,n=t.range):n&&(a=n.cloneRange()),{range:n,rangeToRestore:a}}(e,n),u=l.range,f=l.rangeToRestore;if(!u)return;n.replaceSelection&&!u.collapsed&&u.deleteContents();var p=a.Position.getStart(u),m=void 0;p=n.insertOnNewLine&&(m=a.getBlockElementAtNode(i,p.normalize().node))?new a.Position(m.getEndNode(),-3):a.adjustNodeInsertPosition(i,t,p);var _=11==t.nodeType?t.lastChild:t;(u=a.createRange(p)).insertNode(t),n.updateCursor&&_&&(f=a.createRange(new a.Position(_,-3).normalize())),e.api.selectRange(e,f);break;case 4:e.contentDiv.parentNode.insertBefore(t,i.nextSibling)}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=n(1198),r=n(254);t.selectRange=function(e,t,n){var r,o=!0;if(!a.contains(e.contentDiv,t)||!(r=e.document.defaultView.getSelection()))return!1;if(r.rangeCount>0)try{var s=void 0;(n||a.Browser.isEdge)&&(s=1==r.rangeCount?r.getRangeAt(0):null)&&s.startContainer==t.startContainer&&s.startOffset==t.startOffset&&s.endContainer==t.endContainer&&s.endOffset==t.endOffset?o=!1:r.removeAllRanges()}catch(e){}return o&&r.addRange(t),i.hasFocus(e)||(e.cachedSelectionRange=t),t.collapsed&&e.corePlugins.domEvent.restorePendingFormatState(),!0},t.select=function(e,t,n,i,o){var s=r.isRange(t)?t:a.createRange(t,n,i,o);return e.api.selectRange(e,s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=function(e,t,n){!n&&e.eventHandlerPlugins.some(function(e){return function(e,t){return!!(t.onPluginEvent&&t.willHandleEventExclusively&&t.willHandleEventExclusively(e))&&(t.onPluginEvent(e),!0)}(t,e)})||e.eventHandlerPlugins.forEach(function(e){e.onPluginEvent&&e.onPluginEvent(t)})}},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0});var i=((a={keypress:1,keydown:0,keyup:2,mousedown:4})[n(97).Browser.isIE?"textinput":"input"]=11,a);t.default=function(e){return Object.keys(i).map(function(t){return e.api.attachDomEvent(e,t,i[t])})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(254);t.convertContentToDarkMode=function(e,t,n){var i=[];return a.isHTMLElement(e)?(i=Array.prototype.slice.call(e.getElementsByTagName("*")),n||i.unshift(e)):a.isDocumentFragment(e)&&(i=Array.prototype.slice.call(e.querySelectorAll("*"))),i.length>0?function(){i.forEach(function(e){t?t(e):(e.style.color=null,e.style.backgroundColor=null)})}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(859);t.default=function(e,t,n){return a.default(t,"GET_ELEMENT_AT_CURSOR_"+n,function(){return e.getElementAtCursor(n)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1199),i=n(1990),r=n(2016),o=n(2017),s=n(2018),c=n(2019),d=n(2020),l=n(2021),u=function(){function e(e){this.featureSet=e}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.getFilteredFeatures().forEach(function(e){return t.editor.addContentEditFeature(e)})},e.prototype.dispose=function(){this.editor=null},e.prototype.getFilteredFeatures=function(){var e=this.featureSet||a.getDefaultContentEditFeatures(),t={indentWhenTab:d.IndentWhenTab,outdentWhenShiftTab:d.OutdentWhenShiftTab,outdentWhenBackspaceOnEmptyFirstLine:d.OutdentWhenBackOn1stEmptyLine,outdentWhenEnterOnEmptyLine:d.OutdentWhenEnterOnEmptyLine,mergeInNewLineWhenBackspaceOnFirstChar:d.MergeInNewLine,unquoteWhenBackspaceOnEmptyFirstLine:l.UnquoteWhenBackOnEmpty1stLine,unquoteWhenEnterOnEmptyLine:l.UnquoteWhenEnterOnEmptyLine,tabInTable:c.TabInTable,upDownInTable:c.UpDownInTable,insertLineBeforeStructuredNodeFeature:o.InsertLineBeforeStructuredNodeFeature,autoBullet:d.AutoBullet,autoLink:i.AutoLink,unlinkWhenBackspaceAfterLink:i.UnlinkWhenBackspaceAfterLink,defaultShortcut:r.DefaultShortcut,noCycleCursorMove:s.NoCycleCursorMove,smartOrderedList:d.getSmartOrderedList(e.smartOrderedListStyles)};return Object.keys(t).filter(function(t){return e[t]}).map(function(e){return t[e]})},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=n(434),r=n(296),o=/[.+=\s:;"',>]+$/i;function s(e,t){return 0==e.eventType||6==e.eventType&&"Paste"==e.source?r.cacheGetEventData(e,"LINK_DATA",function(){var n=6==e.eventType&&"Paste"==e.source&&e.data,i=a.matchLink((n.text||"").trim()),s=r.cacheGetContentSearcher(e,t);if(i&&s.getRangeFromText(i.originalUrl,!1))return i;var c=s&&s.getWordBefore();if(c&&c.length>5){var d=(c.match(o)||[])[0]||"",l=c.substring(0,c.length-d.length);return["()","{}","[]"].forEach(function(e){l[l.length-1]==e[1]&&l.indexOf(e[0])<0&&(l=l.substr(0,l.length-1))}),a.matchLink(l)}return null}):null}t.AutoLink={keys:[13,32,2048],shouldHandleEvent:s,handleEvent:function(e,t){var n=t.getDocument().createElement("a"),a=s(e,t),o=t.getContentSearcherOfCursor();n.textContent=a.originalUrl,n.href=a.normalizedUrl,t.runAsync(function(){t.performAutoComplete(function(){return i.replaceWithNode(t,a.originalUrl,n,!1,o),r.clearContentSearcherCache(e),n},"AutoLink")})}},t.UnlinkWhenBackspaceAfterLink={keys:[8],shouldHandleEvent:function(e,t){return r.cacheGetContentSearcher(e,t).getInlineElementBefore()instanceof a.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),i.removeLink(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(573),i=n(97);function r(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var a=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(e>a||e==a&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),a),1e3);else if(1==t){for(var i=0;i<n.length;i++)if(e<n[i]){e=n[i];break}}else for(i=n.length-1;i>=0;i--)if(e>n[i]){e=n[i];break}return e}t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],t.default=function(e,n,o){void 0===o&&(o=t.FONT_SIZES);var s=0==n?1:-1;a.default(e,function(e){var t=parseFloat(i.getComputedStyle(e,"font-size"));e.style.fontSize=r(t,s,o)+"pt","normal"!=i.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")})},t.getNewFontSize=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1200),i=n(97);function r(e,t,n,a){if(1!=e.nodeType||"BR"==i.getTagOfNode(e))return!1;var s=[].slice.call(e.childNodes).map(function(e){return r(e,t,n,a)}).reduce(function(e,t){return e&&t},!0);if(!o(n,e))return!1;var c=i.isBlockElement(e);return t.indexOf(i.getTagOfNode(e))>=0||s?(c&&!s&&i.wrap(e),i.unwrap(e)):function(e,t){for(var n=0,a=[].slice.call(e.attributes);n<a.length;n++){var i=a[n];t.indexOf(i.name.toLowerCase())<0&&0!=i.name.indexOf("data-")&&e.removeAttribute(i.name)}}(e,a),c}function o(e,t){return e.indexOf(i.getTagOfNode(t))<0}t.TAGS_TO_UNWRAP="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),t.TAGS_TO_STOP_UNWRAP=["TD","TH","TR","TABLE","TBODY","THEAD"],t.ATTRIBUTES_TO_PRESERVE=["href"],t.default=function(e,n,s,c){void 0===n&&(n=t.TAGS_TO_UNWRAP),void 0===s&&(s=t.TAGS_TO_STOP_UNWRAP),void 0===c&&(c=t.ATTRIBUTES_TO_PRESERVE),e.focus(),e.addUndoSnapshot(function(t,d){var l=[{}],u=s.join(",");a.default(e,function(t){var n=l[l.length-1],a=e.getElementAtCursor(u,t);a!=n.td&&n.first&&l.push(n={}),n.td=a,n.first=n.first||t,n.last=t}),l.filter(function(e){return e.first}).forEach(function(t){var a=e.collapseNodes(t.first,t.last,!0);if(o(s,a[0]))for(;e.contains(a[0].parentNode)&&o(s,a[0].parentNode);)a=[i.splitBalancedNodeRange(a)];if(a.forEach(function(e){return r(e,n,s,c)}),t.td){var d=t.td.getAttribute("style")||"",l=d.split(";");(d=(l=l.filter(function(e){return 0==e.trim().toLowerCase().indexOf("border")})).join(";"))?t.td.setAttribute("style",d):t.td.removeAttribute("style")}}),e.select(t,d)},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(392),i=n(1201),r=n(1202),o=n(1203),s=n(1204),c=n(1205),d=n(1206),l=n(1207),u=["font","text-decoration","color","background"];t.default=function(e){e.focus(),e.addUndoSnapshot(function(){a.default(e,"removeFormat"),e.queryElements("[class]",1,function(e){return e.removeAttribute("class")});var t=e.getDefaultFormat(),n=0===Object.keys(t).length;e.queryElements("[style]",2,function(e){u.forEach(function(t){return e.style.removeProperty(t)}),n&&""===e.getAttribute("style")&&e.removeAttribute("style")}),n||(t.fontFamily&&r.default(e,t.fontFamily),t.fontSize&&o.default(e,t.fontSize),t.textColor&&(t.textColors?s.default(e,t.textColors):s.default(e,t.textColor)),t.backgroundColor&&(t.backgroundColors?i.default(e,t.backgroundColors):i.default(e,t.backgroundColor)),t.bold&&c.default(e),t.italic&&d.default(e),t.underline&&l.default(e))},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(435),i=n(97),r=/^[a-zA-Z]+:/i,o=/^[\w.%+-]+@/i,s=/^ftp\./i;function c(e){return e.queryElements("a[href]",1)[0]}function d(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,l){e.focus();var u=(function(e){var t=new a.HtmlSanitizer,n=(new DOMParser).parseFromString("<a></a>","text/html"),i=n.body.firstChild;return i.href=e||"",t.sanitize(n.body),i.href}(t)||"").trim();if(u){var f=i.matchLink(u),p=f?f.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(r)<0&&(t=0==e.search(o)?"mailto:":0==e.search(s)?"ftp://":"http://"),t+e}(u),m=f?f.originalUrl:u;e.addUndoSnapshot(function(){var t=e.getSelectionRange(),a=null;return t&&t.collapsed?(a=c(e))?(a.href=p,d(a,l)):((a=e.getDocument().createElement("A")).textContent=l||m,a.href=p,e.insertNode(a)):(e.getDocument().execCommand("createLink",!1,p),d(a=c(e),l)),n&&a&&(a.removeAttribute("istemptitle"),a.title=n),a},"CreateLink")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1208),i=n(1209),r=n(1210),o=n(254),s=n(1996),c=function(){function e(e){e=e||{},this.elementCallbacks=r.cloneObject(e.elementCallbacks),this.styleCallbacks=s.getStyleCallbacks(e.styleCallbacks),this.attributeCallbacks=r.cloneObject(e.attributeCallbacks),this.allowedTags=s.getAllowedTags(e.additionalAllowedTags),this.allowedAttributes=s.getAllowedAttributes(e.additionalAllowAttributes),this.defaultStyleValues=s.getDefaultStyleValues(e.additionalDefaultStyleValues),this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.allowPreserveWhiteSpace=e.allowPreserveWhiteSpace}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var i=new e(n=n||{}),r=o.isHTMLElement(n.currentElementOrStyle)?a.default(n.currentElementOrStyle):n.currentElementOrStyle;return i.exec(t,n.convertCssOnly,n.preserveFragmentOnly,r)},e.prototype.exec=function(e,t,n,a){var r=i.default(e,n);return r&&(this.convertGlobalCssToInlineCss(r),t||this.sanitize(r.body,a)),r&&r.body&&r.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=r.cloneObject(t,a.default(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=d(e.querySelectorAll("style")),n=0,a=this.additionalGlobalStyleNodes.reverse().map(function(e){return e.sheet}).concat(t.map(function(e){return e.sheet}).reverse()).filter(function(e){return e});n<a.length;n++)for(var i=a[n],r=function(t){var n=i.cssRules[t],a=n&&n.style?n.style.cssText:null;if(n.type!=CSSRule.STYLE_RULE||!a||!n.selectorText)return"continue";for(var r=0,o=n.selectorText.split(",");r<o.length;r++){var s=o[r];!s||!s.trim()||s.indexOf(":")>=0||d(e.querySelectorAll(s)).forEach(function(e){return e.setAttribute("style",a+(e.getAttribute("style")||""))})}},o=i.cssRules.length-1;o>=0;o--)r(o);t.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},e.prototype.processNode=function(e,t,n){var a=e.nodeType,i=a==Node.ELEMENT_NODE,o=a==Node.TEXT_NODE,s=e,c=i?s.tagName.toUpperCase():"";if(i&&!this.allowElement(s,c,n)||o&&/^[\r\n]*$/g.test(e.nodeValue)&&!t.insidePRE||!i&&!o)e.parentNode.removeChild(e);else if(o&&!this.allowPreserveWhiteSpace&&"pre"==t["white-space"])e.nodeValue=e.nodeValue.replace(/^ /gm," ").replace(/ {2}/g,"  ");else if(i){var d=r.cloneObject(t);this.processAttributes(s,n),this.processCss(s,c,d,n),"PRE"==c&&(d.insidePRE="true");for(var l=s.firstChild,u=void 0;l;l=u)u=l.nextSibling,this.processNode(l,d,n)}},e.prototype.processCss=function(e,t,n,a){var i=this,r=e.getAttributeNode("style");if(r){var o=r.value.split(";"),s=o.filter(function(t){var r;if(!t||""==t.trim()||2!=(r=t.split(":")).length)return!1;var o=r[0].trim().toLowerCase(),s=r[1].trim().toLowerCase(),c=i.styleCallbacks[o],d=null!=n[o],l=(!c||c(s,e,a))&&"inherit"!=s&&s.indexOf("expression")<0&&"-"!=o.substr(0,1)&&i.defaultStyleValues[o]!=s&&(d&&s!=n[o]||!d&&"initial"!=s&&"normal"!=s);return l&&d&&(n[o]=s),l&&(i.allowPreserveWhiteSpace||"white-space"!=o)});o.length!=s.length&&(s.length>0?e.setAttribute("style",s.map(function(e){return e.trim()}).join("; ")):e.removeAttribute("style"))}},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var a=e.attributes[n],i=a.name.toLowerCase().trim(),r=a.value,o=this.attributeCallbacks[i];o?r=o(r,e,t):this.allowedAttributes.indexOf(i)<0&&(r=null),null==r||r.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(i):a.value=r}},e.prototype.allowElement=function(e,t,n){var a=this.elementCallbacks[t];return a?a(e,n):this.allowedTags.indexOf(t)>=0||t.indexOf(":")>0},e}();function d(e){return[].slice.call(e)}t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1210),i="BODY,H1,H2,H3,H4,H5,H6,FORM,P,BR,NOBR,HR,ACRONYM,ABBR,ADDRESS,B,BDI,BDO,BIG,BLOCKQUOTE,CENTER,CITE,CODE,DEL,DFN,EM,FONT,I,INS,KBD,MARK,METER,PRE,PROGRESS,Q,RP,RT,RUBY,S,SAMP,SMALL,STRIKE,STRONG,SUB,SUP,TEMPLATE,TIME,TT,U,VAR,WBR,XMP,INPUT,TEXTAREA,BUTTON,SELECT,OPTGROUP,OPTION,LABEL,FIELDSET,LEGEND,DATALIST,OUTPUT,IMG,MAP,AREA,CANVAS,FIGCAPTION,FIGURE,PICTURE,A,NAV,UL,OL,LI,DIR,UL,DL,DT,DD,MENU,MENUITEM,TABLE,CAPTION,TH,TR,TD,THEAD,TBODY,TFOOT,COL,COLGROUP,DIV,SPAN,HEADER,FOOTER,MAIN,SECTION,ARTICLE,ASIDE,DETAILS,DIALOG,SUMMARY,DATA".split(","),r="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,value,width,wrap".split(","),o={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"};function s(){return null}function c(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}function d(e){return e.filter(function(e,t,n){return n.indexOf(e)==t})}t.getAllowedTags=function(e){return d(i.concat(e||[])).map(function(e){return e.toUpperCase()})},t.getAllowedAttributes=function(e){return d(r.concat(e||[])).map(function(e){return e.toLocaleLowerCase()})},t.getDefaultStyleValues=function(e){var t=a.cloneObject(o);return e&&Object.keys(e).forEach(function(n){var a=e[n];null!=a?t[n]=a:delete t[n]}),t},t.getStyleCallbacks=function(e){var t=a.cloneObject(e);return t.position=t.position||s,t.width=t.width||c,t}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(296),r=n(97),o=n(97);function s(e,t){var n=r.getTagOfNode(i.cacheGetElementAtCursor(e,t,"OL,UL")),a=r.getTagOfNode(i.cacheGetElementAtCursor(e,t,"H1,H2,H3,H4,H5,H6"));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:a&&parseInt(a[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}function c(e){var t=e.getSelectionRange(),n=t&&r.Position.getStart(t).normalize().node,a=n?r.getComputedStyles(n):[];return{fontName:a[0],fontSize:a[1],textColor:a[2],backgroundColor:a[3]}}t.getElementBasedFormatState=s,t.getStyleBasedFormatState=c,t.default=function(e,t){return a({},o.getPendableFormatState(e.getDocument()),s(e,t),c(e),{canUndo:e.canUndo(),canRedo:e.canRedo()})}},function(e,t,n){"use strict";function a(e,t){e.addUndoSnapshot(function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)},"Format")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"==typeof t)a(e,t);else{var n=new FileReader;n.onload=function(t){e.isDisposed()||a(e,t.target.result)},n.readAsDataURL(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);function i(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,r){var o=e.getDocument(),s=o.createDocumentFragment(),c=o.createElement("table");s.appendChild(c),c.cellSpacing="0",c.cellPadding="1";for(var d=0;d<n;d++){var l=o.createElement("tr");c.appendChild(l);for(var u=0;u<t;u++){var f=o.createElement("td");l.appendChild(f),f.appendChild(o.createElement("br")),f.style.width=i(t)}}e.focus(),e.addUndoSnapshot(function(){var t=new a.VTable(c);t.applyFormat(r||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(s),e.runAsync(function(){return e.select(new a.Position(c,0).normalize())})},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot(function(i,r){var o=new a.VTable(n);o.edit(t),o.writeBack(),e.focus(),e.select(i,r)||e.select(e.contains(n)?n:o.getCurrentTd())},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot(function(i,r){var o=new a.VTable(n);o.applyFormat(t),o.writeBack(),e.focus(),e.select(i,r)},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.default=function(e){e.focus(),e.addUndoSnapshot(function(t,n){e.queryElements("a[href]",1,a.unwrap),e.select(t,n)},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,a,i){if(!t||!n)return!1;var r;if(r="string"==typeof t?(i=i||e.getContentSearcherOfCursor())&&i.getRangeFromText(t,a):t){var o=e.getSelectionRange();return o.collapsed&&r.endContainer==o.startContainer&&r.endOffset==o.startOffset&&(a=!0),e.insertNode(n,{position:5,updateCursor:a,replaceSelection:!0,insertOnNewLine:!1,range:r}),!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(392);t.default=function(e,t){var n="justifyLeft",i="left";1==t?(n="justifyCenter",i="center"):2==t&&(n="justifyRight",i="right"),e.addUndoSnapshot(function(){a.default(e,n),e.queryElements("[align]",1,function(e){return e.style.textAlign=i})},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1200);t.default=function(e,t){e.focus(),e.addUndoSnapshot(function(n,i){a.default(e,function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"}),e.select(n,i)},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot(function(){e.queryElements("img",1,function(e){return e.setAttribute("alt",t)})},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(860);t.default=function(e,t){var n=0==t?"indent":"outdent";e.addUndoSnapshot(function(){var t;return e.focus(),e.getElementAtCursor("OL,UL")?t=a.default(e,n):(e.getDocument().execCommand(n,!1,null),e.queryElements("BLOCKQUOTE",1,function(e){t=t||e,e.style.marginTop="0px",e.style.marginBottom="0px"})),t},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(860);t.default=function(e){e.focus(),e.addUndoSnapshot(function(){return a.default(e,"insertUnorderedList")},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(860);t.default=function(e){e.focus(),e.addUndoSnapshot(function(){return a.default(e,"insertOrderedList")},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1211),i=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){a.default(e,"blockquote",t||i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1211),i=n(97);function r(e){var t=i.wrap(e,"code");return i.wrap(t,"pre")}function o(e){if(!e)return null;var t=e.childNodes[0];return 1==e.childNodes.length&&"CODE"==i.getTagOfNode(t)&&i.unwrap(t),i.unwrap(e)}t.default=function(e,t){a.default(e,"pre",t,r,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(392);t.default=function(e){a.default(e,"strikeThrough")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(392);t.default=function(e){a.default(e,"subscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(392);t.default=function(e){a.default(e,"superscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(435);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot(function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);for(var a=e.getDocument().createElement("div");t.firstChild;)a.appendChild(t.firstChild);e.replaceNode(t,a)}),t>0){for(var i=e.getSelectionTraverser(),r=i?i.currentBlockElement:null,o=new a.HtmlSanitizer({styleCallbacks:{"font-size":function(){return!1}}});r;){var s=r.collapseToSingleElement();o.sanitize(s),r=i.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}},"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=n(296),r=n(434);function o(e,t,n){return{winKey:e,macKey:t,action:n}}var s=[o(322,578,r.toggleBold),o(329,585,r.toggleItalic),o(341,597,r.toggleUnderline),o(346,602,function(e){return e.undo()}),o(345,1626,function(e){return e.redo()}),o(446,702,r.toggleBullet),o(447,703,r.toggleNumbering),o(1470,1726,function(e){return r.changeFontSize(e,0)}),o(1468,1724,function(e){return r.changeFontSize(e,1)})];function c(e){return i.cacheGetEventData(e,"DEFAULT_SHORT_COMMAND",function(){var t=e.rawEvent,n=0!=e.eventType||t.altKey?0:t.which|(t.metaKey&&512)|(t.shiftKey&&1024)|(t.ctrlKey&&256);return n&&s.filter(function(e){return(a.Browser.isMac?e.macKey:e.winKey)==n})[0]})}t.DefaultShortcut={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:c,handleEvent:function(e,t){var n=c(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(296),i=n(97),r=i.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",o={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},s=Object.keys(o).join(",");function c(e,t){return a.cacheGetEventData(e,"FIRST_STRUCTURE",function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(s);if(n){var a=t.getSelectionRange();if(a&&a.collapsed&&i.isPositionAtBeginningOf(i.Position.getStart(a),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(o[i.getTagOfNode(n)])}return null})}t.InsertLineBeforeStructuredNodeFeature={keys:[13],shouldHandleEvent:c,handleEvent:function(e,t){var n=c(e,t),a=i.fromHtml(r,t.getDocument())[0];t.addUndoSnapshot(function(){n.parentNode.insertBefore(a,n),"TABLE"==i.getTagOfNode(n)&&t.select(new i.Position(a,0).normalize())}),e.rawEvent.preventDefault()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.NoCycleCursorMove={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var i,r;if(!(n&&(i=t.getSelectionRange())&&i.collapsed&&(r=a.Position.getStart(i))&&t.isPositionAtBeginning(r)))return!1;var o=a.isRtl(r.element),s=e.rawEvent;return!o&&37==s.which||o&&39==s.which},handleEvent:function(e){e.rawEvent.preventDefault()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(296),i=n(97);function r(e,t){return a.cacheGetEventData(e,"TABLECELL_FOR_TABLE_FEATURES",function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==i.getTagOfNode(n)?null:n)})}t.TabInTable={keys:[9],shouldHandleEvent:r,handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,a=r(e,t),o=new i.VTable(a),s=n?-1:1,c=o.row,d=o.col+s;;d+=s){if(d<0||d>=o.cells[c].length){if((c+=s)<0||c>=o.cells.length){t.select(o.table,n?-2:-3);break}d=n?o.cells[c].length-1:0}var l=o.getCell(c,d);if(l.td){t.select(l.td,0);break}}e.rawEvent.preventDefault()}},t.UpDownInTable={keys:[38,40],shouldHandleEvent:r,handleEvent:function(e,t){for(var n=r(e,t),a=new i.VTable(n),o=38==e.rawEvent.which,s=o?-1:1,c=null,d=e.rawEvent.shiftKey,l=t.getSelection(),u=l.anchorNode,f=l.anchorOffset,p=a.row;p>=0&&p<a.cells.length;p+=s){var m=a.getCell(p,a.col);if(m.td&&m.td!=n){c=m.td;break}}t.runAsync(function(){var e=t.getElementAtCursor();if(i.contains(a.table,e)&&!i.contains(n,e,!0)){var r=c?new i.Position(c,0):new i.Position(a.table,o?-2:-3);d?(r=1==r.node.nodeType&&i.isVoidHtmlElement(r.node)?new i.Position(r.node,r.isAtEnd?-3:-2):r,t.getSelection().setBaseAndExtent(u,f,r.node,r.offset)):t.select(r)}})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(254),i=n(434),r=n(296),o=n(97);function s(e,t){var n=c(e,t);if(n){var a=n[0],r=o.getTagOfNode(a);"UL"==r?i.toggleBullet(t):"OL"==r&&i.toggleNumbering(t),t.focus(),e.rawEvent.preventDefault()}}function c(e,t){var n=r.cacheGetElementAtCursor(t,e,"LI,TABLE"),a=n&&"LI"==o.getTagOfNode(n)&&t.getElementAtCursor("UL,OL",n);return a?[a,n]:null}t.IndentWhenTab={keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&c(e,t)},handleEvent:function(e,t){i.setIndentation(t,0),e.rawEvent.preventDefault()}},t.OutdentWhenShiftTab={keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&c(e,t)},handleEvent:function(e,t){i.setIndentation(t,1),e.rawEvent.preventDefault()}},t.MergeInNewLine={keys:[8],shouldHandleEvent:function(e,t){var n=r.cacheGetElementAtCursor(t,e,"LI"),a=t.getSelectionRange();return n&&a&&o.isPositionAtBeginningOf(o.Position.getStart(a),n)},handleEvent:function(e,t){r.cacheGetElementAtCursor(t,e,"LI").previousSibling?t.runAsync(function(){var e=t.getDocument().createElement("BR");t.insertNode(e),t.select(e,-3)}):s(e,t)}},t.OutdentWhenBackOn1stEmptyLine={keys:[8],shouldHandleEvent:function(e,t){var n=r.cacheGetElementAtCursor(t,e,"LI");return n&&o.isNodeEmpty(n)&&!n.previousSibling},handleEvent:s},t.OutdentWhenEnterOnEmptyLine={keys:[13],shouldHandleEvent:function(e,t){var n=r.cacheGetElementAtCursor(t,e,"LI");return!e.rawEvent.shiftKey&&n&&o.isNodeEmpty(n)},handleEvent:function(e,t){t.performAutoComplete(function(){return s(e,t)})}},t.AutoBullet={keys:[32],shouldHandleEvent:function(e,t){if(!c(e,t)){var n=r.cacheGetContentSearcher(e,t),a=n.getSubStringBefore(3);return["*","-","1."].indexOf(a)>=0&&!n.getNearestNonTextInlineElement()}return!1},handleEvent:function(e,t){t.runAsync(function(){t.performAutoComplete(function(){var e=t.getContentSearcherOfCursor(),n=e.getSubStringBefore(3),a=e.getRangeFromText(n,!0);a&&a.deleteContents();var r=t.getDocument().createElement("BR");(o.Browser.isChrome||o.Browser.isSafari||o.Browser.isIE11OrGreater)&&t.insertNode(r),0==n.indexOf("1.")?i.toggleNumbering(t):i.toggleBullet(t),t.deleteNode(r)})})}},t.getSmartOrderedList=function(e){return{keys:[2048],shouldHandleEvent:function(e,t){return a.isHTMLOListElement(e.data)},handleEvent:function(t,n){var a=t.data,i=n.getElementAtCursor("OL",a.parentNode);if(i){var r=e&&e.length>0?e:["decimal"];a.style.listStyle=r[(r.indexOf(i.style.listStyle)+1)%r.length]}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(296),i=n(97),r="BLOCKQUOTE",o=[r,"LI","TD","TH"].join(",");function s(e,t){return a.cacheGetEventData(e,"QUOTE_CHILD",function(){var e=t.getElementAtCursor(o);if(e&&i.getTagOfNode(e)==r){var n=t.getFocusedPosition(),a=n&&t.getBlockElementAtNode(n.normalize().node);if(a){var s=a.getStartNode()==e?a.getStartNode():a.collapseToSingleElement();return i.isNodeEmpty(s)?s:null}}return null})}function c(e,t){t.addUndoSnapshot(function(){var n,a=s(e,t);i.getTagOfNode(a)==r&&(a=i.wrap([].slice.call(a.childNodes))),n=i.splitBalancedNodeRange(a),i.unwrap(n),t.select(a,0)}),e.rawEvent.preventDefault()}t.UnquoteWhenBackOnEmpty1stLine={keys:[8],shouldHandleEvent:function(e,t){var n=s(e,t);return n&&i.isNodeEmpty(n)&&!n.previousSibling},handleEvent:c},t.UnquoteWhenEnterOnEmptyLine={keys:[13],shouldHandleEvent:function(e,t){var n=s(e,t);return!e.rawEvent.shiftKey&&n&&i.isNodeEmpty(n)},handleEvent:function(e,t){return t.performAutoComplete(function(){return c(e,t)})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2023),i=n(2024),r=n(2032),o=n(434),s=n(434),c=n(435),d=n(97),l=function(){function e(e,t){var n=this;this.onPaste=function(e){a.default(e,n.editor,function(e){n.pasteOriginal({snapshotBeforePaste:null,originalFormat:n.getCurrentFormat(),types:e.types,image:e.image,text:e.text,rawHtml:e.html,html:e.html?n.sanitizeHtml(e.html):r.default(e.text)})})},this.applyFormatting=function(e,t){return function(n){d.applyFormat(n,e,t)}},this.sanitizer=new c.HtmlSanitizer({attributeCallbacks:t})}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e,this.pasteDisposer=e.addDomEventHandler("paste",this.onPaste)},e.prototype.dispose=function(){this.pasteDisposer(),this.pasteDisposer=null,this.editor=null},e.prototype.pasteOriginal=function(e){this.paste(e,this.detectPasteOption(e))},e.prototype.pasteText=function(e){this.paste(e,1)},e.prototype.pasteAndMergeFormat=function(e){this.paste(e,this.detectPasteOption(e),!0)},e.prototype.detectPasteOption=function(e){return e.text||!e.image?0:2},e.prototype.paste=function(e,t,n){var a=this.editor.getDocument(),i=a.createDocumentFragment();if(0==t)for(var r=e.html,o=0,s=d.fromHtml(r,a);o<s.length;o++){var c=s[o];n&&this.applyToElements(c,this.applyFormatting(e.originalFormat,this.editor.isDarkMode())),i.appendChild(c)}var l=this.editor.triggerPluginEvent(8,{clipboardData:e,fragment:i,pasteOption:t},!0);this.internalPaste(l)},e.prototype.internalPaste=function(e){var t=this,n=e.clipboardData,a=e.fragment,i=e.pasteOption;this.editor.focus(),this.editor.addUndoSnapshot(function(){switch(null==n.snapshotBeforePaste?n.snapshotBeforePaste=t.editor.getContent(!1,!0):t.editor.setContent(n.snapshotBeforePaste),i){case 0:t.editor.insertNode(a);break;case 1:var e=r.default(n.text);t.editor.insertContent(e);break;case 2:s.insertImage(t.editor,n.image)}return n},"Paste")},e.prototype.applyToElements=function(e,t){for(var n=d.getFirstLeafNode(e),a=[];n;)3==n.nodeType&&n.parentNode&&a.indexOf(n.parentNode)<0&&a.push(n.parentNode),n=d.getNextLeafSibling(e,n);a.push(e);for(var i=0,r=a;i<r.length;i++)t(r[i])},e.prototype.getCurrentFormat=function(){var e=o.getFormatState(this.editor);return e?{fontFamily:e.fontName,fontSize:e.fontSize,textColor:e.textColor,backgroundColor:e.backgroundColor,bold:e.isBold,italic:e.isItalic,underline:e.isUnderline}:{}},e.prototype.sanitizeHtml=function(e){var t=c.htmlToDom(e,!0,i.default);if(t&&t.body){this.sanitizer.convertGlobalCssToInlineCss(t);var n=this.editor.getSelectionRange(),a=n&&d.Position.getStart(n).normalize().element,r=c.getInheritableStyles(a);return this.sanitizer.sanitize(t.body,r),t.body.innerHTML}return""},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.default=function(e,t,n){a.extractClipboardEvent(e,function(e){void 0===e.html?function(e,t){var n=e.getSelectionRange(),i=function(e){var t=e.getCustomData("PasteDiv",function(){var t=a.fromHtml('<div contenteditable style="width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text"></div>',e.getDocument())[0];return e.insertNode(t,{position:4,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t},function(e){e.parentNode.removeChild(e)});return t.style.display="",t}(e);i.focus(),e.runAsync(function(){e.select(n),t(i.innerHTML),i.style.display="none",i.innerHTML=""})}(t,function(t){e.html=t,n(e)}):n(e)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2025),i=n(2026),r=n(2030),o=n(1214),s=n(97),c=n(435),d=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,l=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,u=/<tr[^>]*>[^<]*/i,f=/<table[^>]*>[^<]*/i;t.default=function(e,t){var n=c.splitWithFragment(t),p=n[0],m=n[1],_=e&&e.body&&e.querySelector("html");if("HTML"==s.getTagOfNode(_)){var h=void 0;if("urn:schemas-microsoft-com:office:word"==_.getAttribute("xmlns:w"))e.body.innerHTML=p,i.default(e);else if((h=_.querySelectorAll(o.WAC_IDENTIFING_SELECTOR))[0])h.forEach(function(e){e.style.display=null,e.style.margin=null}),r.isWordOnlineWithList(_)&&r.default(e);else if("urn:schemas-microsoft-com:office:excel"==_.getAttribute("xmlns:x")){if(p.match(d)){var b=m.match(u);p=(b?b[0]:"<TR>")+p+"</TR>"}if(p.match(l)){var g=m.match(f);p=(g?g[0]:"<TABLE>")+p+"</TABLE>"}e.body.innerHTML=p,a.default(e)}else e.body.innerHTML=p}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(435);t.default=function(e){var t=new a.HtmlSanitizer({styleCallbacks:{border:function(e,t){return"none"!=e||"none"!=t.style.border}},additionalAllowAttributes:["class"]});t.sanitize(e.body);var n=e.createElement("style");e.body.appendChild(n),n.innerHTML="td {border: solid 1px #d4d4d4}",t.convertGlobalCssToInlineCss(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2027),i=n(2028),r=n(435),o=n(2029);t.default=function(e){var t;new r.HtmlSanitizer({elementCallbacks:(t={},t["O:P"]=function(e){return"&nbsp;"==e.innerHTML},t),additionalAllowAttributes:["class"]}).sanitize(e.body);var n=a.createWordConverter(),s=e.querySelectorAll("p");s.length>0&&(n.wordConverterArgs=i.createWordConverterArguments(s),o.processNodesDiscovery(n)&&o.processNodeConvert(n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1212);t.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,customData:a.createCustomData()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1213);t.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[a.createLevelLists()],lastProcessedItem:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1213),i=n(1212),r=n(97),o="UniqueListId",s="mso-list",c=/[\n|\r]/gi;function d(e,t,n,a){var s=l(t,n.level,a),c=i.getObject(e.customData,s,o);if(c&&c!=n.uniqueListId||!c&&s.firstChild){var d=t.ownerDocument.createElement(a.tagName);s.parentNode.insertBefore(d,s.nextSibling),s=d}return i.setObject(e.customData,s,o,n.uniqueListId),function(e,t,n){if(n.tagName!=r.getTagOfNode(t)){var a=t.ownerDocument.createElement(n.tagName);for(i.setObject(e.customData,a,o,i.getObject(e.customData,t,o));t.firstChild;)a.appendChild(t.firstChild);t.parentNode.insertBefore(a,t),t.parentNode.removeChild(t),t=a}return t}(e,s,a)}function l(e,t,n){var a,i=null;if((a=1==t?h(e):(i=l(e,t-1,null)).lastChild)&&1==a.nodeType){var o=r.getTagOfNode(a);if("UL"==o||"OL"==o)return a}var s=e.ownerDocument.createElement(n?n.tagName:"UL");return 1==t?e.parentNode.insertBefore(s,e):i.appendChild(s),s}function u(e,t){for(var n=[],a=e.firstChild;a;a=a.nextSibling)1==a.nodeType&&t>1&&u(a,t-1),(v(a=_(a,!0))||g(a))&&n.push(a);n.forEach(function(t){return e.removeChild(t)})}function f(e){if(1==e.nodeType){var t=y(e,s);if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function p(e){return["o","·","§","-"].indexOf(e)>=0}function m(e,t){for(var n=null,a=e.firstChild;!n&&a;)g(a=_(a,!0))?0==(n=a.textContent.trim()).length&&(n="o"):1==a.nodeType&&t>1&&(n=m(a,t-1)),a=a.nextSibling;return n}function _(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var a=e,i=null,r=0;r<4&&(a=b(a));r++)if(8==a.nodeType&&(n=a.data)&&"[endif]"==n.trim().toLowerCase()){i=a;break}if(i){var o=e.ownerDocument.createElement("span");for(o.setAttribute("style","mso-list: ignore"),a=b(e);a!=i;)a=a.nextSibling,o.appendChild(a.previousSibling);i.parentNode.insertBefore(o,i),t&&(e.parentNode.removeChild(e),i.parentNode.removeChild(i)),e=o}}}return e}function h(e){var t=e;do{t=t.previousSibling}while(t&&S(t));return t}function b(e){var t=e;do{t=t.nextSibling}while(t&&S(t));return t}function g(e){if(1==e.nodeType){var t=y(e,s);if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function v(e){return"SPAN"==r.getTagOfNode(e)&&!e.firstChild}function y(e,t){var n=e.getAttribute("style");if(n&&n.length>0&&n.indexOf(t)>=0)for(var a=n.split(";"),i=0;i<a.length;i++){var r=a[i].split(":");if(2==r.length&&r[0].trim()==t)return r[1].trim()}return null}function S(e){if(!e)return!0;if(3==e.nodeType){var t=e.nodeValue;return 0==(t=t.replace(c,"")).trim().length}var n=r.getTagOfNode(e);return e.firstChild==e.lastChild&&("SPAN"==n||"FONT"==n)&&S(e.firstChild)}function D(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}t.processNodesDiscovery=function(e){for(var t,n=e.wordConverterArgs;n.currentIndex<n.nodes.length;){var i=n.nodes.item(n.currentIndex),r=f(i);if(r){var o=n.currentListIdsByLevels[r.level-1]||a.createLevelLists();n.currentListIdsByLevels[r.level-1]=o,n.lastProcessedItem&&h(i)!=n.lastProcessedItem&&D(n);var s=o.listsMetadata[r.wordListId];if(s){if(!s.ignore&&1==s.numberOfItems){var c=m(i,5);s.tagName=s.firstFakeBullet==c?"UL":"OL"}}else{var d=m(i,5);s={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:d,ignore:!d||0==d.length,tagName:(t=d,p(t)?"UL":"OL")},o.listsMetadata[r.wordListId]=s,n.lists[s.uniqueListId.toString()]=s}r.uniqueListId=s.uniqueListId,s.ignore||"OL"==s.tagName&&s.numberOfItems>0&&o.currentUniqueListId!=r.uniqueListId?(s.ignore=!0,n.currentListIdsByLevels[0].currentUniqueListId=-1,n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,1)):(n.currentListIdsByLevels.length>r.level&&(n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,r.level)),o.currentUniqueListId=r.uniqueListId,n.listItems.push(r),s.numberOfItems++),n.lastProcessedItem=i}else{var l=n.lastProcessedItem;if(l&&h(i)==l&&i.tagName==l.tagName&&i.className==l.className){for(l.appendChild(l.ownerDocument.createElement("br")),l.appendChild(l.ownerDocument.createElement("br"));null!=i.firstChild;)l.appendChild(i.firstChild);i.parentNode.removeChild(i)}}n.currentIndex++}return n.listItems.length>0},t.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n=t.listItems[t.currentIndex],a=n.originalNode,i=t.lists[n.uniqueListId.toString()];if(!i.ignore){var r=d(e,a,n,i);if(r){u(a,5);for(var o=a.ownerDocument.createElement("LI");a.firstChild;)o.appendChild(a.firstChild);r.appendChild(o),a.parentNode.removeChild(a),"UL"==i.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}t.currentIndex++}return e.numBulletsConverted>0||e.numNumberedConverted>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1214),i=n(97),r=n(2031);function o(e,t,n){if(e){var a,i=n.insertPositionNode;i?(a=i.parentElement)&&a.insertBefore(e,i):(a=n.startElement.parentElement)?a.appendChild(e):t.append(e)}}t.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(a.WORD_ONLINE_IDENTIFYING_SELECTOR))},t.default=function(e){!function(e){e.querySelectorAll(a.WORD_ORDERED_LIST_SELECTOR+", "+a.WORD_UNORDERED_LIST_SELECTOR).forEach(function(e){var t=new RegExp("\\b"+a.LIST_CONTAINER_ELEMENT_CLASS_NAME+"\\b","g");if(e.previousSibling){var n=i.splitParentNode(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var r=i.splitParentNode(e,!1);r.className=r.className.replace(t,"")}})}(e);var t=function(e){for(var t,n=e.getElementsByClassName(a.LIST_CONTAINER_ELEMENT_CLASS_NAME),o=[],s=0;s<n.length;s++){var c=n[s];if(t){var d=t.listItemContainers,l=d[d.length-1];c==l.nextSibling||i.getFirstLeafNode(c)==i.getNextLeafSibling(e.body,l)?(d.push(c),t.endElement=c):(t.endElement=l,o.push(t),t=r.createListItemBlock(c))}else t=r.createListItemBlock(c)}return t.listItemContainers.length>0&&o.push(t),o}(e);t.forEach(function(t){var n,r,s;n=e.body,r=t,i.collapseNodes(n,r.startElement,r.endElement,!0).forEach(function(e){"DIV"==i.getTagOfNode(e.firstChild)&&i.unwrap(e)}),t.insertPositionNode=t.endElement.nextSibling,t.listItemContainers.forEach(function(n){var r=function(e){var t=i.getTagOfNode(e.firstChild);return t==a.UNORDERED_LIST_TAG_NAME||t==a.ORDERED_LIST_TAG_NAME?t:null}(n);s||(s=e.createElement(r)),n.querySelectorAll("li").forEach(function(n){var c=parseInt(n.getAttribute("data-aria-level"));i.getTagOfNode(s)!=r&&1==c&&(o(s,e.body,t),s=e.createElement(r)),function(e,t,n,r){if(n){for(var o=parseInt(t.getAttribute("data-aria-level")),s=e;o>1;){if(s.firstChild){var c=s.lastElementChild,d=i.getTagOfNode(c);d==a.UNORDERED_LIST_TAG_NAME||d==a.ORDERED_LIST_TAG_NAME?s=c:(s.append(r.createElement(n)),s=s.lastElementChild)}else s.append(r.createElement(n)),s=s.firstElementChild;o--}s.appendChild(t)}}(s,n,r,e)})}),o(s,e.body,t);var c=t.startElement.parentNode;c&&t.listItemContainers.forEach(function(e){c.removeChild(e)})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItemBlock=function(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97);t.default=function(e){var t=(e=(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/^ /gm,"&nbsp;").replace(/\r/g,"")).split("\n");if(2==t.length)e="<span>"+t[0]+"<br></span><span>"+t[1]+"</span>";else if(t.length>2){e="";var n=a.Browser.isIEOrEdge?"&#8203;":"<br>";t.forEach(function(a,i){0==i?e+="<span>"+a+"<br></span>":i==t.length-1?e+="<span>"+a+"</span>":e+="<div>"+a+n+"</div>"})}return e=e.replace(/ {2}/g," &nbsp;")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i="_rooster_watermarkSpan",r=new RegExp("<span[^>]*id=['\"]?"+i+"['\"]?[^>]*>[^<]*</span>","ig"),o="spellcheck",s=function(){function e(e,t){var n=this;this.watermark=e,this.format=t,this.handleWatermark=function(){n.showHideWatermark(!1)},this.format=this.format||{fontSize:"14px",textColor:"#aaa"}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.handleWatermark,blur:this.handleWatermark}),this.spellcheckInitialValue=this.editor.getEditorDomAttribute(o)},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.hideWatermark(),this.editor=null},e.prototype.onPluginEvent=function(e){9==e.eventType?this.showHideWatermark(!1):6==e.eventType?this.showHideWatermark("SetContent"==e.source):7==e.eventType&&this.isWatermarkShowing&&this.removeWartermarkFromHtml(e)},e.prototype.showHideWatermark=function(e){this.editor.hasFocus()&&(e||this.isWatermarkShowing)?(this.hideWatermark(),this.editor.focus()):this.editor.hasFocus()||!e&&this.isWatermarkShowing||!this.editor.isEmpty(!0)||this.showWatermark()},e.prototype.showWatermark=function(){var e=this.editor.getDocument(),t=a.wrap(e.createTextNode(this.watermark),'<span id="'+i+'"></span>');a.applyFormat(t,this.format,this.editor.isDarkMode()),this.editor.insertNode(t,{position:0,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),this.editor.setEditorDomAttribute(o,"false"),this.isWatermarkShowing=!0},e.prototype.hideWatermark=function(){var e=this;this.editor.queryElements('span[id="'+i+'"]',function(t){var n=t.parentNode;e.editor.deleteNode(t),e.editor.contains(n)&&"DIV"==a.getTagOfNode(n)&&!n.firstChild&&n.appendChild(e.editor.getDocument().createElement("BR"))}),this.editor.setEditorDomAttribute(o,this.spellcheckInitialValue),this.isWatermarkShowing=!1},e.prototype.removeWartermarkFromHtml=function(e){var t=e.content;t=t.replace(r,""),e.content=t},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=n(254),r=function(){function e(){var e=this;this.pageX=-1,this.onMouseOver=function(t){var n=t.srcElement||t.target;e.pageX<0&&n&&("TD"==n.tagName||"TH"==n.tagName)&&n!=e.td&&(e.td=n,e.calcAndShowHandle())},this.onMouseDown=function(t){e.editor&&!e.editor.isDisposed()&&(e.pageX=t.pageX,e.initialPageX=t.pageX,e.attachMouseEvents(),e.getResizeHandle().style.borderWidth="0 1px",e.cancelEvent(t))},this.onMouseMove=function(t){e.adjustHandle(t.pageX),e.cancelEvent(t)},this.onMouseUp=function(t){e.detachMouseEvents(),e.getResizeHandle().style.borderWidth="0";var n=e.editor.getElementAtCursor("TABLE",e.td),i=parseInt(n.cellPadding);if(i=isNaN(i)?0:i,t.pageX!=e.initialPageX){var r=e.td.clientWidth-2*i+(t.pageX-e.initialPageX)*(a.isRtl(n)?-1:1);e.editor.addUndoSnapshot(function(t,n){e.setTableColumnWidth(r+"px"),e.editor.select(t,n)},"Format")}e.pageX=-1,e.calcAndShowHandle(),e.editor.focus(),e.cancelEvent(t)}}return e.prototype.initialize=function(e){this.editor=e,this.onMouseOverDisposer=this.editor.addDomEventHandler("mouseover",this.onMouseOver)},e.prototype.getName=function(){return"TableResize"},e.prototype.dispose=function(){this.detachMouseEvents(),this.editor=null,this.onMouseOverDisposer()},e.prototype.onPluginEvent=function(e){this.td&&(0==e.eventType||6==e.eventType||4==e.eventType&&!this.clickIntoCurrentTd(e))&&(this.td=null,this.calcAndShowHandle())},e.prototype.clickIntoCurrentTd=function(e){var t=e.rawEvent.target;return i.isNode(t)&&a.contains(this.td,t,!0)},e.prototype.calcAndShowHandle=function(){if(this.td){var e=this.editor.getElementAtCursor("TR",this.td),t=this.editor.getElementAtCursor("TABLE",e);if(e&&t){var n=this.getPosition(t),i=n[0],r=n[1],o=this.getResizeHandle();i+=this.td.offsetLeft+(a.isRtl(t)?0:this.td.offsetWidth-6),o.style.display="",o.style.top=r+"px",o.style.height=t.offsetHeight+"px",o.style.left=i+"px"}}else this.getResizeHandle().style.display="none"},e.prototype.adjustHandle=function(e){var t=this.getResizeHandle();t.style.left=t.offsetLeft+e-this.pageX+"px",this.pageX=e},e.prototype.getPosition=function(e){var t=e.offsetParent,n=t?this.getPosition(t):[0,0],a=n[0],i=n[1];return[a+e.offsetLeft-e.scrollLeft,i+e.offsetTop-e.scrollTop]},e.prototype.getResizeHandle=function(){var e=this;return this.editor.getCustomData("TABLE_RESIZE_HANDLE",function(){var t=e.editor.getDocument(),n=a.fromHtml('<div style="position: fixed; cursor: col-resize; width: 6px; border: solid 0 #C6C6C6;"></div>',t)[0];return e.editor.insertNode(n,{position:4,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),n.addEventListener("mousedown",e.onMouseDown),n},function(t){t.removeEventListener("mousedown",e.onMouseDown),t.parentNode.removeChild(t)})},e.prototype.cancelEvent=function(e){e.stopPropagation(),e.preventDefault()},e.prototype.attachMouseEvents=function(){if(this.editor&&!this.editor.isDisposed()){var e=this.editor.getDocument();e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mouseup",this.onMouseUp,!0)}},e.prototype.detachMouseEvents=function(){if(this.editor&&!this.editor.isDisposed()){var e=this.editor.getDocument();e.removeEventListener("mousemove",this.onMouseMove,!0),e.removeEventListener("mouseup",this.onMouseUp,!0)}},e.prototype.setTableColumnWidth=function(e){var t=this,n=new a.VTable(this.td);return n.table.style.width="",n.table.width="",n.forEachCellOfCurrentColumn(function(n){n.td&&(n.td.style.width=n.td==t.td?e:"")}),n.writeBack(),this.editor.contains(this.td)?this.td:n.getCurrentTd()},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(296),i=function(e,t,n){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n}},r=[i(":)","🙂",!0),i(";)","😉",!0),i(":O","😲",!0),i(":o","😯",!0),i("<3","❤️",!0)],o=function(){function e(e){void 0===e&&(e=r),this.updateReplacements(e)}return e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map(function(e){return e.sourceString.length}))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,a=e;n<a.length;n++){var i=a[n],r=i.sourceString;if(0!=r.length){var o=r[r.length-1];i.matchSourceCaseSensitive?t.add(o):(t.add(o.toLocaleLowerCase()),t.add(o.toLocaleUpperCase()))}}return t}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(!this.editor.isInIME()&&11==e.eventType&&e.rawEvent.data&&this.replacementEndCharacters.has(e.rawEvent.data)&&null!=this.editor.getSelectionRange()){var n=a.cacheGetContentSearcher(e,this.editor),i=n.getSubStringBefore(this.longestReplacementLength),r=this.getMatchingReplacement(i);if(null!=r){var o=n.getSubStringBefore(r.sourceString.length),s=n.getRangeFromText(o,!0),c=this.editor.getDocument().createElement("span");c.innerHTML=r.replacementHTML;var d=1==c.childNodes.length?c.childNodes[0]:c;this.editor.performAutoComplete(function(){s.deleteContents(),s.insertNode(d),t.editor.select(d,-1)})}}},e.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.toLocaleLowerCase(),n=0,a=this.replacements;n<a.length;n++){var i=a[n],r=i.matchSourceCaseSensitive?[e,i.sourceString]:[t,i.sourceString.toLocaleLowerCase()],o=r[0],s=r[1];if(o.substring(o.length-s.length)==s)return i}return null},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2037);t.DocumentCommand=a.DocumentCommand;var i=n(2038);t.DocumentPosition=i.DocumentPosition;var r=n(2039);t.NodeType=r.NodeType;var o=n(2040);t.Alignment=o.Alignment;var s=n(2041);t.ChangeSource=s.ChangeSource;var c=n(2042);t.ContentPosition=c.ContentPosition;var d=n(2043);t.Direction=d.Direction;var l=n(2044);t.FontSizeChange=l.FontSizeChange;var u=n(2045);t.Indentation=u.Indentation;var f=n(2046);t.PasteOption=f.PasteOption;var p=n(2047);t.PositionType=p.PositionType;var m=n(2048);t.QueryScope=m.QueryScope;var _=n(2049);t.TableOperation=_.TableOperation;var h=n(2050);t.PluginEventType=h.PluginEventType},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.DocumentCommand||(t.DocumentCommand={})).AutoUrlDetect="AutoUrlDetect",a.BackColor="backColor",a.Bold="bold",a.ClearAuthenticationCache="ClearAuthenticationCache",a.ContentReadOnly="contentReadOnly",a.Copy="copy",a.CreateLink="createLink",a.Cut="cut",a.DecreaseFontSize="decreaseFontSize",a.DefaultParagraphSeparator="defaultParagraphSeparator",a.Delete="delete",a.EnableInlineTableEditing="enableInlineTableEditing",a.EnableObjectResizing="enableObjectResizing",a.FontName="fontName",a.FontSize="fontSize",a.ForeColor="foreColor",a.FormatBlock="formatBlock",a.ForwardDelete="forwardDelete",a.Heading="heading",a.HiliteColor="hiliteColor",a.IncreaseFontSize="increaseFontSize",a.Indent="indent",a.InsertBrOnReturn="insertBrOnReturn",a.InsertHorizontalRule="insertHorizontalRule",a.InsertHTML="insertHTML",a.InsertImage="insertImage",a.InsertOrderedList="insertOrderedList",a.InsertUnorderedList="insertUnorderedList",a.InsertParagraph="insertParagraph",a.InsertText="insertText",a.Italic="italic",a.JustifyCenter="justifyCenter",a.JustifyFull="justifyFull",a.JustifyLeft="justifyLeft",a.JustifyRight="justifyRight",a.Outdent="outdent",a.Paste="paste",a.Redo="redo",a.RemoveFormat="removeFormat",a.SelectAll="selectAll",a.StrikeThrough="strikeThrough",a.Subscript="subscript",a.Superscript="superscript",a.Underline="underline",a.Undo="undo",a.Unlink="unlink",a.StyleWithCSS="styleWithCSS"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.DocumentPosition||(t.DocumentPosition={}))[a.Same=0]="Same",a[a.Disconnected=1]="Disconnected",a[a.Preceding=2]="Preceding",a[a.Following=4]="Following",a[a.Contains=8]="Contains",a[a.ContainedBy=16]="ContainedBy"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.NodeType||(t.NodeType={}))[a.Element=1]="Element",a[a.Text=3]="Text",a[a.ProcessingInstruction=7]="ProcessingInstruction",a[a.Comment=8]="Comment",a[a.Document=9]="Document",a[a.DocumentType=10]="DocumentType",a[a.DocumentFragment=11]="DocumentFragment"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.Alignment||(t.Alignment={}))[a.Left=0]="Left",a[a.Center=1]="Center",a[a.Right=2]="Right"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.ChangeSource||(t.ChangeSource={})).AutoLink="AutoLink",a.CreateLink="CreateLink",a.Format="Format",a.ImageResize="ImageResize",a.Paste="Paste",a.SetContent="SetContent",a.Cut="Cut",a.Drop="Drop"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.ContentPosition||(t.ContentPosition={}))[a.Begin=0]="Begin",a[a.End=1]="End",a[a.DomEnd=2]="DomEnd",a[a.SelectionStart=3]="SelectionStart",a[a.Outside=4]="Outside",a[a.Range=5]="Range"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.Direction||(t.Direction={}))[a.LeftToRight=0]="LeftToRight",a[a.RightToLeft=1]="RightToLeft"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.FontSizeChange||(t.FontSizeChange={}))[a.Increase=0]="Increase",a[a.Decrease=1]="Decrease"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.Indentation||(t.Indentation={}))[a.Increase=0]="Increase",a[a.Decrease=1]="Decrease"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.PasteOption||(t.PasteOption={}))[a.PasteHtml=0]="PasteHtml",a[a.PasteText=1]="PasteText",a[a.PasteImage=2]="PasteImage"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.PositionType||(t.PositionType={}))[a.Begin=0]="Begin",a[a.End=-1]="End",a[a.Before=-2]="Before",a[a.After=-3]="After"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.QueryScope||(t.QueryScope={}))[a.Body=0]="Body",a[a.OnSelection=1]="OnSelection",a[a.InSelection=2]="InSelection"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.TableOperation||(t.TableOperation={}))[a.InsertAbove=0]="InsertAbove",a[a.InsertBelow=1]="InsertBelow",a[a.InsertLeft=2]="InsertLeft",a[a.InsertRight=3]="InsertRight",a[a.DeleteTable=4]="DeleteTable",a[a.DeleteColumn=5]="DeleteColumn",a[a.DeleteRow=6]="DeleteRow",a[a.MergeAbove=7]="MergeAbove",a[a.MergeBelow=8]="MergeBelow",a[a.MergeLeft=9]="MergeLeft",a[a.MergeRight=10]="MergeRight",a[a.SplitHorizontally=11]="SplitHorizontally",a[a.SplitVertically=12]="SplitVertically"},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),(a=t.PluginEventType||(t.PluginEventType={}))[a.KeyDown=0]="KeyDown",a[a.KeyPress=1]="KeyPress",a[a.KeyUp=2]="KeyUp",a[a.CompositionEnd=3]="CompositionEnd",a[a.MouseDown=4]="MouseDown",a[a.MouseUp=5]="MouseUp",a[a.ContentChanged=6]="ContentChanged",a[a.ExtractContent=7]="ExtractContent",a[a.BeforePaste=8]="BeforePaste",a[a.EditorReady=9]="EditorReady",a[a.BeforeDispose=10]="BeforeDispose",a[a.Input=11]="Input",a[a.PendingFormatStateChanged=12]="PendingFormatStateChanged",a[a.DarkModeChanged=13]="DarkModeChanged",a[a.Scroll=14]="Scroll"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2052);t.ImageResize=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i="RoosterJsImageResizingBegin",r="RoosterJsImageResizingEnd",o=new RegExp("\x3c!--"+i+"--\x3e[\\s\\S]*(<img\\s[^>]+>)[\\s\\S]*\x3c!--"+r+"--\x3e","gim"),s=function(){function e(e,t,n,a,o){var s=this;void 0===e&&(e=10),void 0===t&&(t=10),void 0===n&&(n="#DB626C"),void 0===a&&(a=!1),void 0===o&&(o="img"),this.minWidth=e,this.minHeight=t,this.selectionBorderColor=n,this.forcePreserveRatio=a,this.resizableImageSelector=o,this.startResize=function(e){var t=s.getSelectedImage();if(s.editor&&t){s.startPageX=e.pageX,s.startPageY=e.pageY,s.startWidth=t.clientWidth,s.startHeight=t.clientHeight,s.editor.addUndoSnapshot();var n=s.editor.getDocument();n.addEventListener("mousemove",s.doResize,!0),n.addEventListener("mouseup",s.finishResize,!0),s.direction=(e.srcElement||e.target).style.cursor}s.stopEvent(e)},this.doResize=function(e){var t=s.getSelectedImage();if(s.editor&&t){var n=e.pageX-s.startPageX,a=e.pageY-s.startPageY,i=Math.max(s.startWidth+(s.isWest(s.direction)?-n:n),s.minWidth),r=Math.max(s.startHeight+(s.isNorth(s.direction)?-a:a),s.minHeight);if((s.forcePreserveRatio||e.shiftKey)&&(o=s.startWidth>0&&s.startHeight>0?1*s.startWidth/s.startHeight:0)>0&&(i<r*o?i=r*o:r=i/o),t.style.width=i+"px",t.style.height=r+"px",s.forcePreserveRatio||e.shiftKey){var o=s.startWidth>0&&s.startHeight>0?1*s.startWidth/s.startHeight:0,c=Math.floor(t.clientWidth),d=Math.floor(t.clientHeight);i=Math.floor(i),d===(r=Math.floor(r))&&c===i||(d<r?i=d*o:r=c/o,t.style.width=i+"px",t.style.height=r+"px")}}s.stopEvent(e)},this.finishResize=function(e){var t=s.getSelectedImage();if(s.editor&&t){var n=s.editor.getDocument();n.removeEventListener("mousemove",s.doResize,!0),n.removeEventListener("mouseup",s.finishResize,!0);var a=t.clientWidth,i=t.clientHeight;t.style.width=a+"px",t.style.height=i+"px",t.width=a,t.height=i,s.resizeDiv.style.width="",s.resizeDiv.style.height=""}s.direction=null,s.editor.addUndoSnapshot(),s.editor.triggerContentChangedEvent("ImageResize"),s.stopEvent(e)},this.stopEvent=function(e){e.stopPropagation(),e.preventDefault()},this.removeResizeDivIfAny=function(e){var t=e&&e.parentNode,n=t&&t.previousSibling,a=t&&t.nextSibling;n&&8==n.nodeType&&n.nodeValue==i&&a&&8==a.nodeType&&a.nodeValue==r&&(t.parentNode.insertBefore(e,t),s.removeResizeDiv(t))},this.onBlur=function(e){s.hideResizeHandle()},this.onDragStart=function(e){(e.srcElement||e.target)==s.getSelectedImage()&&s.hideResizeHandle(!0)}}return e.prototype.getName=function(){return"ImageResize"},e.prototype.initialize=function(e){this.editor=e,this.disposer=e.addDomEventHandler({dragstart:this.onDragStart,blur:this.onBlur})},e.prototype.dispose=function(){this.resizeDiv&&this.hideResizeHandle(),this.disposer(),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(4==e.eventType){var n=e.rawEvent,i=n.srcElement||n.target;if("IMG"==a.getTagOfNode(i)){var r=i.parentNode;if((r?[].slice.call(r.querySelectorAll(this.resizableImageSelector)):[]).indexOf(i)<0)return;i.contentEditable="false";var o=this.getSelectedImage();o&&o!=i&&this.hideResizeHandle(),this.resizeDiv||this.showResizeHandle(i)}else this.resizeDiv&&!a.contains(this.resizeDiv,i)&&this.hideResizeHandle()}else if(0==e.eventType&&this.resizeDiv){var s=e.rawEvent;46==s.which||8==s.which?(this.editor.addUndoSnapshot(function(){t.removeResizeDiv(t.resizeDiv)}),this.resizeDiv=null,s.preventDefault(),this.resizeDiv=null):16!=s.which&&17!=s.which&&18!=s.which&&this.hideResizeHandle(!0)}else if(6==e.eventType&&"ImageResize"!=e.source)this.editor.queryElements("img",this.removeResizeDivIfAny),this.resizeDiv=null;else if(7==e.eventType){var c=e;c.content=this.extractHtml(c.content)}},e.prototype.showResizeHandle=function(e){this.resizeDiv=this.createResizeDiv(e),e.contentEditable="false",this.editor.select(this.resizeDiv,-3)},e.prototype.hideResizeHandle=function(e){var t=this.getSelectedImage(),n=this.resizeDiv&&this.resizeDiv.parentNode;if(n){if(t){t.removeAttribute("contentEditable");var a=this.resizeDiv.previousSibling&&8==this.resizeDiv.previousSibling.nodeType?this.resizeDiv.previousSibling:this.resizeDiv;n.insertBefore(t,a),e?this.editor.select(t):this.editor.select(t,-3)}this.removeResizeDiv(this.resizeDiv),this.resizeDiv=null}},e.prototype.createResizeDiv=function(e){var t=this,n=this.editor.getDocument(),a=n.createElement("DIV"),o=e.parentNode;o.insertBefore(a,e),o.insertBefore(n.createComment(i),a),o.insertBefore(n.createComment(r),a.nextSibling),a.style.position="relative",a.style.display="inline-flex",a.contentEditable="false",a.addEventListener("click",this.stopEvent),a.appendChild(e),["nw","ne","sw","se"].forEach(function(e){var i=n.createElement("DIV");a.appendChild(i),i.style.position="absolute",i.style.width="7px",i.style.height="7px",i.style.backgroundColor=t.selectionBorderColor,i.style.cursor=e+"-resize",t.isNorth(e)?i.style.top="-3px":i.style.bottom="-3px",t.isWest(e)?i.style.left="-3px":i.style.right="-3px",i.addEventListener("mousedown",t.startResize)});var s=n.createElement("DIV");return a.appendChild(s),s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.right="0",s.style.bottom="0",s.style.border="solid 1px "+this.selectionBorderColor,s.style.pointerEvents="none",a},e.prototype.removeResizeDiv=function(e){var t=this;this.editor&&this.editor.contains(e)&&([e.previousSibling,e.nextSibling].forEach(function(e){e&&8==e.nodeType&&t.editor.deleteNode(e)}),this.editor.deleteNode(e))},e.prototype.extractHtml=function(e){return e.replace(o,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e[1].replace(/(\s*contenteditable="false"(\/?>)|contenteditable="false"\s*)/im,"$2")})},e.prototype.getSelectedImage=function(){return this.resizeDiv?this.resizeDiv.getElementsByTagName("IMG")[0]:null},e.prototype.isNorth=function(e){return e&&"n"==e.substr(0,1)},e.prototype.isWest=function(e){return e&&"w"==e.substr(1,1)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2054);t.PickerPlugin=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(97),i=n(434),r=n(296),o=a.Browser.isIE?"Esc":"Escape",s=a.Browser.isIE?"Left":"ArrowLeft",c=a.Browser.isIE?"Up":"ArrowUp",d=a.Browser.isIE?"Right":"ArrowRight",l=a.Browser.isIE?"Down":"ArrowDown",u=a.Browser.isIE?"Del":"Delete",f="Unidentified",p=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize(function(e){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));var a=function(){n?i.replaceWithNode(t.editor,n,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)};t.pickerOptions.handleAutoComplete?t.editor.performAutoComplete(a,t.pickerOptions.changeSource):t.editor.addUndoSnapshot(a,t.pickerOptions.changeSource)},function(e){t.setIsSuggesting(e)},e)},e.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||11==e.eventType)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",function(e){e.id&&t.push(e.id)}),this.dataProvider.onContentChanged(t)}break;case 0:this.eventHandledOnKeyDown=!1,e.rawEvent.key==f?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 11:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 5:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=r.cacheGetContentSearcher(e,this.editor);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,n,i=this;return r.cacheGetContentSearcher(e,this.editor).forEachTextInlineElement(function(e){for(var a=!1,r=e.getTextContent(),o=r?r.length:-1;o>=0;){if(r[o]==i.pickerOptions.triggerCharacter){t=e.getStartPosition().move(o),a=!0;break}o--}return a&&(n=e.getEndPosition()),a}),a.createRange(t,n)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return e.rawEvent.key==f||r.isCharacterValue(e.rawEvent)||this.isSuggesting&&!r.isModifierKey(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(a=(n=this.getWord(e)).substring(1)).trim();n==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,a==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var n=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter){var a;if(this.setIsSuggesting(!0),t=(a=n.substring(1)).trim(),this.dataProvider.queryStringUpdated(t,a==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var i=r.cacheGetContentSearcher(e,this.editor),o=this.editor.getDocument().createRange(),s=i.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(o,s,n)){var c=s.previousSibling;this.setRangeStart(o,c,this.pickerOptions.triggerCharacter)}var d=o.getBoundingClientRect();if(0==d.left&&0==d.bottom&&0==d.top&&(d=o.getClientRects()[0]),d){o.detach();var l={x:d.left,y:(d.bottom+d.top)/2},u=(d.bottom-d.top)/2;this.dataProvider.setCursorPoint(l,u)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)t.key==o?(this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e)):this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==s||t.key==d:t.key==c||t.key==l)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==d:t.key==l),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==u){var n=r.cacheGetContentSearcher(e,this.editor),a=n.getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null,i=a?this.getIdValue(a):null;if(i&&0==i.indexOf(this.pickerOptions.elementIdPrefix)){var f=this.dataProvider.onRemove(a,!1);this.replaceNode(a,f),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){this.newInputLength=this.calcInputLength(e),(this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0)},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this,n=r.cacheGetContentSearcher(e,this.editor),i=n.getInlineElementBefore(),o=i?i.getContainerNode():null,s=o?this.getIdValue(o):null,c=n.getInlineElementAfter();if(s&&0==s.indexOf(this.pickerOptions.elementIdPrefix)&&(null==c||!(c instanceof a.PartialInlineElement))){var d=this.dataProvider.onRemove(o,!0);return d?(this.replaceNode(o,d),this.isPendingInputEventHandling?this.editor.runAsync(function(){t.editor.select(d,-3)}):this.editor.select(d,-3)):this.editor.deleteNode(o),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),n=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=n?n:t},e.prototype.setRangeStart=function(e,t,n){var a=t?t.textContent.lastIndexOf(n):-1;return a>-1&&(e.setStart(t,a),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=r.cacheGetContentSearcher(e,this.editor),n=t?t.getInlineElementBefore():null;return n?n.getTextContent():null},e}();t.default=p}])]);