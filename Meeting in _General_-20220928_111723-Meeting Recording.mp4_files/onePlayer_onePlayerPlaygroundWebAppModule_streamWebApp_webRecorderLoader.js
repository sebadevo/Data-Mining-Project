(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[4],{311:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"i",function(){return o});var a,i,r=n(55);!function(e){e[e.Always=0]="Always",e[e.IfAnyFramesOffend=1]="IfAnyFramesOffend",e[e.OnlyOffendingFrames=2]="OnlyOffendingFrames",e[e.Never=3]="Never"}(a||(a={})),function(e){e[e.Never=0]="Never",e[e.WhenNotInErrorHashAllowlist=1]="WhenNotInErrorHashAllowlist",e[e.WhenNotMarkedAsSafe=2]="WhenNotMarkedAsSafe",e[e.Always=8]="Always"}(i||(i={}));var o,s={Missing:r.e,NotApplicable:r.t},c={Missing:r.e,NotApplicable:r.t};!function(e){e.UnhandledError="UnhandledError",e.AmpUnhandledError="AmpUnhandledError",e.SdnUnhandledError="SdnUnhandledError"}(o||(o={}))},558:function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a="<safe>",i="</safe>";function r(e){return"".concat(a).concat(e).concat(i)}function o(e){return!(e.length<a.length+i.length)&&e.substring(0,a.length)===a&&e.substring(e.length-i.length)===i}function s(e){return o(e)?e.substring(a.length,e.length-i.length):e}},1932:function(e,t,n){"use strict";function a(e,t){throw new Error(void 0!==t?"Asserted never: ".concat(t):"Asserted never")}n.d(t,"e",function(){return a})},3393:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(42),i=function(){function e(e,t,n,a){this.getValue=n,this.type="GenericProvider",this.source="Default",this.id=e,this.data=t,this.source=a||this.source}return e.prototype.tryGetSetting=function(e,t,n){var i;try{var r=this.getValue(e,this.data);void 0!==r&&(i=Object(a.e)(this.id,this.type,this.source,e,r,t,n))}catch(t){n&&n.OnTryGetSettingError&&n.OnTryGetSettingError({providerId:this.id,providerType:this.type,name:"GetSettingError",reason:"TryGetSetting failed to retrieve a setting with name: ".concat(e),message:t.message,settingName:String(e)})}return i},e}()},3396:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(1932),i={any:{type:"any"},undefined:{type:"undefined"},null:{type:"null"},boolean:{type:"boolean"},number:{type:"number"},string:{type:"string"},literal:function(e){return{type:"literal",value:e}},optional:function(e){return{type:"optional",property:e}},array:function(e){return{type:"array",elementRep:e}},object:function(e){return{type:"object",properties:e}},union:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{type:"union",variants:e}}};function r(e,t){var n=t;switch(n.type){case"any":return!0;case"undefined":return void 0===e;case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"literal":return e===n.value;case"array":return Array.isArray(e)&&(0===e.length||e.every(function(e){return r(e,n.elementRep)}));case"object":var i=Object.keys(n.properties);return"object"==typeof e&&null!==e&&!Array.isArray(e)&&i.every(function(t){var a=n.properties[t];return"optional"===a.type?void 0===e[t]||r(e[t],a.property):r(e[t],a)});case"union":return n.variants.some(function(t){return r(e,t)});default:return Object(a.e)(n,"validate: Invalid runtime type representation: '".concat(t.type,"'"))}}},3397:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(682),i=n(311),r=function(){function e(){}return e.initialize=function(t){e.loggingService=t},e.getPrivacyScrubber=function(){return e.loggingService?e.loggingService.PrivacyScrubber:void 0},e.logError=function(t){if(e.loggingService){var n=i.a.Missing,r=t.message?t.message:"";void 0!==r&&""!==r||t.error&&("string"==typeof t.error?r=t.error:t.error instanceof Error&&(r=t.error.message)),t.error&&t.error instanceof Error&&t.error.stack&&(n=t.error.stack);var o,s=Object(a.parse)(window.location.search.toLowerCase());"string"==typeof s.app&&(o=s.app);var c={methodName:t.method,message:r,statusCode:t.statusCode,staticMessage:t.staticMessage,url:t.url,appName:o,stack:n,groupings:t.groupings,clientRequestId:t.clientRequestId,backendCorrelationId:t.backendCorrelationId,requestStartTimestamp:t.requestStartTimestamp,requestCompleteTimestamp:t.requestCompleteTimestamp},d="RestCallError";t.isFatal?e.loggingService.fatalThin(d,c):e.loggingService.warnThin(d,c)}},e}()},3398:function(e,t,n){"use strict";function a(e){return i(e)&&Number.isInteger(e)}function i(e){return e>=0}function r(e){return isFinite(e)&&!isNaN(e)}function o(e){return i(e)&&Number.isFinite(e)}n.d(t,"n",function(){return a}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o})},3620:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a,i=n(0),r=n(3397),o=n(558),s=n(3396),c=n(682),d=n(12),l=n(3398),u={DefaultSkip:0,DefaultTop:8,DefaultFaceTop:3,MaxTop:100},f=function(e){function t(n,a){var i=e.call(this,a)||this;return i.status=n,void 0!==typeof Object.setPrototypeOf&&Object.setPrototypeOf(i,t.prototype),i}return Object(i.a)(t,e),t}(Error);!function(e){function t(e){return e&&e.length?e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase():""}function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}e.lookupDottedPath=function(e,t){try{return""+(t||"").split(".").reduce(function(e,t){return e[t]},e)}catch(e){return""}},e.getQueryString=function(e){return Object.keys(e).map(function(a){var i=t(a);return"".concat(n(i),"=").concat(n(e[a]))}).join("&")},e.camelCaseToHyphens=t,e.encodeUri=function(e){return encodeURI(e).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+").replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},e.encodeQueryStringComponent=n}(a||(a={}));var p="x-ms-client-request-id",m="Rest.performHealthCheck. Failed to reach our health URL. This means there is a client network issue.",_=function(){function e(){}return e.get=function(t,n,a,i,r,o,c){return void 0===c&&(c=s.e.any),e.getWithResponse(t,n,a,i,r,o,c).then(function(e){return e[0]})},e.getWithResponse=function(t,n,a,i,o,c,d){var l=this;if(void 0===d&&(d=void 0),!a){var u=t+". empty base url";r.e.logError({method:"GET",staticMessage:u,url:i})}return e.makeRequest(t,n,"GET",d||s.e.any,a,i,o,void 0,c,void 0).then(function(e){return void 0!==d?l.getResponseBody(e).then(function(t){return[t,e]}):e})},e.getWithCorsSupport=function(t,n,a,i,o,c,d){if(void 0===d&&(d=s.e.any),!a){var l=t+". empty base url";r.e.logError({method:"GET",staticMessage:l,url:i})}return e.makeRequest(t,n,"GET",d,a,i,o,void 0,c,"cors").then(function(t){return e.getResponseBody(t)})},e.getContent=function(t,n,a,i,r){return void 0===r&&(r=s.e.any),e.getContentWithResponse(t,n,a,i,r).then(function(e){return e[0]})},e.getContentWithResponse=function(t,n,a,i,r){var o=this;return void 0===r&&(r=void 0),e.makeRequestForUrl(t,n,"GET",r||s.e.any,a,void 0,i,void 0).then(function(e){return o.getResponseBody(e).then(function(t){return[t,e]})})},e.put=function(t,n,a,i,r,o,c,d){return void 0===d&&(d=s.e.any),e.putWithResponse(t,n,a,i,r,o,c,d).then(function(e){return e[0]})},e.putWithResponse=function(t,n,a,i,o,c,d,l){var u=this;if(void 0===l&&(l=void 0),!a){var f=t+". empty base url";r.e.logError({method:"PUT",staticMessage:f,url:i})}return e.makeRequest(t,n,"PUT",l||s.e.any,a,i,o,c,d,void 0).then(function(e){return void 0!==l?u.getResponseBody(e).then(function(t){return[t,e]}):e})},e.patch=function(t,n,a,i,r,o,c,d){return void 0===d&&(d=s.e.any),e.patchWithResponse(t,n,a,i,r,o,c,d).then(function(e){return e[0]})},e.patchWithResponse=function(t,n,a,i,o,c,d,l){var u=this;if(void 0===l&&(l=void 0),!a){var f=t+". empty base url";r.e.logError({method:"PATCH",staticMessage:f,url:i})}return e.makeRequest(t,n,"PATCH",l||s.e.any,a,i,o,c,d,void 0).then(function(e){return void 0!==l?u.getResponseBody(e).then(function(t){return[t,e]}):e})},e.post=function(t,n,a,i,r,o,c,d){return void 0===d&&(d=s.e.any),e.postWithResponse(t,n,a,i,r,o,c,d).then(function(e){return e[0]})},e.postWithResponse=function(t,n,a,i,o,c,d,l){var u=this;if(void 0===l&&(l=void 0),!a){var f=t+". empty base url";r.e.logError({method:"POST",staticMessage:f,url:i})}return e.makeRequest(t,n,"POST",l||s.e.any,a,i,o,c,d,void 0).then(function(e){return void 0!==l?u.getResponseBody(e).then(function(t){return[t,e]}):e})},e.postToRelativeUrl=function(t,n,a,i,r,o,c){return void 0===c&&(c=s.e.any),e.makeRequest(t,n,"POST",c,"",a,i,r,o).then(function(t){return e.getResponseBody(t)})},e.delete=function(t,n,a,i,r,o,c){return void 0===c&&(c=s.e.any),e.deleteWithResponse(t,n,a,i,r,o,c).then(function(t){return e.getResponseBody(t)})},e.deleteWithResponse=function(t,n,a,i,o,c,d){if(void 0===d&&(d=s.e.any),!a){var l=t+". empty base url";r.e.logError({method:"DELETE",staticMessage:l,url:i})}return e.makeRequest(t,n,"DELETE",d,a,i,o,void 0,c,void 0)},e.query=function(t,n,a,i,r,o,c){return void 0===c&&(c=s.e.any),e.queryWithResponse(t,n,a,i,r,o,c).then(function(e){return e[0]})},e.queryWithResponse=function(t,n,a,i,o,c,d){var f=this;if(void 0===d&&(d=void 0),!a){var p=t+". empty base url";r.e.logError({method:"GET",staticMessage:p,url:i})}if(o&&void 0!==o.$top){var m=parseInt(o.$top,10);Object(l.e)(m)?o.$top=Math.min(u.MaxTop,m>0?m:u.DefaultTop).toString():o.$top=u.DefaultTop.toString(),o.$top=o.$top.toString()}if(o&&void 0!==o.$skip){var _=parseInt(o.$skip,10);Object(l.e)(_)?o.$skip=Math.max(u.DefaultSkip,_).toString():o.$skip=u.DefaultSkip.toString(),o.$skip=o.$skip.toString()}return e.makeRequest(t,n,"GET",d||s.e.any,a,i,o,void 0,c,"cors").then(function(e){return void 0!==d?f.getResponseBody(e).then(function(t){return[t,e]}):e})},e.performHealthCheck=function(t,n,a,o,s){return Object(i.t)(this,void 0,void 0,function(){var c,d,l;return Object(i.i)(this,function(i){switch(i.label){case 0:if(l=(new Date).toISOString(),!e.NetworkHealthCheckUrl)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.fetchWithTimeout(e.NetworkHealthCheckUrl,{method:"GET"})];case 2:return d=i.sent(),[3,4];case 3:return i.sent(),[3,4];case 4:return c=d&&200===d.status?"Rest.performHealthCheck. Can successfully reach our health URL. This means there is no client network issue, so it is a backend issue":d?"".concat(m," Status code is ").concat(d.status):m,[3,8];case 5:return i.trys.push([5,7,,8]),[4,e.fetchWithTimeout("",{method:"GET"})];case 6:return d=i.sent(),c="Rest.performHealthCheck. Can successfully reach our health URL. This means there is no client network issue, so it is a backend issue",[3,8];case 7:return i.sent(),c="Rest.performHealthCheck. Failed to reach our health URL. This means there is a client network issue.",[3,8];case 8:return r.e.logError({method:n.method,staticMessage:c,url:t,statusCode:a?a.status:void 0,clientRequestId:n.headers[p],groupings:o,message:a?a.statusText:void 0,error:s,isFatal:!0,backendCorrelationId:d&&d.correlationId,requestStartTimestamp:l,requestCompleteTimestamp:(new Date).toISOString()}),[2]}})})},e.setHealthCheckUrl=function(t){e.NetworkHealthCheckUrl=t},e.makeRequest=function(t,n,i,r,o,s,d,l,u,f){var p=Object(c.parse)(window.location.search.toLowerCase());"string"==typeof p.hostcorrelationid&&(d.hostcorrelationid=p.hostcorrelationid);var m=function(e,t,n,i){n=n||{},i=i||{};var r=[e,t].filter(function(e){return e.length}).join("/"),o={id:"",apiVersion:""},s=r.replace(/:(\w+?)(\W|$)/g,function(e,t,r){if(!n[t])return""+r;var s=n[t];return"string"==typeof s&&"@"===s[0]&&(s=a.lookupDottedPath(i||{},s.substring(1))),"function"==typeof s&&(s=s()),o[t]=s,s+r}),c={};Object.keys(n).forEach(function(e){if(!o[e]){var t=n[e];c[e]="function"==typeof t?t():t}}),s=s.split("://").map(function(e){return e.replace(/[\/]{2,}/g,"/")}).join("://"),s=a.encodeUri(s);var d=a.getQueryString(c);return d&&(s=s+(/\?/.test(s)?"&":"?")+d),s}(o,s,d,"object"==typeof l?l:void 0);return e.formRequest(t,n,i,r,m,u,l,f)},e.makeRequestForUrl=function(t,n,a,i,r,o,s,c){return e.formRequest(t,n,a,i,r,s,o,c)},e.formRequest=function(t,n,a,i,r,o,s,c){var d=s&&/^(POST|PUT|PATCH)$/i.test(a),l=(o=o||{})["Content-Type"];!d||s instanceof FormData||l||(o["Content-Type"]="application/json;charset=UTF-8");var u={method:a,headers:o,body:d?"text/vtt"===l||l&&("application/octet-stream"===l||l.includes("image")||l.includes("multipart/related"))||s instanceof FormData?s:JSON.stringify(s):void 0,mode:c,credentials:"cors"===c?"include":"same-origin"};return e.executeWithRetry(t,n,r,i,u)},e.executeWithRetry=function(t,n,a,s,c){return Object(i.t)(this,void 0,void 0,function(){var d,l,u,f,m,_,h,b,g,v,y;return Object(i.i)(this,function(i){switch(i.label){case 0:d=0,l=[],c.headers=c.headers||{},i.label=1;case 1:if(!(d<=3))return[3,10];m=(new Date).toISOString(),i.label=2;case 2:return i.trys.push([2,5,,9]),c.headers[p]=e.generateGuid(),[4,e.fetchWithTimeout(a,c)];case 3:return u=i.sent(),[4,e.handleFetchResponse(u,s).then(function(e){return e.retries=l,e})];case 4:return[2,i.sent()];case 5:return _=i.sent(),h=(new Date).toISOString(),f=t,"AbortError"!==(b=_).name&&b.message!==Object(o.n)("Timeout")&&b.message!==Object(o.n)("Network request failed")&&u?"string"==typeof b.message&&0===b.message.lastIndexOf("<safe>Malformed")&&(f+=". Malformed response"):f+=". Network issue",(b=e.staticError(b)).headers=b.headers||u&&u.headers,u?l.push(u):l.push("NoResponse"),g=!1,u&&u.status<500&&429!==u.status||u&&(503===u.status||429===u.status)&&e.isTenantPatch(a,c)?g=!0:d++,!g&&d>3?[4,e.performHealthCheck(a,c,u,n,b)]:[3,7];case 6:i.sent(),g=!0,i.label=7;case 7:if(v={method:c.method,staticMessage:f,url:a,statusCode:b.status||u&&u.status,clientRequestId:c.headers[p],requestId:b.headers&&b.headers.get("request-id"),groupings:n,message:u?u.statusText:void 0,oData:b.data&&b.data["odata.error"]?b.data["odata.error"]:void 0,isFatal:g,backendCorrelationId:u&&u.correlationId,stack:b instanceof Error?b.stack:void 0,retryCount:l.length,error:b,response:u,retries:l,requestStartTimestamp:m,requestCompleteTimestamp:h},r.e.logError(v),g)throw v;return y=e.calculateRetryDelayMs(u,d),[4,e.delay(y)];case 8:return i.sent(),[3,9];case 9:return[3,1];case 10:throw new Error(Object(o.n)("RestService.executeWithRetry. Unexpected code, we should have never got here"))}})})},e.calculateRetryDelayMs=function(e,t){if(e&&e.headers){var n=e.headers.get("Retry-After");if(n){var a=Number(n);if(Object(l.t)(a))return 1e3*a;if(isNaN(a)){var i=Date.parse(n);if(i>=0)return Math.max(0,i-Date.now())}}}return 200*Math.pow(2,t)},e.staticError=function(e){if(void 0===e||void 0===e.status)return e;switch(+e.status){case 401:return new f(e.status,Object(o.n)("Unauthorized"));case 403:return new f(e.status,Object(o.n)("Forbidden"));case 404:return new f(e.status,Object(o.n)("NotFound"));case 405:return new f(e.status,Object(o.n)("OperationNotAllowed"));default:return e}},e.fetchWithTimeout=function(e,t){var n={response:void 0},a=function(e){return n.response=e,e.correlationId=e.headers.get("x-correlationid")||e.headers.get("x-correlation-id")||e.headers.get("SPRequestGuid")||e.headers.get("request-id")||void 0,e};if("undefined"!=typeof AbortController){var r=new AbortController,s=r.signal;return setTimeout(function(){n.response||r.abort()},15e3),fetch(e,Object(i.e)(Object(i.e)({},t),{signal:s})).then(a)}var c=fetch(e,t).then(a),d=new Promise(function(e,t){setTimeout(function(){n.response||t(new Error(Object(o.n)("Timeout")))},15e3)});return Promise.race([c,d])},e.handleFetchResponse=function(e,t){return Object(i.t)(this,void 0,void 0,function(){var n,a,r,c;return Object(i.i)(this,function(i){switch(i.label){case 0:return e.ok?!(n=e.headers.get("content-type"))||-1===n.indexOf("application/json")&&-1===n.indexOf("text/html")?[3,5]:e.clone?[4,e.clone().json()]:[3,2]:[3,7];case 1:return r=i.sent(),[3,4];case 2:return[4,e.json()];case 3:r=i.sent(),i.label=4;case 4:if(a=r,Object(s.t)(a,t))return[2,e];throw new TypeError(Object(o.n)("Malformed. Response validation failed"));case 5:if(!n||-1===n.indexOf("application/octet-stream")&&-1===n.indexOf("text/vtt")){if(Object(s.t)(void 0,t))return[2,e];throw new TypeError(Object(o.n)("Malformed. Response had content-type: '".concat(n,"', expected ").concat(t.type)))}return[2,e];case 6:return[3,12];case 7:c=void 0,i.label=8;case 8:return i.trys.push([8,10,,11]),[4,e.json()];case 9:return c=i.sent(),[3,11];case 10:return i.sent(),c={},[3,11];case 11:throw{status:e.status,statusText:e.statusText,headers:e.headers,data:c};case 12:return[2]}})})},e.getResponseBody=function(e){return Object(i.t)(this,void 0,void 0,function(){var t;return Object(i.i)(this,function(n){switch(n.label){case 0:return void 0===e?[2,void 0]:!(t=e.headers.get("content-type"))||-1===t.indexOf("application/json")&&-1===t.indexOf("text/html")?[3,2]:[4,e.json()];case 1:case 3:return[2,n.sent()];case 2:return!t||-1===t.indexOf("application/octet-stream")&&-1===t.indexOf("text/vtt")?[3,4]:[4,e.text()];case 4:return[2,e.body]}})})},e.isTenantPatch=function(e,t){return"PATCH"===t.method&&-1!==e.indexOf("api/tenants/")},e.delay=function(e){return new Promise(function(t){setTimeout(t,e)})},e.generateGuid=function(){return Object(d.v4)()},e}()}}]);